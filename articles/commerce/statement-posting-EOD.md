---
title: Laskelman kirjaamisen toiminnallisuuden parannukset
description: Tässä aiheessa kuvataan parannuksia, jotka on tehty laskelman kirjaamistoimintoon.
author: josaw1
manager: AnnBe
ms.date: 05/14/2019
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
audience: Application User
ms.reviewer: josaw
ms.search.region: Global
ms.search.industry: retail
ms.author: anpurush
ms.search.validFrom: 2018-04-30
ms.dyn365.ops.version: AX 7.0.0, Retail July 2017 update
ms.openlocfilehash: 96798c052a24f3a1ad0856c34bd26051f1196110
ms.sourcegitcommit: eaf330dbee1db96c20d5ac479f007747bea079eb
ms.translationtype: HT
ms.contentlocale: fi-FI
ms.lasthandoff: 02/15/2021
ms.locfileid: "5234266"
---
# <a name="improvements-to-statement-posting-functionality"></a><span data-ttu-id="69acb-103">Laskelman kirjaamisen toiminnallisuuden parannukset</span><span class="sxs-lookup"><span data-stu-id="69acb-103">Improvements to statement posting functionality</span></span>

[!include [banner](includes/banner.md)]

<span data-ttu-id="69acb-104">Tässä aiheessa kuvataan ensimmäinen joukko parannuksia, jotka on tehty laskelman kirjaamistoimintoon.</span><span class="sxs-lookup"><span data-stu-id="69acb-104">This topic describes the first set of improvements that have been made to the statement posting feature.</span></span> <span data-ttu-id="69acb-105">Nämä parannukset ovat käytettävissä Microsoft Dynamics 365 for Finance and Operations7.3.2 -versiossa.</span><span class="sxs-lookup"><span data-stu-id="69acb-105">These improvements are available in Microsoft Dynamics 365 for Finance and Operations 7.3.2.</span></span>

## <a name="activation"></a><span data-ttu-id="69acb-106">Aktivointi</span><span class="sxs-lookup"><span data-stu-id="69acb-106">Activation</span></span>

<span data-ttu-id="69acb-107">Oletusarvon mukaan Finance and Operations 7.3.2:n käyttöönoton yhteydessä ohjelma määritetään käyttämään vanhaa ominaisuutta laskelman kirjauksia varten.</span><span class="sxs-lookup"><span data-stu-id="69acb-107">By default, during deployment of Finance and Operations 7.3.2, the program is set up to use the legacy feature for statement postings.</span></span> <span data-ttu-id="69acb-108">Ottaaksesi käyttöön parannetun laskelman kirjaustoiminnon sinun on otettava käyttöön sen määritysavain.</span><span class="sxs-lookup"><span data-stu-id="69acb-108">To enable the improved statement posting feature, you must turn on the configuration key for it.</span></span>

- <span data-ttu-id="69acb-109">Siirry kohtaan **Järjestelmän hallinta** \> **Asetukset** \> **Käyttöoikeuden konfiguraatio**, ja poista sitten **Vähittäismyynti ja kauppa**-solmusta poista **Laskelmat (vanhat)** -valintaruutu ja valitse **Laskelmat**-valintaruutu.</span><span class="sxs-lookup"><span data-stu-id="69acb-109">Go to **System administration** \> **Setup** \> **License configuration**, and then, under the **Retail and Commerce** node, clear the **Statements (legacy)** check box, and select the **Statements** check box.</span></span>

<span data-ttu-id="69acb-110">Kun uusi **Laskelmat**-määritysavain on käytössä, uusi valikkokohde nimeltä **Laskelmat** on käytettävissä.</span><span class="sxs-lookup"><span data-stu-id="69acb-110">When the new **Statements** configuration key is turned on, a new menu item that is named **Statements** is available.</span></span> <span data-ttu-id="69acb-111">Tämän valikkovaihtoehdon avulla voit luoda, laskea ja kirjata laskelmia manuaalisesti.</span><span class="sxs-lookup"><span data-stu-id="69acb-111">This menu item lets you manually create, calculate, and post statements.</span></span> <span data-ttu-id="69acb-112">Laskelmat, jotka aiheuttavat virheen eräkirjausprosessia käytettäessä, ovat myös saatavilla tämän valikkokohdan kautta.</span><span class="sxs-lookup"><span data-stu-id="69acb-112">Any statement that causes an error when the batch posting process is used will also be available through this menu item.</span></span> <span data-ttu-id="69acb-113">(Kun **Laskelmat (vanha)** -määritysavain on käytössä, valikkokohteen nimi on **Avoimet laskelmat**.)</span><span class="sxs-lookup"><span data-stu-id="69acb-113">(When the **Statements (legacy)** configuration key is turned on, the menu item is named **Open statements**.)</span></span>

<span data-ttu-id="69acb-114">Commerce sisältää seuraavat oikeellisuustarkistukset, jotka liittyvät näihin määritysavaimiin:</span><span class="sxs-lookup"><span data-stu-id="69acb-114">Commerce includes the following validations that are related to these configuration keys:</span></span>

- <span data-ttu-id="69acb-115">Kumpaakin määritysavainta ei voi ottaa käyttöön samanaikaisesti.</span><span class="sxs-lookup"><span data-stu-id="69acb-115">Both configuration keys can't be turned on at the same time.</span></span>
- <span data-ttu-id="69acb-116">Samoja määritysavaimia on käytettävä kaikkiin toimintoihin, jotka suoritetaan tietyssä laskelmassa sen elinkaaren aikana (Luo, Laske, Tyhjennä, Kirjaa jne.).</span><span class="sxs-lookup"><span data-stu-id="69acb-116">The same configuration keys must be used for all the operations that are performed on a given statement during its lifecycle (Create, Calculate, Clear, Post, and so on).</span></span> <span data-ttu-id="69acb-117">Et voi esimerkiksi luoda ja laskea laskelmaa, kun **Laskelmat (vanhat)** -määritysavain on käytössä ja yrität kirjata samaa laskelmaa **Laskelmat**-määritysavaimen ollessa käytössä.</span><span class="sxs-lookup"><span data-stu-id="69acb-117">For example, you can't create and calculate a statement while the **Statement (legacy)** configuration key is turned on, and then try to post the same statement while the **Statement** configuration key is turned on.</span></span>

> [!NOTE]
> <span data-ttu-id="69acb-118">Suosittelemme, että käytät **Laskelmat**-määritysavainta parannettua laskelman kirjaustoimintoa varten, ellei sinulla ole pakottava syytä **Laskelmat (vanhat)** -määritysavaimen käyttämiseksi.</span><span class="sxs-lookup"><span data-stu-id="69acb-118">We recommend that you use the **Statements** configuration key for the improved statement posting feature, unless you have compelling reasons to use the **Statements (legacy)** configuration key instead.</span></span> <span data-ttu-id="69acb-119">Microsoft jatkaa uuden kirjaustoiminnon parantamista, joten on tärkeää, että otat sen käyttöön mahdollisimman pian.</span><span class="sxs-lookup"><span data-stu-id="69acb-119">Microsoft will continue to invest in the new and improved statement posting feature, and it's important that you switch to it at the earliest opportunity to benefit from it.</span></span> <span data-ttu-id="69acb-120">Vanhan laskelman kirjaustoiminnon poistaminen käytöstä alkaa versiossa 8.0.</span><span class="sxs-lookup"><span data-stu-id="69acb-120">The legacy statement posting feature is deprecated starting in 8.0 release.</span></span>

## <a name="setup"></a><span data-ttu-id="69acb-121">Määritys</span><span class="sxs-lookup"><span data-stu-id="69acb-121">Setup</span></span>

<span data-ttu-id="69acb-122">Laskelman kirjaamistoiminnon parantamisen myötä on otettu käyttöön kolme uutta parametria **Laskelma**-pikavälilehdellä **Kirjaus**-välilehdellä **Kaupan parametrit** -sivulla:</span><span class="sxs-lookup"><span data-stu-id="69acb-122">As part of the improvements to the statement posting feature, three new parameters have been introduced on the **Statement** FastTab on the **Posting** tab of the **Commerce parameters** page:</span></span>

- <span data-ttu-id="69acb-123">**Poista laskelman tyhjentäminen käytöstä** – tämä vaihtoehto on käytettävissä vain vanhassa laskelman kirjaamistoiminnossa.</span><span class="sxs-lookup"><span data-stu-id="69acb-123">**Disable clear statement** – This option is applicable only for the legacy statement posting feature.</span></span> <span data-ttu-id="69acb-124">Suosittelemme, että määrität tämän asetuksen arvoksi **Ei** estääksesi käyttäjiä tyhjentämästä laskelmia, jotka ovat osittain kirjatussa tilassa.</span><span class="sxs-lookup"><span data-stu-id="69acb-124">We recommend that you set this option to **No** to prevent users from clearing statements that are in a semi-posted state.</span></span> <span data-ttu-id="69acb-125">Jos käyttäjät poistavat laskelmia, jotka ovat osittain kirjatussa tilassa, niiden tiedot korruptoituvat.</span><span class="sxs-lookup"><span data-stu-id="69acb-125">If statements that are in a semi-posted state are cleared, data becomes corrupted.</span></span> <span data-ttu-id="69acb-126">Määritä tämän asetukseksi **Kyllä** vain poikkeustapauksissa.</span><span class="sxs-lookup"><span data-stu-id="69acb-126">You should set this option to **Yes** only in exceptional circumstances.</span></span>
- <span data-ttu-id="69acb-127">**Varaston varaaminen laskennan aikana** – Suosittelemme, että käytät **Kirjaa varasto** -erätyötä varaston varaamiseen ja määrität tämän asetuksen arvoksi **Ei**.</span><span class="sxs-lookup"><span data-stu-id="69acb-127">**Reserve inventory during calculation** – We recommend that you use the **Post inventory** batch job for inventory reservation, and that you set this option to **No**.</span></span> <span data-ttu-id="69acb-128">Kun tämä vaihtoehto on **Ei**, parannettu laskelman kirjaustoiminto ei luoda varaston varaustapahtumia laskennan aikana (jos tapahtumia ei ole jo luotu **Kirjaa varasto** -erätyöllä).</span><span class="sxs-lookup"><span data-stu-id="69acb-128">When this option is set to **No**, the improved statement posting feature doesn't try to create inventory reservation entries at the time of calculation (if entries weren't already created through the **Post inventory** batch job).</span></span> <span data-ttu-id="69acb-129">Sen sijaan toiminto luo varaston varaustapahtumat vain kirjauksen yhteydessä.</span><span class="sxs-lookup"><span data-stu-id="69acb-129">Instead, the feature creates inventory reservation entries only at the time of posting.</span></span> <span data-ttu-id="69acb-130">Tämän toteutustapa on valittu sillä perusteella, että laskenta- ja kirjausprosessin välinen aikaikkuna on yleensä pieni.</span><span class="sxs-lookup"><span data-stu-id="69acb-130">This implementation was a design choice and was based on the fact that the time window between the calculation process and the posting process is typically small.</span></span> <span data-ttu-id="69acb-131">Js haluat varata varaston laskennan yhteydessä, voit määrittää asetukseksi **Kyllä**.</span><span class="sxs-lookup"><span data-stu-id="69acb-131">However, if you want to reserve inventory at the time of calculation, you can set this option to **Yes**.</span></span>

    <span data-ttu-id="69acb-132">Vanha laskelman kirjaustoiminto varaa aina varaston laskelman laskentaprosessissa (jos varausta ei ole jo tehty **Kirjaa varasto** -erätyöllä) riippumatta tästä asetuksesta.</span><span class="sxs-lookup"><span data-stu-id="69acb-132">The legacy statement posting feature always reserves inventory during the statement calculation process (if reservation wasn't already done through the **Post inventory** batch job), regardless of the setting of this option.</span></span>

- <span data-ttu-id="69acb-133">**Poista pakollinen laskenta käytöstä** – kun asetukseksi on määritetty **Kyllä**, laskelma jatkuu kirjausprosessin aikana, vaikka ero lasketun summan ja transaktion summan välillä ylittää rajan, joka on määritetty myymälöiden **Laskelma**-pikavälilehdessä.</span><span class="sxs-lookup"><span data-stu-id="69acb-133">**Disable counting required** – When this option is set to **Yes**, the posting process for a statement continues, even if the difference between the counted amount and the transaction amount on the statement is outside the threshold that is defined on the **Statement** FastTab for stores.</span></span>

<span data-ttu-id="69acb-134">Lisäksi seuraavat parametrit on esitelty **Eräkäsittely**-pikavälilehdellä **Kirjaus**-välilehdellä **Kaupan parametrit** -sivun kirjausvälilehden eräkäsittelypikavälilehdessä:</span><span class="sxs-lookup"><span data-stu-id="69acb-134">Additionally, the following parameters have been introduced on the **Batch processing** FastTab on the **Posting** tab of the **Commerce parameters** page:</span></span> 

- <span data-ttu-id="69acb-135">**Rinnakkaisen laskelman kirjauksen enimmäismäärä** – Tämä kenttä määrittää useiden laskelmien kirjaamiseen käytettävien erätehtävien määrän.</span><span class="sxs-lookup"><span data-stu-id="69acb-135">**Maximum number of parallel statement posting** – This field defines the number of batch tasks that will be used to post multiple statements.</span></span> 
- <span data-ttu-id="69acb-136">**Tilausten käsittelyn enimmäissäie** – Tämä kenttä edustaa laskelman kirjauksen eräajossa käytettävien säikeiden enimmäismäärää, kun halutaan luoda ja laskuttaa yhden laskelman myyntitilauksia.</span><span class="sxs-lookup"><span data-stu-id="69acb-136">**Max thread for order processing per statement** – This field represents the maximum number of threads used by the statement posting batch job to create and invoice sales orders for a single statement.</span></span> <span data-ttu-id="69acb-137">Laskelman kirjaus prosessissa käytettävien säikeiden kokonaismäärä lasketaan tämän parametrin arvon mukaan kerrottuna **Rinnakkaisen laskelman kirjausten enimmäismäärä**-parametrin arvolla.</span><span class="sxs-lookup"><span data-stu-id="69acb-137">The total number of threads that will be used by the statement posting process will be computed based on the value in this parameter multiplied by the value in the **Maximum number of parallel statement posting** parameter.</span></span> <span data-ttu-id="69acb-138">Tämän parametrin arvon määrittäminen liian suureksi voi vaikuttaa kielteisesti laskelman kirjausprosessin suorituskykyyn.</span><span class="sxs-lookup"><span data-stu-id="69acb-138">Setting the value of this parameter too high can negatively impact the performance of the statement posting process.</span></span>
- <span data-ttu-id="69acb-139">**Koontia varten sisällytettyjen tapahtuma rivien enimmäismäärä** – Tämä kenttä määrittää, montako tapahtumariviä sisällytetään yksittäiseen yhteenlaskettavaan tapahtumaan ennen uuden luomista.</span><span class="sxs-lookup"><span data-stu-id="69acb-139">**Max transaction lines included in aggregation** – This field defines the number of transaction lines that will be included in a single aggregated transaction before a new one is created.</span></span> <span data-ttu-id="69acb-140">Yhdistetyt tapahtumat luodaan erilaisten koostekriteerien, kuten asiakkaan, liiketoiminnan päivän tai taloushallinnon dimensioiden, perusteella.</span><span class="sxs-lookup"><span data-stu-id="69acb-140">Aggregated transactions are created based on different aggregation criteria such as customer, business date, or financial dimensions.</span></span> <span data-ttu-id="69acb-141">On tärkeää huomata, että yksittäisen tapahtuman rivejä ei jaeta eri yhdistettyjen tapahtumien kesken.</span><span class="sxs-lookup"><span data-stu-id="69acb-141">It is important to note that the lines from a single transaction will not be split across different aggregated transactions.</span></span> <span data-ttu-id="69acb-142">Tämä tarkoittaa, että on mahdollista, että yhdistettyjen tapahtumien rivien määrä on hieman suurempi tai pienempi niiden tekijöiden perusteella, kuten erillisten tuotteiden määrä.</span><span class="sxs-lookup"><span data-stu-id="69acb-142">This means that there is a possibility that the number of lines in a aggregated transaction is slightly higher or lower based on factors such as number of distinct products.</span></span>
- <span data-ttu-id="69acb-143">**Säikeiden enimmäismäärä varastotapahtumien tarkistamista varten** – Tämä kenttä määrittää tapahtumien vahvistamiseen käytettävien säikeiden määrän.</span><span class="sxs-lookup"><span data-stu-id="69acb-143">**Maximum number of threads to validate store transactions** – This field defines the number of threads that will be used to validate transactions.</span></span> <span data-ttu-id="69acb-144">Tapahtumien vahvistaminen on pakollinen vaihe, joka on suoritettava, ennen kuin tapahtumat voidaan noutaa lausekkeissa.</span><span class="sxs-lookup"><span data-stu-id="69acb-144">Validating transactions is a required step that needs to occur before the transactions can be pulled into the statements.</span></span> <span data-ttu-id="69acb-145">Sinun on myös määritettävä uuden kirjausprosessin aikana **Lahjakorttituote** **Lahjakortti**-pikavälilehdessä **Kaupan parametrit** -sivun **Kirjaus**-välilehdessä.</span><span class="sxs-lookup"><span data-stu-id="69acb-145">You also need to define a **Gift card product** on the **Gift card** FastTab on the **Posting** tab of the **Commerce parameters** page.</span></span> <span data-ttu-id="69acb-146">Tämä on määritettävä myös silloin, kun organisaatio ei käytä lahjakortteja.</span><span class="sxs-lookup"><span data-stu-id="69acb-146">This needs to defined even if gift cards are not used by the organization.</span></span>

> [!NOTE]
> <span data-ttu-id="69acb-147">Kaikki asetukset ja parametrit, jotka liittyvät laskelman kirjauksiin ja jotka on määritetty vähittäismyymälöissä ja **Commerce-parametrit**-sivulla, liittyvät parannettuun laskelman kirjaustoimintoon.</span><span class="sxs-lookup"><span data-stu-id="69acb-147">All settings and parameters that are related to statement postings, and that are defined on stores and on the **Commerce parameters** page, are applicable to the improved statement posting feature.</span></span>

## <a name="processing"></a><span data-ttu-id="69acb-148">Käsittely</span><span class="sxs-lookup"><span data-stu-id="69acb-148">Processing</span></span>

<span data-ttu-id="69acb-149">Laskelmat voidaan laskea ja kirjata eränä valikkovaihtoehtojen **Laskelmien laskenta eräajona** ja **Laskelmien kirjaaminen eräajona** avulla.</span><span class="sxs-lookup"><span data-stu-id="69acb-149">Statements can be calculated and posted in batch using the menu items **Calculate statements in batch** and **Post statements in batch**.</span></span> <span data-ttu-id="69acb-150">Vaihtoehtoisesti laskelmat voidaan laskea manuaalisesti ja kirjata käyttämällä parannetun laskelman kirjaustoiminnon **Laskelmat**-valikkokohteella.</span><span class="sxs-lookup"><span data-stu-id="69acb-150">Alternatively, statements can be manually calculated and posted by using the **Statements** menu item that the improved statement posting feature provides.</span></span>

<span data-ttu-id="69acb-151">Prosessi ja vaiheet ja laskelmien eräkirjaamista varten ovat samat kuin vanhassa laskelman kirjaustoiminnossa.</span><span class="sxs-lookup"><span data-stu-id="69acb-151">The process and steps for calculating and posting statements in a batch are the same as they were in the legacy statement posting feature.</span></span> <span data-ttu-id="69acb-152">Laskelmien käsittelyn taustajärjestelmään on tehty kuitenkin merkittäviä parannuksia.</span><span class="sxs-lookup"><span data-stu-id="69acb-152">However, significant improvements have been made in the core back-end processing of the statements.</span></span> <span data-ttu-id="69acb-153">Nämä parannukset tekevät prosessista luotettavamman ja ne parantavat tilojen ja virhetietojen näkyvyyttä.</span><span class="sxs-lookup"><span data-stu-id="69acb-153">These improvements make the process more resilient, and provide for better visibility into the states and error information.</span></span> <span data-ttu-id="69acb-154">Käyttäjät voivat siten korjaa virheiden ensisijaiset syyt ja jatkaa kirjausprosessia ilman tietojen turmeltumista ja tietojen korjailua.</span><span class="sxs-lookup"><span data-stu-id="69acb-154">Therefore, users can address the root cause of errors and then continue the posting process without causing data corruption and without causing data fixes to be required.</span></span>

<span data-ttu-id="69acb-155">Seuraavissa osissa kuvataan laskelmien kirjaustoiminnon tärkeimmät parannukset, jotka näkyvät laskelmien ja kirjattujen laskelmien käyttöliittymässä.</span><span class="sxs-lookup"><span data-stu-id="69acb-155">The following sections describe some of the major improvements for the statement posting feature that appear in the user interface for statements and posted statements.</span></span>

### <a name="status-details"></a><span data-ttu-id="69acb-156">Tilan tiedot</span><span class="sxs-lookup"><span data-stu-id="69acb-156">Status details</span></span>

<span data-ttu-id="69acb-157">Uusi tilamalli on otettu käyttöön laskelman kirjausmenettelyn laskenta- ja kirjausprosesseissa.</span><span class="sxs-lookup"><span data-stu-id="69acb-157">A new state model has been introduced in the statement posting routine across the calculation and posting processes.</span></span>

<span data-ttu-id="69acb-158">Seuraavassa taulukossa kuvataan eri tilat ja niiden järjestys laskennan aikana.</span><span class="sxs-lookup"><span data-stu-id="69acb-158">The following table describes the various states and their order during the calculation process.</span></span>

| <span data-ttu-id="69acb-159">Tilajärjestys</span><span class="sxs-lookup"><span data-stu-id="69acb-159">State order</span></span> | <span data-ttu-id="69acb-160">Alue</span><span class="sxs-lookup"><span data-stu-id="69acb-160">State</span></span>      | <span data-ttu-id="69acb-161">kuvaus</span><span class="sxs-lookup"><span data-stu-id="69acb-161">Description</span></span> |
|-------------|------------|-------------|
| <span data-ttu-id="69acb-162">1</span><span class="sxs-lookup"><span data-stu-id="69acb-162">1</span></span>           | <span data-ttu-id="69acb-163">Aloitettu</span><span class="sxs-lookup"><span data-stu-id="69acb-163">Started</span></span>    | <span data-ttu-id="69acb-164">Laskelma on luotu ja valmis laskettavaksi.</span><span class="sxs-lookup"><span data-stu-id="69acb-164">The statement was created and is ready to be calculated.</span></span> |
| <span data-ttu-id="69acb-165">2</span><span class="sxs-lookup"><span data-stu-id="69acb-165">2</span></span>           | <span data-ttu-id="69acb-166">Merkitty</span><span class="sxs-lookup"><span data-stu-id="69acb-166">Marked</span></span>     | <span data-ttu-id="69acb-167">Tapahtumat, jotka ovat laskelman alueella, on määritetty laskelman parametrien perusteella ja merkitty laskelman tunnuksella.</span><span class="sxs-lookup"><span data-stu-id="69acb-167">The transactions that are in scope for the statement are identified based on the statement parameters, and they are marked with the statement ID.</span></span> |
| <span data-ttu-id="69acb-168">3</span><span class="sxs-lookup"><span data-stu-id="69acb-168">3</span></span>           | <span data-ttu-id="69acb-169">Laskettu</span><span class="sxs-lookup"><span data-stu-id="69acb-169">Calculated</span></span> | <span data-ttu-id="69acb-170">Laskelman rivit lasketaan ja näytetään.</span><span class="sxs-lookup"><span data-stu-id="69acb-170">The statement lines are computed and shown.</span></span> |

<span data-ttu-id="69acb-171">Seuraavassa taulukossa kuvataan eri tilat ja niiden järjestys kirjauksen aikana.</span><span class="sxs-lookup"><span data-stu-id="69acb-171">The following table describes the various states and their order during the posting process.</span></span>

| <span data-ttu-id="69acb-172">Tilajärjestys</span><span class="sxs-lookup"><span data-stu-id="69acb-172">State order</span></span> | <span data-ttu-id="69acb-173">Alue</span><span class="sxs-lookup"><span data-stu-id="69acb-173">State</span></span>                   | <span data-ttu-id="69acb-174">kuvaus</span><span class="sxs-lookup"><span data-stu-id="69acb-174">Description</span></span> |
|-------------|-------------------------|-------------|
| <span data-ttu-id="69acb-175">1</span><span class="sxs-lookup"><span data-stu-id="69acb-175">1</span></span>           | <span data-ttu-id="69acb-176">Tarkistettu</span><span class="sxs-lookup"><span data-stu-id="69acb-176">Checked</span></span>                 | <span data-ttu-id="69acb-177">Useita oikeellisuustarkistuksia suoritetaan liittyen parametreihin (esimerkiksi käsittelyn kuluihin) sekä laskelmaan ja laskelman riveihin (esimerkiksi lasketun summan ja transaktion summan ero).</span><span class="sxs-lookup"><span data-stu-id="69acb-177">Multiple validations are done that are related to parameters (for example, the disposition charge), and to the statement and statement lines (for example, the difference between the counted amount and the transaction amount).</span></span> |
| <span data-ttu-id="69acb-178">2</span><span class="sxs-lookup"><span data-stu-id="69acb-178">2</span></span>           | <span data-ttu-id="69acb-179">Koottu</span><span class="sxs-lookup"><span data-stu-id="69acb-179">Aggregated</span></span>              | <span data-ttu-id="69acb-180">Nimettyjen ja nimettömien asiakkaiden myyntitapahtumat koostetaan konfiguraation mukaan.</span><span class="sxs-lookup"><span data-stu-id="69acb-180">Sales transactions for named and unnamed customers are aggregated based on the configuration.</span></span> <span data-ttu-id="69acb-181">Lopulta jokainen koottu transaktio muunnetaan myyntitilaukseksi.</span><span class="sxs-lookup"><span data-stu-id="69acb-181">Every aggregated transaction is eventually converted to a sales order.</span></span> |
| <span data-ttu-id="69acb-182">3</span><span class="sxs-lookup"><span data-stu-id="69acb-182">3</span></span>           | <span data-ttu-id="69acb-183">Asiakastilaus luotu</span><span class="sxs-lookup"><span data-stu-id="69acb-183">Customer order created</span></span>  | <span data-ttu-id="69acb-184">Myyntitilaukset luodaan järjestelmässä kootun transaktion perusteella.</span><span class="sxs-lookup"><span data-stu-id="69acb-184">Based on the aggregated transaction, sales orders are created in the system.</span></span> |
| <span data-ttu-id="69acb-185">4</span><span class="sxs-lookup"><span data-stu-id="69acb-185">4</span></span>           | <span data-ttu-id="69acb-186">Asiakastilaus laskutettu</span><span class="sxs-lookup"><span data-stu-id="69acb-186">Customer order invoiced</span></span> | <span data-ttu-id="69acb-187">Myyntitilaukset on laskutettu.</span><span class="sxs-lookup"><span data-stu-id="69acb-187">Sales orders are invoiced.</span></span> |
| <span data-ttu-id="69acb-188">5</span><span class="sxs-lookup"><span data-stu-id="69acb-188">5</span></span>           | <span data-ttu-id="69acb-189">Kirjatut alennukset</span><span class="sxs-lookup"><span data-stu-id="69acb-189">Discounts posted</span></span>        | <span data-ttu-id="69acb-190">Kausialennuksen kirjauskansiot kirjataan konfiguraation mukaan.</span><span class="sxs-lookup"><span data-stu-id="69acb-190">Periodic discount journals are posted based on the configuration.</span></span> |
| <span data-ttu-id="69acb-191">6</span><span class="sxs-lookup"><span data-stu-id="69acb-191">6</span></span>           | <span data-ttu-id="69acb-192">Kirjattu tuotto/kulu</span><span class="sxs-lookup"><span data-stu-id="69acb-192">Income/expense posted</span></span>   | <span data-ttu-id="69acb-193">Tulo-/ kulutransaktiot kirjataan tositteina.</span><span class="sxs-lookup"><span data-stu-id="69acb-193">Income/expense transactions are posted as vouchers.</span></span> |
| <span data-ttu-id="69acb-194">7</span><span class="sxs-lookup"><span data-stu-id="69acb-194">7</span></span>           | <span data-ttu-id="69acb-195">Linkitetyt tositteet</span><span class="sxs-lookup"><span data-stu-id="69acb-195">Vouchers linked</span></span>         | <span data-ttu-id="69acb-196">Maksukirjauskansiot luodaan ja linkitetään vastaavaan laskuun.</span><span class="sxs-lookup"><span data-stu-id="69acb-196">Payment journals are created and linked to the corresponding invoice.</span></span> |
| <span data-ttu-id="69acb-197">8</span><span class="sxs-lookup"><span data-stu-id="69acb-197">8</span></span>           | <span data-ttu-id="69acb-198">Kirjatut maksut</span><span class="sxs-lookup"><span data-stu-id="69acb-198">Payments posted</span></span>         | <span data-ttu-id="69acb-199">Maksukirjauskansiot on kirjattu.</span><span class="sxs-lookup"><span data-stu-id="69acb-199">Payment journals are posted.</span></span> |
| <span data-ttu-id="69acb-200">9</span><span class="sxs-lookup"><span data-stu-id="69acb-200">9</span></span>           | <span data-ttu-id="69acb-201">Lahjakortit on kirjattu</span><span class="sxs-lookup"><span data-stu-id="69acb-201">Gift cards posted</span></span>       | <span data-ttu-id="69acb-202">Lahjakorttitransaktiot kirjataan tositteina.</span><span class="sxs-lookup"><span data-stu-id="69acb-202">Gift card transactions are posted as vouchers.</span></span> |
| <span data-ttu-id="69acb-203">10</span><span class="sxs-lookup"><span data-stu-id="69acb-203">10</span></span>          | <span data-ttu-id="69acb-204">Julkaistut</span><span class="sxs-lookup"><span data-stu-id="69acb-204">Posted</span></span>                  | <span data-ttu-id="69acb-205">Laskelma merkitään kirjatuksi.</span><span class="sxs-lookup"><span data-stu-id="69acb-205">The statement is marked as posted.</span></span> |

<span data-ttu-id="69acb-206">Jokainen edeltävien taulujen tila on luonteeltaan riippumaton, ja vaiheiden välille luodaan hierarkkinen riippuvuus.</span><span class="sxs-lookup"><span data-stu-id="69acb-206">Every state in the preceding tables is independent in nature, and a hierarchical dependency is built between the states.</span></span> <span data-ttu-id="69acb-207">Tämä riippuvuus kulkee ylhäältä alaspäin.</span><span class="sxs-lookup"><span data-stu-id="69acb-207">This dependency flows from top to bottom.</span></span> <span data-ttu-id="69acb-208">Jos järjestelmä havaitsee virheitä, kun se käsittelee tilaa, laskelman tila palautetaan aiempaan tilaan.</span><span class="sxs-lookup"><span data-stu-id="69acb-208">If the system encounters any errors while it's processing a state, the status of the statement is reverted to the previous state.</span></span> <span data-ttu-id="69acb-209">Kaikki myöhemmät prosessin uudelleenyritykset jatkavat epäonnistuneesta tilasta eteenpäin.</span><span class="sxs-lookup"><span data-stu-id="69acb-209">Any subsequent reattempt of the process resumes from the state that failed and continues to move forward.</span></span> <span data-ttu-id="69acb-210">Tämä vaihtoehto tarjoaa seuraavat edut:</span><span class="sxs-lookup"><span data-stu-id="69acb-210">This approach has the following benefits:</span></span>

- <span data-ttu-id="69acb-211">Käyttäjä näkee koko tilan, jossa virhe on esiintynyt.</span><span class="sxs-lookup"><span data-stu-id="69acb-211">The user has complete visibility into the state where the error occurred.</span></span>
- <span data-ttu-id="69acb-212">Tietojen turmeltuminen vältetään.</span><span class="sxs-lookup"><span data-stu-id="69acb-212">Data corruption is avoided.</span></span> <span data-ttu-id="69acb-213">Esimerkiksi vanhassa laskelman kirjaamistoiminnossa oli tapauksia, joissa jotkin myyntitilaukset laskutettiin, mutta toiset jätettiin avoimiksi.</span><span class="sxs-lookup"><span data-stu-id="69acb-213">For example, in the legacy statement posting feature, there were instances where some sales orders were invoiced but others were left open.</span></span> <span data-ttu-id="69acb-214">Joissain maksukirjauskansioissa oli myös tapauksia, joissa täsmäytettävää laskua ei löytynyt laskun kirjausvirheen vuoksi.</span><span class="sxs-lookup"><span data-stu-id="69acb-214">There were also instances where some payment journals didn't have a corresponding invoice to settle, because the invoice posting had an error.</span></span>
- <span data-ttu-id="69acb-215">Käyttäjät voivat tarkastella laskelman nykyistä tilaa käyttämällä **Tilan tiedot** -painiketta laskelman **Suorituksen tiedot** -ryhmässä.</span><span class="sxs-lookup"><span data-stu-id="69acb-215">Users can see the current state of a statement by using the **Status details** button in the **Execution details** group of the statement.</span></span> <span data-ttu-id="69acb-216">Tilan tiedot -sivussa on kolme osaa:</span><span class="sxs-lookup"><span data-stu-id="69acb-216">The status details page has three sections:</span></span>

    - <span data-ttu-id="69acb-217">Ensimmäisessä osassa esitetään laskelman nykyinen tila yhdessä mahdollisen virhekoodin ja virhesanoman kanssa.</span><span class="sxs-lookup"><span data-stu-id="69acb-217">The first section shows the current status of the statement, together with the error code and a detailed error message, if an error occurred.</span></span>
    - <span data-ttu-id="69acb-218">Toinen osa näyttää laskentaprosessin eri tilat.</span><span class="sxs-lookup"><span data-stu-id="69acb-218">The second section shows the various states of the calculation process.</span></span> <span data-ttu-id="69acb-219">Visuaaliset tehosteet näyttävät tilat, jotka on suoritettu onnistuneesti, joita ei voitu suorittaa virheiden vuoksi ja joita ei ole vielä suoritettu.</span><span class="sxs-lookup"><span data-stu-id="69acb-219">Visual cues indicate states that have been successfully run, states that could not be run because of errors, and states that haven't yet been run.</span></span>
    - <span data-ttu-id="69acb-220">Kolmas osa näyttää kirjausprosessin eri tilat.</span><span class="sxs-lookup"><span data-stu-id="69acb-220">The third section shows the various states of the posting process.</span></span> <span data-ttu-id="69acb-221">Visuaaliset tehosteet näyttävät tilat, jotka on suoritettu onnistuneesti, joita ei voitu suorittaa virheiden vuoksi ja joita ei ole vielä suoritettu.</span><span class="sxs-lookup"><span data-stu-id="69acb-221">Visual cues indicate states that have been successfully run, states that could not be run because of errors, and states that haven't yet been run.</span></span>

<span data-ttu-id="69acb-222">Lisäksi toisen ja kolmannen osan otsikko näyttää asianmukaisen prosessin kokonaistilan.</span><span class="sxs-lookup"><span data-stu-id="69acb-222">Additionally, the header of the second and third sections shows the overall status of the relevant process.</span></span>

### <a name="event-logs"></a><span data-ttu-id="69acb-223">Tapahtumalokit</span><span class="sxs-lookup"><span data-stu-id="69acb-223">Event logs</span></span>

<span data-ttu-id="69acb-224">Laskelma käy läpi eri työvaiheet (esimerkiksi Luo, Laske, Tyhjennä ja Kirjaa) ja laskelman elinkaaren aikana voidaan kutsua samaa toimintoa useita kertoja.</span><span class="sxs-lookup"><span data-stu-id="69acb-224">A statement goes through various operations (for example, Create, Calculate, Clear, and Post), and multiple instances of the same operation might be called during the statement's lifecycle.</span></span> <span data-ttu-id="69acb-225">Esimerkiksi, kun laskelma luodaan ja lasketaan, käyttäjä voi tyhjentää laskelman ja laskea sen uudelleen.</span><span class="sxs-lookup"><span data-stu-id="69acb-225">For example, after a statement is created and calculated, a user can clear the statement and calculate it again.</span></span> <span data-ttu-id="69acb-226">**Tapahtumalokit**-painike laskelman **Suorituksen tiedot** -ryhmässä tarjoaa täydellisen kirjausketjun eri toiminnoille, joita on kutsuttu laskelmassa, sekä tiedot toimintojen kutsujen ajankohdasta.</span><span class="sxs-lookup"><span data-stu-id="69acb-226">The **Event logs** button in the **Execution details** group of the statement provides a complete audit trail of the various operations that were called on a statement, together with information about when those operations were called.</span></span>

### <a name="aggregated-transactions"></a><span data-ttu-id="69acb-227">Kootut tapahtumat</span><span class="sxs-lookup"><span data-stu-id="69acb-227">Aggregated transactions</span></span>

<span data-ttu-id="69acb-228">Kirjausprosessin aikana myyntitapahtumat kootaan konfiguraation mukaan.</span><span class="sxs-lookup"><span data-stu-id="69acb-228">During the posting process, the sales transactions are aggregated based on the configuration.</span></span> <span data-ttu-id="69acb-229">Nämä kootut transaktiot tallennetaan järjestelmässä ja niitä käytetään myyntitilausten luomiseen.</span><span class="sxs-lookup"><span data-stu-id="69acb-229">These aggregated transactions are stored in the system and used to create sales orders.</span></span> <span data-ttu-id="69acb-230">Jokainen koottu transaktio luo vastaavan myyntitilauksen järjestelmässä.</span><span class="sxs-lookup"><span data-stu-id="69acb-230">Every aggregated transaction creates one corresponding sales order in the system.</span></span> <span data-ttu-id="69acb-231">Voit tarkastella koottuja transaktioita käyttämällä **Kootut tapahtumat** -painiketta laskelman **Suorituksen tiedot** -ryhmässä.</span><span class="sxs-lookup"><span data-stu-id="69acb-231">You can view the aggregated transactions by using the **Aggregated transactions** button in the **Execution details** group of the statement.</span></span>

<span data-ttu-id="69acb-232">Kootun transaktion **Myyntitilauksen tiedot** -välilehdessä näkyvät seuraavat tiedot:</span><span class="sxs-lookup"><span data-stu-id="69acb-232">The **Sales order detail** tab of an aggregated transaction shows the following information:</span></span>

- <span data-ttu-id="69acb-233">**Tietuetunnus** – Kootun transaktion tunnus.</span><span class="sxs-lookup"><span data-stu-id="69acb-233">**Record ID** – The ID of the aggregated transaction.</span></span>
- <span data-ttu-id="69acb-234">**Laskelman numero** – Laskelma, johon koottu transaktio kuuluu.</span><span class="sxs-lookup"><span data-stu-id="69acb-234">**Statement number** – The statement that the aggregated transaction belongs to.</span></span>
- <span data-ttu-id="69acb-235">**Päivämäärä** – Päivämäärä, jolloin koottu tapahtuma luotiin.</span><span class="sxs-lookup"><span data-stu-id="69acb-235">**Date** – The date when the aggregated transaction was created.</span></span>
- <span data-ttu-id="69acb-236">**Myyntitunnus** – Myyntitilauksen tunnus, kun myyntitilaus luodaan kootusta transaktiosta.</span><span class="sxs-lookup"><span data-stu-id="69acb-236">**Sales ID** – When a sales order is created from the aggregated transaction, the sales order ID.</span></span> <span data-ttu-id="69acb-237">Jos tämä kenttä on tyhjä, vastaavaa myyntitilausta ei ole luotu.</span><span class="sxs-lookup"><span data-stu-id="69acb-237">If this field is blank, the corresponding sales order hasn't been created.</span></span>
- <span data-ttu-id="69acb-238">**Koostettujen rivien määrä** – Kootun transaktion ja myyntitilauksen rivien kokonaismäärä.</span><span class="sxs-lookup"><span data-stu-id="69acb-238">**Number of aggregated lines** – The total number of lines for the aggregated transaction and sales order.</span></span>
- <span data-ttu-id="69acb-239">**Tila** – Kootun transaktion viimeisin tila.</span><span class="sxs-lookup"><span data-stu-id="69acb-239">**Status** – The last status of the aggregated transaction.</span></span>
- <span data-ttu-id="69acb-240">**Laskun tunnus** – Myyntilaskun tunus, kun kootun transaktion myyntitilaus laskutetaan.</span><span class="sxs-lookup"><span data-stu-id="69acb-240">**Invoice ID** – When the sales order for the aggregated transaction is invoiced, the sales invoice ID.</span></span> <span data-ttu-id="69acb-241">Jos tämä kenttä on tyhjä, myyntitilauksen laskua ei ole kirjattu.</span><span class="sxs-lookup"><span data-stu-id="69acb-241">If this field is blank, the invoice for the sales order hasn't been posted.</span></span>

<span data-ttu-id="69acb-242">Kootun taphtuman **Tapahtuman tiedot** -välilehdessä näkyvät kaikki tapahtumat, jotka on tuotu koottuun tapahtumaan.</span><span class="sxs-lookup"><span data-stu-id="69acb-242">The **Transaction details** tab of an aggregated transaction shows all the transactions that have been pulled into the aggregated transaction.</span></span> <span data-ttu-id="69acb-243">Kootun tapahtuman kootuilla riveillä näkyvät kaikki tapahtumien kootut tietueet.</span><span class="sxs-lookup"><span data-stu-id="69acb-243">The aggregated lines on the aggregated transaction show all the aggregated records from the transactions.</span></span> <span data-ttu-id="69acb-244">Kootuilla riveillä näkyy myös tietoja, kuten nimike, malli, määrä, hinta, nettosumma, yksikkö ja varasto.</span><span class="sxs-lookup"><span data-stu-id="69acb-244">The aggregated lines also show details such as the item, variant, quantity, price, net amount, unit, and warehouse.</span></span> <span data-ttu-id="69acb-245">Kukin koottu rivi vastaa yleisesti yhtä myyntitilausriviä.</span><span class="sxs-lookup"><span data-stu-id="69acb-245">Basically, each aggregated line corresponds to one sales order line.</span></span>

<span data-ttu-id="69acb-246">**Kootut tapahtumat** -sivulla voit ladata tietyn kootun tapahtuman XML:n valitsemalla **Vie myyntitilausten XML** -painikkeen.</span><span class="sxs-lookup"><span data-stu-id="69acb-246">From the **Aggregated transactions** page, you can download the XML for a specific aggregated transaction by using the **Export sales order XML** button.</span></span> <span data-ttu-id="69acb-247">Voit korjata myyntitilauksen luomisen ja kirjaamiseen liittyviä ongelmia XML-tiedoston avulla.</span><span class="sxs-lookup"><span data-stu-id="69acb-247">You can use the XML to debug issues that involve sales order creation and posting.</span></span> <span data-ttu-id="69acb-248">Lataa XML, lähetä se testiympäristöön ja tee virheenkorjaus testiympäristössä.</span><span class="sxs-lookup"><span data-stu-id="69acb-248">Just download the XML, upload it to a test environment, and debug the issue in the test environment.</span></span> <span data-ttu-id="69acb-249">Koottujen tapahtumien XML:n lataustoiminto ei ole käytettävissä laskelmille, jotka on kirjattu.</span><span class="sxs-lookup"><span data-stu-id="69acb-249">The functionality for downloading the XML for aggregated transactions isn't available for statements that have been posted.</span></span>

<span data-ttu-id="69acb-250">Kootun tapahtuman näkymä tarjoaa seuraavat edut:</span><span class="sxs-lookup"><span data-stu-id="69acb-250">The aggregated transaction view provides the following benefits:</span></span>

- <span data-ttu-id="69acb-251">Käyttäjä näkee kootut tapahtumat, jotka epäonnistuivat myyntitilauksen luonnin aikana, sekä myyntitilaukset, jotka epäonnistuivat laskutuksen aikana.</span><span class="sxs-lookup"><span data-stu-id="69acb-251">The user has visibility into the aggregated transactions that failed during sales order creation and the sales orders that failed during invoicing.</span></span>
- <span data-ttu-id="69acb-252">Käyttäjä näkee, kuinka tapahtumat kootaan.</span><span class="sxs-lookup"><span data-stu-id="69acb-252">The user has visibility into how transactions are aggregated.</span></span>
- <span data-ttu-id="69acb-253">Käyttäjällä on täydellinen kirjausketju aina tapahtumista myyntitilauksiin ja myyntilaskuihin.</span><span class="sxs-lookup"><span data-stu-id="69acb-253">The user has a complete audit trail, from transactions, to sales orders, to sales invoices.</span></span> <span data-ttu-id="69acb-254">Tätä kirjausketjua ei ollut käytettävissä vanhassa laskelman kirjaamistoiminnossa.</span><span class="sxs-lookup"><span data-stu-id="69acb-254">This audit trail wasn't available in the legacy statement posting feature.</span></span>
- <span data-ttu-id="69acb-255">Koottu XML-tiedosto helpottaa ongelmien tunnistamista myyntitilauksen luonnin ja laskutuksen yhteydessä.</span><span class="sxs-lookup"><span data-stu-id="69acb-255">Aggregated XML file make it easier to identify issues during sales order creation and invoicing.</span></span>

### <a name="journal-vouchers"></a><span data-ttu-id="69acb-256">Kirjaustositteet</span><span class="sxs-lookup"><span data-stu-id="69acb-256">Journal vouchers</span></span>

<span data-ttu-id="69acb-257">**Kirjaustositteet**-painike laskelman **Suorituksen tiedot** -ryhmässä näyttää kaikki eri tositetapahtumat, jotka on luotu laskelmaa varten ja jotka liittyvät alennuksiin, tuotto- ja kulutileihin, lahjakortteihin ja niin edelleen.</span><span class="sxs-lookup"><span data-stu-id="69acb-257">The **Journal vouchers** button in the **Execution details** group of the statement shows all the various voucher transactions that are created for a statement, and that are related to discounts, income/expense accounts, gift cards, and so on.</span></span>

<span data-ttu-id="69acb-258">Tällä hetkellä ohjelma näyttää nämä tiedot vain kirjattuja laskelmia varten.</span><span class="sxs-lookup"><span data-stu-id="69acb-258">Currently, the program shows this data only for posted statements.</span></span>

### <a name="payment-journals"></a><span data-ttu-id="69acb-259">Maksukirjauskansiot</span><span class="sxs-lookup"><span data-stu-id="69acb-259">Payment journals</span></span>

<span data-ttu-id="69acb-260">**Maksukirjauskansiot**-painike laskelman **Suorituksen tiedot** -ryhmässä näyttää kaikki eri maksukirjauskansiot, jotka on luotu laskelmaa varten.</span><span class="sxs-lookup"><span data-stu-id="69acb-260">The **Payment journals** button in the **Execution details** group of the statement shows all the various payment journals that are created for a statement.</span></span>

<span data-ttu-id="69acb-261">Tällä hetkellä ohjelma näyttää nämä tiedot vain kirjattuja laskelmia varten.</span><span class="sxs-lookup"><span data-stu-id="69acb-261">Currently, the program shows this data only for posted statements.</span></span>

## <a name="other-improvements"></a><span data-ttu-id="69acb-262">Muut parannukset</span><span class="sxs-lookup"><span data-stu-id="69acb-262">Other improvements</span></span>

<span data-ttu-id="69acb-263">Laskelman kirjaamistoimintoon on tehty muita taustajärjestelmän parannuksia, jotka ovat näkyvissä käyttäjälle.</span><span class="sxs-lookup"><span data-stu-id="69acb-263">Other, back-end improvements that users can see have been made to the statement posting feature.</span></span> <span data-ttu-id="69acb-264">Seuraavassa on muutamia esimerkkejä:</span><span class="sxs-lookup"><span data-stu-id="69acb-264">Here are some examples:</span></span>

- <span data-ttu-id="69acb-265">Kooste ei huomioi henkilöstön, päätteen ja vuoron yksiköitä.</span><span class="sxs-lookup"><span data-stu-id="69acb-265">The aggregation doesn't consider the staff, terminal, and shift entities.</span></span> <span data-ttu-id="69acb-266">Koska koosteparametreja on vähemmän, käsiteltäviä myyntitilausrivejä on vähemmän.</span><span class="sxs-lookup"><span data-stu-id="69acb-266">Because there are fewer aggregation parameters, fewer sales order lines must be processed.</span></span>
- <span data-ttu-id="69acb-267">Tapahtumatauluissa esiintyviä lukkiutumisia on vähennetty laajennustauluilla ja tapahtumien taulujen lisäystoiminnoilla päivitystoimintojen sijaan.</span><span class="sxs-lookup"><span data-stu-id="69acb-267">The occurrence of deadlock on transaction tables is reduced by introducing additional extension tables and by doing insert operations instead of update operations on the transaction tables.</span></span>
- <span data-ttu-id="69acb-268">Suoritettavien erätehtävien määrä on parametroitu ja rajoitettu.</span><span class="sxs-lookup"><span data-stu-id="69acb-268">The number of running batch tasks has been parameterized and limited.</span></span> <span data-ttu-id="69acb-269">Tätä määrää voidaan siten hienosäätää asiakkaan ympäristön mukaan.</span><span class="sxs-lookup"><span data-stu-id="69acb-269">Therefore, this number can be fine-tuned specifically to a customer's environment.</span></span> <span data-ttu-id="69acb-270">Vanhassa laskelman kirjaustoiminnossa luotiin samalla kertaa rajaton määrä erätehtäviä.</span><span class="sxs-lookup"><span data-stu-id="69acb-270">In the legacy statement posting feature, an unlimited number of batch tasks was created at the same time.</span></span> <span data-ttu-id="69acb-271">Se aiheutti hallitsemattomia kuormia, yleiskustannuksia ja pullonkauloja eräpalvelimessa.</span><span class="sxs-lookup"><span data-stu-id="69acb-271">The results were unmanageable loads, overhead, and bottlenecks on the batch server.</span></span>
- <span data-ttu-id="69acb-272">Laskelmien käsittelyn jonotus hoidetaan tehokkaasti priorisoimalla laskelmat, joissa on suurin määrä tapahtumia.</span><span class="sxs-lookup"><span data-stu-id="69acb-272">Statements are efficiently queued for processing by prioritizing the statements that have the maximum number of transactions.</span></span>
- <span data-ttu-id="69acb-273">Eräprosessit, kuten **Laskelmien laskenta eräajona** ja **Laskelmien kirjaaminen eräajona** suoritetaan vain erätilassa.</span><span class="sxs-lookup"><span data-stu-id="69acb-273">Batch processes such as **Calculate statements in batch** and **Post statements in batch** are run only in batch mode.</span></span> <span data-ttu-id="69acb-274">Vanhassa laskelmien kirjaamistoiminnossa käyttäjät voivat suorittaa näytä eräprosesseja vuorovaikutteisessa tilassa, joka on yksisäikeinen toiminto toisin kuin eräprosessit, jotka ovat monisäikeisiä.</span><span class="sxs-lookup"><span data-stu-id="69acb-274">In the legacy statement posting feature, users could choose to run these batch processes in an interactive mode which is s single threaded operation unlike batch processes which are multi-threaded.</span></span>
- <span data-ttu-id="69acb-275">Vanhassa laskelman kirjaustoiminnossa erätehtävän virheet asettivat koko erätyön virhetilaan.</span><span class="sxs-lookup"><span data-stu-id="69acb-275">In the legacy statement posting feature, any failure of a batch task put the whole batch job in an error state.</span></span> <span data-ttu-id="69acb-276">Parannetussa toiminnon erätehtävän virheet eivät aseta erätyötä virhetilaan, jos muut erätehtävät on suoritettu onnistuneesti.</span><span class="sxs-lookup"><span data-stu-id="69acb-276">In the improved feature, batch task failures don't put the batch job in an error state if other batch tasks are successfully completed.</span></span> <span data-ttu-id="69acb-277">Sinun tulee arvioida erän suoritusajon kirjaustila käyttämällä **Laskelmat**-sivua, jossa voit tarkastella kaikkia laskelmia, joita ei ole kirjattu virheiden vuoksi.</span><span class="sxs-lookup"><span data-stu-id="69acb-277">You should assess the posting status for a batch execution run by using the **Statements** page, where you can see any statements that weren't posted because of errors.</span></span>
- <span data-ttu-id="69acb-278">Vanhassa laskelman kirjaustoiminnossa laskelman virheen ensimmäinen esiintymä aiheutti koko erän epäonnistumisen.</span><span class="sxs-lookup"><span data-stu-id="69acb-278">In the legacy statement posting feature, the first occurrence of a statement failure causes the whole batch to fail.</span></span> <span data-ttu-id="69acb-279">Jäljellä olevia laskelmia ei käsitelty.</span><span class="sxs-lookup"><span data-stu-id="69acb-279">The remaining statements aren't processed.</span></span> <span data-ttu-id="69acb-280">Parannetussa toiminnossa eräkäsittely jatkaa kaikken laskelmien käsittelyä, vaikka osa laskelmista epäonnistuu.</span><span class="sxs-lookup"><span data-stu-id="69acb-280">In the improved feature, the batch process continues to process all statements, even if some of the statements fail.</span></span> <span data-ttu-id="69acb-281">Yksi etu on, että käyttäjät näkevät tarkasti niiden tiliotteiden määrän, joissa on virheitä.</span><span class="sxs-lookup"><span data-stu-id="69acb-281">One benefit is that users gain visibility into the exact number of statements that have errors.</span></span> <span data-ttu-id="69acb-282">Tällöin käyttäjien ei tarvitse jäädä silmukkaan, jossa virheitä korjataan ja laskelmaprosessi suoritetaan, kunnes kaikki laskelmat on kirjattu.</span><span class="sxs-lookup"><span data-stu-id="69acb-282">Therefore, users don't have to be stuck in a continuous loop of fixing the errors and running the post statement process till all statements are posted.</span></span>

## <a name="general-guidance-about-the-statement-posting-process"></a><span data-ttu-id="69acb-283">Yleisiä ohjeita laskelman kirjausprosessia varten</span><span class="sxs-lookup"><span data-stu-id="69acb-283">General guidance about the statement posting process</span></span>

- <span data-ttu-id="69acb-284">On suositeltavaa suorittaa laskelman kirjausprosessi eränä, koska eräajo hyödyntää monisäikeisen järjestelmän tehokkuutta.</span><span class="sxs-lookup"><span data-stu-id="69acb-284">We recommend that you run the statement posting process in a batch, because batch runs take advantage of the power of the batch framework in terms of multithreading.</span></span> <span data-ttu-id="69acb-285">Monisäikeisyyttä tarvitaan, jotta voidaan käsitellä valtavia tapahtumamääriä, jotka ovat yleisiä laskelmien kirjauksissa.</span><span class="sxs-lookup"><span data-stu-id="69acb-285">Multithreading is required in order to handle the huge volumes of transactions that are normally seen in statement postings.</span></span>
- <span data-ttu-id="69acb-286">On suositeltavaa, että otat käyttöön negatiivisen fyysisen varaston nimikemalliryhmässä, jotta kirjauskokemus on saumaton.</span><span class="sxs-lookup"><span data-stu-id="69acb-286">We recommend that you turn on negative physical inventory on the item model group, so that you have a seamless posting experience.</span></span> <span data-ttu-id="69acb-287">Joissakin tilanteissa negatiivisia laskelmia ei ehkä voi kirjata, ellei negatiivista fyysistä varastoa ole.</span><span class="sxs-lookup"><span data-stu-id="69acb-287">In some scenarios, negative statements might not be able to be posted unless there is negative physical inventory.</span></span> <span data-ttu-id="69acb-288">Esimerkiksi teoriassa, jos varastossa on vain yksi kappale nimikettä ja sille on tehty myyntitapahtuma ja palautustapahtuma, tapahtumaan pitäisi voida kirjata, vaikka negatiivinen varasto ei ole käytössä.</span><span class="sxs-lookup"><span data-stu-id="69acb-288">For example, in theory, if there is only one unit of an item in inventory, and there have been a sales transaction and a return transaction for the item, the transaction should be able to be posted even if negative inventory isn't turned on.</span></span> <span data-ttu-id="69acb-289">Koska laskelman kirjausprosessi ottaa sekä myyntitapahtuman että palautustapahtuman samaan asiakastilaukseen, ei voida kuitenkaan taata, että myyntirivi kirjataan ensin ja palautusrivi sen jälkeen.</span><span class="sxs-lookup"><span data-stu-id="69acb-289">However, because the statement posting process pulls both the sales transaction and the return transaction in a single customer order, there is no guarantee that the sales line will be posted first, followed by the return line.</span></span> <span data-ttu-id="69acb-290">Tällöin voi ilmetä virheitä.</span><span class="sxs-lookup"><span data-stu-id="69acb-290">Therefore, errors can occur.</span></span> <span data-ttu-id="69acb-291">Jos negatiivinen varasto on käytössä tässä tilanteessa, tapahtuman kirjaus ei vaikuta negatiivisesti ja järjestelmä näyttää varaston oikein.</span><span class="sxs-lookup"><span data-stu-id="69acb-291">If negative inventory is turned on in this scenario, the transaction posting isn't negatively affected, and the system will correctly reflect the inventory.</span></span>
- <span data-ttu-id="69acb-292">On suositeltavaa käyttää koostamista laskelmia laskettaessa ja kirjattaessa.</span><span class="sxs-lookup"><span data-stu-id="69acb-292">We recommend that you use aggregation while you calculate and post statements.</span></span> <span data-ttu-id="69acb-293">Suosittelemme siksi seuraavia asetuksia joitakin koostamisparametreja varten:</span><span class="sxs-lookup"><span data-stu-id="69acb-293">Therefore, the following settings are recommended for some of the aggregation parameters:</span></span>

    - <span data-ttu-id="69acb-294">Siirry kohtaan **Vähittäismyynti ja kauppa** \> **Pääkonttorin asetukset** \> **Parametrit** \> **Kaupan parametrit**.</span><span class="sxs-lookup"><span data-stu-id="69acb-294">Go to **Retail and Commerce** \> **Headquarters setup** \> **Parameters** \> **Commerce parameters**.</span></span> <span data-ttu-id="69acb-295">Valitse sitten **Kirjaus**-välilehdellä **Varastopäivitys**-pikavälilehden **Erittelytaso**-kentässä **Yhteenveto**.</span><span class="sxs-lookup"><span data-stu-id="69acb-295">Then, on the **Posting** tab, on the **Inventory update** FastTab, in the **Detail level** field, select **Summary**.</span></span>
    - <span data-ttu-id="69acb-296">Siirry kohtaan **Vähittäismyynti ja kauppa** \> **Pääkonttorin asetukset** \> **Parametrit** \> **Kaupan parametrit**.</span><span class="sxs-lookup"><span data-stu-id="69acb-296">Go to **Retail and Commerce** \> **Headquarters setup** \> **Parameters** \> **Commerce parameters**.</span></span> <span data-ttu-id="69acb-297">Aseta sitten **Kirjaus**-välilehden **Koostaminen**-pikavälilehdessä **Tositetapahtumat**-asetukseksi **Kyllä**.</span><span class="sxs-lookup"><span data-stu-id="69acb-297">Then, on the **Posting** tab, on the **Aggregation** FastTab, set the **Voucher transactions** option to **Yes**.</span></span>


[!INCLUDE[footer-include](../includes/footer-banner.md)]