---
title: Monikanavaisten maksujen yleiskatsaus
description: Tässä ohjeaiheessa on yhteenveto Omni-Channel-maksuista Dynamics 365 Commercessa.
author: rubendel
ms.date: 09/17/2020
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Application user
ms.reviewer: josaw
ms.custom: 141393
ms.assetid: ''
ms.search.region: Global
ms.search.industry: Retail
ms.author: rubendel
ms.search.validFrom: 2019-01-01
ms.dyn365.ops.version: AX 8.1.3
ms.openlocfilehash: 7b99b5f7b5b972d41e0831995bde69e9041369b9
ms.sourcegitcommit: cabd991fda2bfcabb55db84c225b24a7bb061631
ms.translationtype: HT
ms.contentlocale: fi-FI
ms.lasthandoff: 05/12/2021
ms.locfileid: "6028008"
---
# <a name="omni-channel-payments-overview"></a><span data-ttu-id="9e455-103">Omnikanavan maksujen yleiskatsaus</span><span class="sxs-lookup"><span data-stu-id="9e455-103">Omni-channel payments overview</span></span>

[!include [banner](../includes/banner.md)]

<span data-ttu-id="9e455-104">Tässä ohjeaiheessa on yhteenveto Omni-Channel-maksuista Dynamics 365 Commercessa.</span><span class="sxs-lookup"><span data-stu-id="9e455-104">This topic provides an overview of omni-channel payments in Dynamics 365 Commerce.</span></span> <span data-ttu-id="9e455-105">Se sisältää kattavan luettelon tuetuista skenaarioista, tietoja toiminnoista, asetuksista ja vianmäärityksestä sekä joidenkin tavallisten ongelmien kuvauksia.</span><span class="sxs-lookup"><span data-stu-id="9e455-105">It includes a comprehensive list of supported scenarios, information about functionality, setup, and troubleshooting, and descriptions of some typical issues.</span></span>

## <a name="key-terms"></a><span data-ttu-id="9e455-106">Tärkeimmät termit</span><span class="sxs-lookup"><span data-stu-id="9e455-106">Key terms</span></span>

| <span data-ttu-id="9e455-107">Kausi</span><span class="sxs-lookup"><span data-stu-id="9e455-107">Term</span></span> | <span data-ttu-id="9e455-108">Kuvaus</span><span class="sxs-lookup"><span data-stu-id="9e455-108">Description</span></span> |
|---|---|
| <span data-ttu-id="9e455-109">Tunnus</span><span class="sxs-lookup"><span data-stu-id="9e455-109">Token</span></span> | <span data-ttu-id="9e455-110">Tietomerkkijono, jonka maksukäsittelijä antaa viitteenä.</span><span class="sxs-lookup"><span data-stu-id="9e455-110">A string of data that a payment processor provides as a reference.</span></span> <span data-ttu-id="9e455-111">Tunnukset voivat edustaa maksukorttien numeroita, maksujen varmennuksia ja aiempia maksuja.</span><span class="sxs-lookup"><span data-stu-id="9e455-111">Tokens can represent payment card numbers, payment authorizations, and previous payment captures.</span></span> <span data-ttu-id="9e455-112">Tunnukset ovat tärkeitä, koska ne auttavat pitämään luottamukselliset tiedot poissa myyntipisteen (POS) järjestelmästä.</span><span class="sxs-lookup"><span data-stu-id="9e455-112">Tokens are important because they help keep sensitive data out of the point of sale (POS) system.</span></span> <span data-ttu-id="9e455-113">Niitä kutsutaan joskus myös *viitteiksi*.</span><span class="sxs-lookup"><span data-stu-id="9e455-113">They are sometimes also referred to as *references*.</span></span> |
| <span data-ttu-id="9e455-114">Kortin tunnus</span><span class="sxs-lookup"><span data-stu-id="9e455-114">Card token</span></span> | <span data-ttu-id="9e455-115">Tunnus, jota maksujen käsittelytoiminto tarjoaa varastoon myyntipistejärjestelmässä.</span><span class="sxs-lookup"><span data-stu-id="9e455-115">A token that a payment processor provides for storage in the POS system.</span></span> <span data-ttu-id="9e455-116">Korttitunnusta voi käyttää vain sen vastaanottava kauppias.</span><span class="sxs-lookup"><span data-stu-id="9e455-116">A card token can be used only by the merchant who receives it.</span></span> <span data-ttu-id="9e455-117">Korttitunnuksia kutsutaan joskus myös *korttiviitteiksi*.</span><span class="sxs-lookup"><span data-stu-id="9e455-117">Card tokens are sometimes also referred to as *card references*.</span></span> |
| <span data-ttu-id="9e455-118">Varmennussanake</span><span class="sxs-lookup"><span data-stu-id="9e455-118">Authorization (auth) token</span></span> | <span data-ttu-id="9e455-119">Yksilöivä tunnus, jota maksuprosessi tarjoaa osana POS-järjestelmään lähettämäänsä vastausta, kun POS-järjestelmä tekee valtuutuspyynnön.</span><span class="sxs-lookup"><span data-stu-id="9e455-119">A unique ID that a payment process provides as part of the response that it sends to a POS system after the POS system makes an authorization request.</span></span> <span data-ttu-id="9e455-120">Valtuutustietotunnusta voi käyttää myöhemmin, jos suoritinta kutsutaan suorittamaan toimintoja, kuten peruutettaessa tai mitätöidessä valtuutusta.</span><span class="sxs-lookup"><span data-stu-id="9e455-120">An authorization token can be used later if the processor is called to perform actions such as reversing or voiding the authorization.</span></span> <span data-ttu-id="9e455-121">Sitä käytetään kuitenkin useimmiten varojen sieppaamiseen, kun tilaus täyttyy tai tapahtuma viimeistellään.</span><span class="sxs-lookup"><span data-stu-id="9e455-121">However, it's most often used to capture funds when an order is fulfilled or a transaction is finalized.</span></span> <span data-ttu-id="9e455-122">Valtuutuksen tunnuksia kutsutaan joskus myös *Valtuutuksen viitteiksi*.</span><span class="sxs-lookup"><span data-stu-id="9e455-122">Authorization tokens are sometimes also referred to as *authorization references*.</span></span> |
| <span data-ttu-id="9e455-123">Sieppauksen tunnus</span><span class="sxs-lookup"><span data-stu-id="9e455-123">Capture token</span></span> | <span data-ttu-id="9e455-124">Viite, jonka maksukäsittelijä tarjoaa POS-järjestelmälle, kun maksu viimeistellään tai siepataan.</span><span class="sxs-lookup"><span data-stu-id="9e455-124">A reference that a payment processor provides to a POS system when a payment is finalized or captured.</span></span> <span data-ttu-id="9e455-125">Tämän jälkeen voit käyttää sieppaustunnusta, kun haluat viitata maksun sieppaamiseen seuraavissa toiminnoissa, kuten hyvityspyynnöissä.</span><span class="sxs-lookup"><span data-stu-id="9e455-125">The capture token can then be used to reference the payment capture in subsequent operations, such as refund requests.</span></span> | 
| <span data-ttu-id="9e455-126">Kortti ei ole paikalla</span><span class="sxs-lookup"><span data-stu-id="9e455-126">Card not present</span></span> | <span data-ttu-id="9e455-127">Termi, joka viittaa maksutapahtumiin, joissa fyysistä korttia ei ole esitetty.</span><span class="sxs-lookup"><span data-stu-id="9e455-127">A term that refers to payment transactions where a physical card isn't presented.</span></span> <span data-ttu-id="9e455-128">Tällaisia tapahtumia voivat olla esimerkiksi sähköinen kaupankäynti tai Call Center -skenaariot.</span><span class="sxs-lookup"><span data-stu-id="9e455-128">For example, these transactions can occur in e-commerce or call center scenarios.</span></span> <span data-ttu-id="9e455-129">Näitä tapahtumia varten maksuun liittyvät tiedot syötetään manuaalisesti sähköisen kaupankäynnin Internet-sivustoon, puhelukeskuksen työnkulkuun tai POS- tai maksupäätteelle.</span><span class="sxs-lookup"><span data-stu-id="9e455-129">For these transactions, the payment-related information is manually entered on an e-commerce website, in a call center flow, or on the POS or payment terminal.</span></span> |
| <span data-ttu-id="9e455-130">Kortti paikalla</span><span class="sxs-lookup"><span data-stu-id="9e455-130">Card present</span></span> | <span data-ttu-id="9e455-131">Termi, joka viittaa maksutapahtumiin, joissa fyysinen kortti esitetään ja jota käytetään Microsoft Dynamics 365 POS -järjestelmään liitetyssä maksupäätteessä.</span><span class="sxs-lookup"><span data-stu-id="9e455-131">A term that refers to payment transactions where a physical card is presented and used on a payment terminal that is connected to the Microsoft Dynamics 365 POS system.</span></span> |

## <a name="overview"></a><span data-ttu-id="9e455-132">Yleiskuvaus</span><span class="sxs-lookup"><span data-stu-id="9e455-132">Overview</span></span>

<span data-ttu-id="9e455-133">Yleensä termi *Omni-Channel-maksu* kuvaa mahdollisuutta luoda tilauksen yhdellä kanavalla ja täyttää sen toisella kanavalla.</span><span class="sxs-lookup"><span data-stu-id="9e455-133">In general, the term *omni-channel payments* describes the ability to create an order in one channel and fulfill it in another channel.</span></span> <span data-ttu-id="9e455-134">Omni-Channel-tuki tuen avain on, että maksut säilyvät yhdessä muiden tilaustietojen kanssa ja että näitä maksuja koskevia tietoja käytetään, kun tilaus palautetaan tai sitä käsitellään toisessa kanavassa.</span><span class="sxs-lookup"><span data-stu-id="9e455-134">The key to omni-channel payment support is preserving payment details together with the rest of the order details, and then using those payment details when the order is recalled or processed in another channel.</span></span> <span data-ttu-id="9e455-135">Klassinen esimerkki on "Osta verkosta, nouda myymälästä" -skenaario.</span><span class="sxs-lookup"><span data-stu-id="9e455-135">A classic example is the "Buy online, pick up in store" scenario.</span></span> <span data-ttu-id="9e455-136">Tässä skenaariossa maksutiedot lisätään, kun tilaus luodaan verkossa.</span><span class="sxs-lookup"><span data-stu-id="9e455-136">In this scenario, the payment details are added when the order is created online.</span></span> <span data-ttu-id="9e455-137">Tämän jälkeen ne palautetaan myyntipisteessä asiakkaan maksukortin veloittamiseksi noutohetkellä.</span><span class="sxs-lookup"><span data-stu-id="9e455-137">They are then recalled at the POS to charge the customer's payment card at the time of pickup.</span></span> 

<span data-ttu-id="9e455-138">Kaikki tässä ohjeaiheessa kuvatut skenaariot voidaan toteuttaa Kauppa-ohjelmiston vakiomaksuohjelmiston kehityspaketin (SDK) avulla.</span><span class="sxs-lookup"><span data-stu-id="9e455-138">All the scenarios that are described in this topic can be implemented by using the standard Payments software development kit (SDK) that is provided with Commerce.</span></span> <span data-ttu-id="9e455-139">[Adyen-järjestelmän Dynamics 365 -maksuyhdysliitin](/dynamics365/unified-operations/retail/dev-itpro/adyen-connector?tabs=8-1-3) sisältää kaikki tässä kuvatut skenaariot.</span><span class="sxs-lookup"><span data-stu-id="9e455-139">The [Dynamics 365 Payment Connector for Adyen](/dynamics365/unified-operations/retail/dev-itpro/adyen-connector?tabs=8-1-3) provides an out-of-box implementation of every scenario that is described here.</span></span> 

### <a name="prerequisites"></a><span data-ttu-id="9e455-140">Edellytykset</span><span class="sxs-lookup"><span data-stu-id="9e455-140">Prerequisites</span></span>

<span data-ttu-id="9e455-141">Kaikissa tässä ohjeaiheessa kuvatuissa skenaarioissa on määritettävä maksuyhteys, joka tukee Omni-Channel-maksuja.</span><span class="sxs-lookup"><span data-stu-id="9e455-141">Every scenario that is described in this topic requires a payment connector that supports omni-channel payments.</span></span> <span data-ttu-id="9e455-142">Myös valmiiksi määritettyä Adyen-liitintä voidaan käyttää, koska se tukee skenaarioita, jotka ovat käytettävissä Payments SDK:n kautta.</span><span class="sxs-lookup"><span data-stu-id="9e455-142">The out-of-box Adyen connector can also be used, because it supports the scenarios that are made available through the Payments SDK.</span></span> <span data-ttu-id="9e455-143">Lisätietoja maksuyhdistimien toteuttamisesta ja Retail SDK:sta yleensä on [IT-ammattilaisten ja -kehittäjien kotisivulla](/dynamics365/unified-operations/retail/dev-itpro/dev-retail-home-page#payment-connectors).</span><span class="sxs-lookup"><span data-stu-id="9e455-143">For more information about how to implement payment connectors, and about the Retail SDK in general, visit the [Retail for IT pros and developers home page](/dynamics365/unified-operations/retail/dev-itpro/dev-retail-home-page#payment-connectors).</span></span>

#### <a name="supported-versions"></a><span data-ttu-id="9e455-144">Tuetut versiot</span><span class="sxs-lookup"><span data-stu-id="9e455-144">Supported versions</span></span>

<span data-ttu-id="9e455-145">Tässä ohjeaiheessa kuvatut Omni-Channel-maksuominaisuudet on julkaistu osana Microsoft Dynamics 365 for Retail -versiota 8.1.3.</span><span class="sxs-lookup"><span data-stu-id="9e455-145">The omni-channel payment capabilities that are described in this topic were released as part of Microsoft Dynamics 365 for Retail version 8.1.3.</span></span> 

#### <a name="card-present-and-card-not-present-connectors"></a><span data-ttu-id="9e455-146">Kortti on käytössä ja Kortti ei ole käytössä -yhdistimet</span><span class="sxs-lookup"><span data-stu-id="9e455-146">"Card present" and "card not present" connectors</span></span>

<span data-ttu-id="9e455-147">Payments SDK sisältää kaksi maksuille tarkoitettua ohjelmointirajapinta (API) -liittymää.</span><span class="sxs-lookup"><span data-stu-id="9e455-147">The Payments SDK relies on two sets of application programming interfaces (APIs) for payments.</span></span> <span data-ttu-id="9e455-148">Ensimmäinen ohjelmointirajapinta on nimeltään **iPaymentProcessor**.</span><span class="sxs-lookup"><span data-stu-id="9e455-148">The first set of APIs is named **iPaymentProcessor**.</span></span> <span data-ttu-id="9e455-149">Sitä käytetään toteuttamaan "kortti ei ole paikalla -maksuyhdistimiä, joita voidaan käyttää Call Center- ja Microsoft Dynamics e-Commerce-alustalla.</span><span class="sxs-lookup"><span data-stu-id="9e455-149">It's used to implement "card not present" payment connectors that can be used in call centers and with the Microsoft Dynamics e-Commerce platform.</span></span> <span data-ttu-id="9e455-150">Lisätietoja **iPaymentProcessor**-käyttöliittymästä on [Toteuta maksuyhteys-ja maksulaite](https://download.microsoft.com/download/e/2/7/e2735c65-1e66-4b8d-8a3c-e6ef3a319137/The%20Guide%20to%20Implementing%20Payment%20Connector%20and%20Payment%20Device_update.pdf) -valkoisessa kirjassa, joka kattaa maksut.</span><span class="sxs-lookup"><span data-stu-id="9e455-150">For more information about the **iPaymentProcessor** interface, see the [Implement a payment connector and a payment device](https://download.microsoft.com/download/e/2/7/e2735c65-1e66-4b8d-8a3c-e6ef3a319137/The%20Guide%20to%20Implementing%20Payment%20Connector%20and%20Payment%20Device_update.pdf) white paper, which covers payments.</span></span> 

<span data-ttu-id="9e455-151">Toinen ohjelmointirajapinta on nimeltään **iNamedRequestHandler**.</span><span class="sxs-lookup"><span data-stu-id="9e455-151">The second set of APIs is named **iNamedRequestHandler**.</span></span> <span data-ttu-id="9e455-152">Se tukee Kortti on paikalla maksuintegraatioita, jotka käyttävät maksupäätettä.</span><span class="sxs-lookup"><span data-stu-id="9e455-152">It supports the implementation of "card present" payment integrations that use a payment terminal.</span></span> <span data-ttu-id="9e455-153">Lisätietoja **iNamedRequestHandler**-liittymästä on kohdassa [Maksuintegroinnin luominen maksupäätteelle](/dynamics365/unified-operations/retail/dev-itpro/end-to-end-payment-extension).</span><span class="sxs-lookup"><span data-stu-id="9e455-153">For more information about the **iNamedRequestHandler** interface, see [Create a payment integration for a payment terminal](/dynamics365/unified-operations/retail/dev-itpro/end-to-end-payment-extension).</span></span> 

### <a name="setup-and-configuration"></a><span data-ttu-id="9e455-154">Asetukset ja määrittäminen</span><span class="sxs-lookup"><span data-stu-id="9e455-154">Setup and configuration</span></span>

<span data-ttu-id="9e455-155">Seuraavat komponentit ja asetusvaiheet ovat pakollisia:</span><span class="sxs-lookup"><span data-stu-id="9e455-155">The following components and setup steps are required:</span></span>

- <span data-ttu-id="9e455-156">**eCommerce-integrointi**: Kauppaintegroinnin on tuettava tilanteita, joissa tilauksen lähtöpaikka on online-myymälä.</span><span class="sxs-lookup"><span data-stu-id="9e455-156">**eCommerce integration:** An integration with Commerce is required to support scenarios where an order originates in an online storefront.</span></span> <span data-ttu-id="9e455-157">Lisätietoja Retail e-Commerce SDK:sta on kohdassa [Sähköisen kaupankäynnin Platform Software Development Kit (SDK)](/dynamics365/unified-operations/retail/dev-itpro/ecommerce-platform-sdk).</span><span class="sxs-lookup"><span data-stu-id="9e455-157">For more information about the Retail e-Commerce SDK, see [e-Commerce platform software development kit (SDK)](/dynamics365/unified-operations/retail/dev-itpro/ecommerce-platform-sdk).</span></span> <span data-ttu-id="9e455-158">Demo-ympäristössä viitemyymälä tukee Omni-Channel-maksuskenaarioita.</span><span class="sxs-lookup"><span data-stu-id="9e455-158">In a demo environment, the reference storefront supports omni-channel payment scenarios.</span></span> 
- <span data-ttu-id="9e455-159">**Online-maksun määritys**: Online-kanavan asetusten on sisällettävä maksuyhteys, joka on päivitetty tukemaan Omni-Channel-maksuja.</span><span class="sxs-lookup"><span data-stu-id="9e455-159">**Online payments configuration:** The setup of the online channel must include a payment connector that has been updated to support omni-channel payments.</span></span> <span data-ttu-id="9e455-160">Vaihtoehtoisesti voidaan käyttää käyttövalmista maksuyhdistintä.</span><span class="sxs-lookup"><span data-stu-id="9e455-160">Alternatively, the out-of-box payment connector can be used.</span></span> <span data-ttu-id="9e455-161">Lisätietoja Adyen-maksuyhdistimestä verkkokauppojen konfiguroinnissa on kohdassa [Adyen-maksuyhdistin](/dynamics365/unified-operations/retail/dev-itpro/adyen-connector?tabs=8-1-3#e-commerce).</span><span class="sxs-lookup"><span data-stu-id="9e455-161">For information about how to configure the Adyen payment connector for online stores, see [Adyen payment connector](/dynamics365/unified-operations/retail/dev-itpro/adyen-connector?tabs=8-1-3#e-commerce).</span></span> <span data-ttu-id="9e455-162">Tässä ohjeaiheessa kuvattujen verkkokaupan määritysvaiheiden lisäksi **Salli säästö tiedot e-Commerce** -parametrin asetuksen arvoksi on määritettävä **Tosi** Adyen-liittimen asetuksissa.</span><span class="sxs-lookup"><span data-stu-id="9e455-162">In addition to the eCommerce setup steps that are described in that topic, the **Allow saving payment information in e-commerce** parameter must be set to **True** in the settings for the Adyen connector.</span></span> 
- <span data-ttu-id="9e455-163">**Omni-Channel-maksujen konfiguraatio**: Siirry taustajärjestelmäsovelluksessa kohtaan **Vähittäismyynti ja kauppa \> Headquarters-sovelluksen asetus \> Parametrit \> Kaupan jaetut parametrit**.</span><span class="sxs-lookup"><span data-stu-id="9e455-163">**Omni-channel payments configuration:** In the back office, go to **Retail and Commerce \> Headquarters setup \> Parameters \> Commerce shared parameters**.</span></span> <span data-ttu-id="9e455-164">Aseta sitten **Omni-Channel-maksujen** -välilehdessä **Käytä Omni-Channel-maksuja** -asetukseksi **Kyllä**.</span><span class="sxs-lookup"><span data-stu-id="9e455-164">Then, on the **Omni-channel payments** tab, set the **Use omni-channel payments** option to **Yes**.</span></span> <span data-ttu-id="9e455-165">Commercen versiossa 10.0.12 ja uudemmissa versioissa tämä asetus on **Ominaisuuksien hallinta** -työtilassa.</span><span class="sxs-lookup"><span data-stu-id="9e455-165">In Commerce versions 10.0.12 and later, this setting is in the **Feature Management** workspace.</span></span> <span data-ttu-id="9e455-166">Valitse **Monikanavan maksut** -ominaisuus ja valitse sitten **Ota käyttöön nyt**.</span><span class="sxs-lookup"><span data-stu-id="9e455-166">Select the **Omni-channel payments** feature and click **Enable now**.</span></span> 
- <span data-ttu-id="9e455-167">**Maksupalvelut:** Call center käyttää **Maksupalvelut**-sivun oletusmaksuyhdistintä maksujen käsittelemiseen.</span><span class="sxs-lookup"><span data-stu-id="9e455-167">**Payment services:** The call center uses the default payment connector on the **Payment services** page to process payments.</span></span> <span data-ttu-id="9e455-168">Jos haluat tukea skenaarioita, kuten Osta call centeristä, poimi myymälästä, tämän oletusmaksuyhdistimen on oltava Adyen-maksuyhdistin tai maksuyhdistin, joka täyttää Omni-Channel-maksuissa käytettävät toteutusvaatimukset.</span><span class="sxs-lookup"><span data-stu-id="9e455-168">To support scenarios such as "Buy in call center, pick up in store," this default payment connector must be the Adyen payment connector or a payment connector that meets the implementation requirements for omni-channel payments.</span></span>
- <span data-ttu-id="9e455-169">**EFT-palvelu**: Maksupäätteen kautta suoritettavat maksut on määritettävä laitteistoprofiilin **EFT-palvelu**-pikavälilehdessä.</span><span class="sxs-lookup"><span data-stu-id="9e455-169">**EFT service:** Payments through a payment terminal must be set up on the **EFT service** FastTab of the hardware profile.</span></span> <span data-ttu-id="9e455-170">Adyen-yhdistin tukee käyttövalmiita Omni-Channel-maksuskenaarioita.</span><span class="sxs-lookup"><span data-stu-id="9e455-170">The Adyen connector supports omni-channel payments scenarios out of the box.</span></span> <span data-ttu-id="9e455-171">Myös muita **iNamedRequestHandler**-maksuyhdistimiä voidaan käyttää, jos ne tukevat Omni-Channel-maksuja.</span><span class="sxs-lookup"><span data-stu-id="9e455-171">Other payment connectors that support the **iNamedRequestHandler** interface can also be used if they support omni-channel payments.</span></span>
- <span data-ttu-id="9e455-172">**Maksuyhteyden käytettävyys:** Kun tilaus palautetaan, maksuvälineriveihin, jotka palautetaan yhteen tilauksen kanssa, kuuluu sen maksuyhteyden nimi, jota käytettiin tähän tilaukseen liittyvien lupien luomisessa.</span><span class="sxs-lookup"><span data-stu-id="9e455-172">**Payment connector availability:** When an order is recalled, the payment tender lines that are recalled together with the order include the name of the payment connector that was used to create the authorizations that are associated with that order.</span></span> <span data-ttu-id="9e455-173">Kun tilaus on täytetty, maksun SDK yrittää käyttää samaa yhdistintä, jota käytettiin alkuperäisen valtuutuksen luomisessa.</span><span class="sxs-lookup"><span data-stu-id="9e455-173">When the order is fulfilled, the Payments SDK tries to use the same connector that was used to create the original authorization.</span></span> <span data-ttu-id="9e455-174">Näin ollen on oltava käytettävissä kaappaamiseen myös sellainen maksuyhdistin, jolla on samat kauppiasominaisuudet.</span><span class="sxs-lookup"><span data-stu-id="9e455-174">Therefore, a payment connector that has the same merchant properties must be available for capture.</span></span> 
- <span data-ttu-id="9e455-175">**Korttityypit:** Jotta Omni-Channel-skenaariot toimivat oikein, kullakin kanavalla on oltava samat maksuvälinetyyppien määritykset, joita voidaan käyttää Omni-kanavalla.</span><span class="sxs-lookup"><span data-stu-id="9e455-175">**Card types:** For omni-channel scenarios to work properly, each channel must have the same setup for tender types that can be used for omni-channel.</span></span> <span data-ttu-id="9e455-176">Tämä asetus sisältää maksutapatunnukset ja korttityypin tunnukset.</span><span class="sxs-lookup"><span data-stu-id="9e455-176">This setup includes payment method IDs and card type IDs.</span></span> <span data-ttu-id="9e455-177">Jos esimerkiksi **Kortti**-maksuvälinetyypin tunnus on **2** Internet-kaupan määrityksissä, sen tunnuksen tulee olla sama kuin vähittäiskaupan määrityksissä.</span><span class="sxs-lookup"><span data-stu-id="9e455-177">For example, if the **Cards** tender type has an ID of **2** in the online store setup, it should have the same ID in the retail store setup.</span></span> <span data-ttu-id="9e455-178">Sama vaatimus koskee korttien tyyppitunnuksia.</span><span class="sxs-lookup"><span data-stu-id="9e455-178">The same requirement applies to card type IDs.</span></span> <span data-ttu-id="9e455-179">Jos kortin numero **12** arvoksi on asetettu verkkokaupassa **VISA**, sama tunnus on määritettävä vähittäismyymälälle.</span><span class="sxs-lookup"><span data-stu-id="9e455-179">If card number **12** is set to **VISA** in the online store, the same ID should be set up for the retail store.</span></span> 
- <span data-ttu-id="9e455-180">Retail Modern POS for Windows tai Android ja sisäänrakennettu laiteasema tai</span><span class="sxs-lookup"><span data-stu-id="9e455-180">The Retail Modern POS for Windows or Android with built-in hardware station   -or-</span></span>
- <span data-ttu-id="9e455-181">Modern POS for iOS tai Cloud POS ja yhdistetty, jaettu laiteasema.</span><span class="sxs-lookup"><span data-stu-id="9e455-181">Modern POS for iOS or Cloud POS with connected shared hardware station.</span></span> 

### <a name="basic-principle-supporting-omni-channel-payments"></a><span data-ttu-id="9e455-182">Omni-Channel-maksuja tukeva perusperiaate</span><span class="sxs-lookup"><span data-stu-id="9e455-182">Basic principle supporting omni-channel payments</span></span>

<span data-ttu-id="9e455-183">Maksuyhdistimet ja maksuprosessorit käyttävät tunnuksia tai viittauksia korttimaksuihin liittyviin tapahtumiin.</span><span class="sxs-lookup"><span data-stu-id="9e455-183">Payment connectors and payment processors use tokens, or references, to reference interactions that are related to card payments.</span></span> <span data-ttu-id="9e455-184">Jos esimerkiksi haetaan maksuun liittyvää valtuutusta, annetaan viittaus kyseiseen valtuutuksen.</span><span class="sxs-lookup"><span data-stu-id="9e455-184">For example, when a payment authorization is requested, a reference to that authorization is provided.</span></span> <span data-ttu-id="9e455-185">Siksi valtuutukseen voidaan viitata myöhemmin, kun varat on siepattu toteutuman aikaan.</span><span class="sxs-lookup"><span data-stu-id="9e455-185">Therefore, the authorization can be referenced later, when funds are captured at the time of fulfillment.</span></span> <span data-ttu-id="9e455-186">Tämä valtuutus on yksilöllinen, kun kyseessä on kauppias, maksun yhdistin ja suoritin.</span><span class="sxs-lookup"><span data-stu-id="9e455-186">This authorization is unique to the merchant, payment connector, and processor.</span></span> 

<span data-ttu-id="9e455-187">Jos online-tilassa luotu tilaus noudetaan kaupasta, saman tilauksen toimitustiedot on muistettava ja niitä on käytettävä.</span><span class="sxs-lookup"><span data-stu-id="9e455-187">If an order that was created online is being picked up in the store, the same payment details for that order must be recalled and used.</span></span> <span data-ttu-id="9e455-188">Kun alkuperäiset tiedot toimitetaan osana pyyntöä, jonka mukaan maksu siepataan alkuperäistä valtuutusta vastaan, maksun käsittelijä voi käsitellä pyynnön ja siepata maksun.</span><span class="sxs-lookup"><span data-stu-id="9e455-188">When the original details are provided as part of the request to capture a payment against the original authorization, the payment processor will be able to handle the request and capture the payment.</span></span> 

<span data-ttu-id="9e455-189">Jotta voisit viitata online-tilaukseen oikein, myös samaa suoritinta tukevan kortti ei ole läsnä -maksuyhdistimen on oltava käytettävissä.</span><span class="sxs-lookup"><span data-stu-id="9e455-189">To correctly reference the online order, a "card not present" payment connector that supports the same processor must also be available.</span></span> <span data-ttu-id="9e455-190">Näin myyntipistejärjestelmällä voi olla yksi suoritin Kortti paikalla -maksuja varten, mutta se voi myös käyttää muita maksuyhdistimiä, jotta se voi täyttää muissa kanavissa luodut tilaukset eri maksukäsittelijöiden avulla.</span><span class="sxs-lookup"><span data-stu-id="9e455-190">In this way, the POS system can have one processor for "card present" payments, but it can also have access to other payment connectors so that it can fulfill orders that are created in other channels by using different payment processors.</span></span> 

## <a name="supported-scenarios"></a><span data-ttu-id="9e455-191">Tuetut skenaariot</span><span class="sxs-lookup"><span data-stu-id="9e455-191">Supported scenarios</span></span>

<span data-ttu-id="9e455-192">Seuraavia Omni-Channel-tukiskenaarioita tuetaan:</span><span class="sxs-lookup"><span data-stu-id="9e455-192">The following omni-channel payment scenarios are supported:</span></span>

- <span data-ttu-id="9e455-193">Tee ostoksia verkossa, nouda myymälästä</span><span class="sxs-lookup"><span data-stu-id="9e455-193">Buy online, pick up in store</span></span>
- <span data-ttu-id="9e455-194">Osta puhelinkeskuksesta, nouda myymälästä</span><span class="sxs-lookup"><span data-stu-id="9e455-194">Buy in call center, pick up in store</span></span>
- <span data-ttu-id="9e455-195">Osta myymälästä A, nouda myymälästä B</span><span class="sxs-lookup"><span data-stu-id="9e455-195">Buy in store A, pick up in store B</span></span>
- <span data-ttu-id="9e455-196">Osta myymälästä A, toimita asiakkaalle</span><span class="sxs-lookup"><span data-stu-id="9e455-196">Buy in store A, ship to customer</span></span>

    > [!NOTE]
    > <span data-ttu-id="9e455-197">Puhelinkeskuksessa suoritetut maksut, jotka yhdistyvät Normaali-maksutoimintoon, on merkittävä muotoon **Ennakkomaksu** = **Kyllä**, jotta ne otetaan huomioon veloitettavassa summassa, kun tilaus kumotaan myyntipisteessä.</span><span class="sxs-lookup"><span data-stu-id="9e455-197">Payments made in the call center that map to the "Normal" payment function must be marked as **Prepay** = **Yes** to be reflected in the amount due when recalling the order in the POS.</span></span> <span data-ttu-id="9e455-198">Normaali-tyypin muita kuin ennakkomaksuja ei tunnisteta, kun tilaus kumotaan myyntipisteessä.</span><span class="sxs-lookup"><span data-stu-id="9e455-198">Non-prepay payments of type "Normal" are not recognized when the order is recalled in POS.</span></span> 

<span data-ttu-id="9e455-199">Näiden skenaarioiden muunnelmia tuetaan myös.</span><span class="sxs-lookup"><span data-stu-id="9e455-199">Variations of these scenarios are also supported.</span></span> <span data-ttu-id="9e455-200">Esimerkiksi online-tilauksessa voi olla sekä rivejä, jotka lähetetään asiakkaalle, että rivejä, jotka noudetaan myymälästä.</span><span class="sxs-lookup"><span data-stu-id="9e455-200">For example, an online order might include both lines that will be shipped to the customer and lines that will be picked up in a store.</span></span> <span data-ttu-id="9e455-201">Kaikkia tilauksen toteutusvaihtoehtoja tuetaan Omni-Channel-maksuissa.</span><span class="sxs-lookup"><span data-stu-id="9e455-201">All order fulfillment options are supported via omni-channel payments.</span></span> 

<span data-ttu-id="9e455-202">Seuraavissa osissa kuvataan kunkin skenaarion vaiheet ja näytetään, miten skenaario suoritetaan demotietojen avulla.</span><span class="sxs-lookup"><span data-stu-id="9e455-202">The following sections describe the steps for each scenario and show how to run the scenario by using demo data.</span></span> 

### <a name="buy-online-pick-up-in-store"></a><span data-ttu-id="9e455-203">Tee ostoksia verkossa, nouda myymälästä</span><span class="sxs-lookup"><span data-stu-id="9e455-203">Buy online, pick up in store</span></span>

<span data-ttu-id="9e455-204">Varmista ennen alkamista, että seuraavat edellytykset ovat olemassa:</span><span class="sxs-lookup"><span data-stu-id="9e455-204">Before you start, make sure that the following prerequisites are in place:</span></span>

- <span data-ttu-id="9e455-205">Sinulla on viitemyymälä, jossa Adyen-yhdistin on määritetty.</span><span class="sxs-lookup"><span data-stu-id="9e455-205">You have a reference storefront where the Adyen connector is configured.</span></span>
- <span data-ttu-id="9e455-206">**Commercen jaetut parametrit** -sivun **Omni-Channel-maksun** vaihtoehdoksi on asetettu **Tosi**.</span><span class="sxs-lookup"><span data-stu-id="9e455-206">The **Omni-channel payments** option on the **Commerce shared parameters** page is set to **True**.</span></span> <span data-ttu-id="9e455-207">Myöhemmissä versioissa tämä asetus siirretään **Ominaisuuksien hallinta** -työtilaan. Siellä voit valita **Monikanavan maksut** -toiminnon ja valita **Ota käyttöön nyt**.</span><span class="sxs-lookup"><span data-stu-id="9e455-207">In later versions this settng is moved to the **Feature Management** workspace where you can select the **Omni-channel payments** feature and click **Enable now**.</span></span> 
- <span data-ttu-id="9e455-208">Adyen-maksuyhdistin on määritetty Houston POS -rekisteriin.</span><span class="sxs-lookup"><span data-stu-id="9e455-208">The Adyen payment connector is configured for the Houston POS register.</span></span>
- <span data-ttu-id="9e455-209">Retail Modern POS for Windows tai Android ja sisäänrakennettu laiteasema tai</span><span class="sxs-lookup"><span data-stu-id="9e455-209">The Retail Modern POS for Windows or Android with built-in hardware station   -or-</span></span>
- <span data-ttu-id="9e455-210">Modern POS for iOS tai Cloud POS ja yhdistetty, jaettu laiteasema.</span><span class="sxs-lookup"><span data-stu-id="9e455-210">Modern POS for iOS or Cloud POS with connected shared hardware station.</span></span> 

<span data-ttu-id="9e455-211">Noudata seuraavia vaiheita, jos haluat suorittaa skenaarion:</span><span class="sxs-lookup"><span data-stu-id="9e455-211">Follow these steps to run the scenario.</span></span>

1. <span data-ttu-id="9e455-212">Luo viitemyymälään noutotilaus.</span><span class="sxs-lookup"><span data-stu-id="9e455-212">In the reference storefront, create an order for in-store pickup.</span></span> <span data-ttu-id="9e455-213">Muista valita **Houston**-myymälä.</span><span class="sxs-lookup"><span data-stu-id="9e455-213">Be sure to select the **Houston** store.</span></span> 
2. <span data-ttu-id="9e455-214">Käy läpi kassaan liittyvät vaiheet ja maksa käyttämällä testiluottokortin numeroa.</span><span class="sxs-lookup"><span data-stu-id="9e455-214">Go through the checkout steps, and pay by using a test credit card number.</span></span> <span data-ttu-id="9e455-215">Voit etsiä testiluottokorttien numeroita [Adyen-testikorttien numerot -sivulta](https://docs.adyen.com/development-resources/test-cards/test-card-numbers/#description).</span><span class="sxs-lookup"><span data-stu-id="9e455-215">You can find test credit card numbers on the [Adyen test card numbers page](https://docs.adyen.com/development-resources/test-cards/test-card-numbers/#description).</span></span>
3. <span data-ttu-id="9e455-216">Commerce-ohjelmassa voit luoda **Synkronoi tilaukset** -eräajon taustajärjestelmässä **P-001**-jakeluaikataulun avulla.</span><span class="sxs-lookup"><span data-stu-id="9e455-216">In Commerce, use the **Synchronize orders** batch job and the **P-001** distribution schedule to create the orders in the back office.</span></span>
4. <span data-ttu-id="9e455-217">Valitse myyntipisteen aloitussivulla **Noudettavat tilaukset** -toiminto, jotta voit tarkastella myymälän noudettavia tilauksia.</span><span class="sxs-lookup"><span data-stu-id="9e455-217">In the POS, on the welcome page, select the **Orders to pickup** operation to see the orders for in-store pickup.</span></span> 
5. <span data-ttu-id="9e455-218">Valitse yksi tai useita rivejä viitteenä luodusta tilauksesta ja valitse **Nouda**.</span><span class="sxs-lookup"><span data-stu-id="9e455-218">Select one or more lines from the order that was created in the reference storefront, and then select **Pick up**.</span></span>

    <span data-ttu-id="9e455-219">Tilaus haetaan taustajärjestelmästä.</span><span class="sxs-lookup"><span data-stu-id="9e455-219">The order is retrieved from the back office.</span></span> 

6. <span data-ttu-id="9e455-220">Kun tilausrivin tiedot haetaan taustajärjestelmästä ja järjestelmä havaitsee korttimaksun, jota voidaan käyttää Omni-kanavalla, sinulle ilmoitetaan, että maksutapa on käytettävissä.</span><span class="sxs-lookup"><span data-stu-id="9e455-220">When the order line details are retrieved from the back office, and a card payment that can be used for omni-channel is detected, you're informed that a payment method is available.</span></span>
7. <span data-ttu-id="9e455-221">Valitse **Käytä käytettävissä olevaa maksutapaa**, kun haluat suorittaa tapahtuman käyttämällä viitteenä myymälän korttitietoja.</span><span class="sxs-lookup"><span data-stu-id="9e455-221">Select **Use available payment method** to complete the transaction by using the card details that were entered in the reference storefront.</span></span>

    <span data-ttu-id="9e455-222">Tilausrivit ladataan tapahtumasivulle, ja erääntyvä saldo on 0 (nolla).</span><span class="sxs-lookup"><span data-stu-id="9e455-222">The order lines are loaded on the transaction page, and the balance due is 0 (zero).</span></span> 

8. <span data-ttu-id="9e455-223">Valitse **Maksut**-välilehti ja tarkastele online-tilauksesta vedettynä maksuvälineriviä.</span><span class="sxs-lookup"><span data-stu-id="9e455-223">Select the **Payments** tab to view the tender line that was pulled from the online order.</span></span> 
9. <span data-ttu-id="9e455-224">Valitse mikä tahansa maksutapa tapahtuman suorittamista varten.</span><span class="sxs-lookup"><span data-stu-id="9e455-224">Select any payment method to complete the transaction.</span></span> 

### <a name="buy-in-call-center-pick-up-in-store"></a><span data-ttu-id="9e455-225">Osta puhelinkeskuksesta, nouda myymälästä</span><span class="sxs-lookup"><span data-stu-id="9e455-225">Buy in call center, pick up in store</span></span>

1. <span data-ttu-id="9e455-226">Kirjoita Commercessa **Asiakaspalvelu**-sivun hakupalkkiin **Karen Berg** ja valitse sitten **Hae**.</span><span class="sxs-lookup"><span data-stu-id="9e455-226">In Commerce, on the **Customer service** page, enter **Karen Berg** in the search bar, and then select **Search**.</span></span> 
3. <span data-ttu-id="9e455-227">Valitse hakutuloksista **Karen Berg**.</span><span class="sxs-lookup"><span data-stu-id="9e455-227">Select **Karen Berg** in the search results.</span></span>
4. <span data-ttu-id="9e455-228">Kun Karen on ladattu **Asiakaspalvelu**-sivulle, valitse **Uusi myyntitilaus**.</span><span class="sxs-lookup"><span data-stu-id="9e455-228">After Karen is loaded onto the **Customer service** page, select **New sales order**.</span></span>
5. <span data-ttu-id="9e455-229">Voit tarkastella tilauksen otsikkoa valitsemalla **Otsikko** uudella myyntitilaussivulla.</span><span class="sxs-lookup"><span data-stu-id="9e455-229">On the new sales order page, select **Header** to view the order header.</span></span> 
6. <span data-ttu-id="9e455-230">Määritä **Tilauksen otsikko** -sivulla toimipaikaksi **Keski** ja varastoksi **Houston**.</span><span class="sxs-lookup"><span data-stu-id="9e455-230">On the **Order header** page, set the site to **Central** and the warehouse to **Houston**.</span></span>
7. <span data-ttu-id="9e455-231">Määritä **Toimitus**-välilehdellä **Toimitustapa**-kentän arvoksi **60** asiakkaan noutoa varten.</span><span class="sxs-lookup"><span data-stu-id="9e455-231">On the **Deliver** tab, set the **Mode of delivery** field to **60** for customer pickup.</span></span>
8. <span data-ttu-id="9e455-232">Valitse **Rivit** ja lisää tilaukseen vähintään yksi rivi.</span><span class="sxs-lookup"><span data-stu-id="9e455-232">Select **Lines**, and then add one or more lines to the order.</span></span> 
9. <span data-ttu-id="9e455-233">Määritä tilauksen valmistumisvirta valitsemalla **Valmis**.</span><span class="sxs-lookup"><span data-stu-id="9e455-233">Select **Complete** to enter the order completion flow.</span></span>
10. <span data-ttu-id="9e455-234">Vieritä alas maksut-osaan, valitse **Lisää** ja valitse sitten rivi, jolla maksutapatyypiksi on määritetty **Kortit**.</span><span class="sxs-lookup"><span data-stu-id="9e455-234">Scroll down to the payments section, select **Add**, and then select a line where the payment method type is set to **Cards**.</span></span> 
11. <span data-ttu-id="9e455-235">Lisää korttimaksu valitsemalla plusmerkki (**+**).</span><span class="sxs-lookup"><span data-stu-id="9e455-235">Select the plus sign (**+**) to add a card payment.</span></span> 
12. <span data-ttu-id="9e455-236">Kirjoita [Adyen-testikorttien numerot -sivulta](https://docs.adyen.com/development-resources/test-cards/test-card-numbers/#description)löytyneen testiluottokortin numeron tiedot ja valitse sitten **OK**.</span><span class="sxs-lookup"><span data-stu-id="9e455-236">Enter the details for a test credit card number that you found on the [Adyen test card numbers page](https://docs.adyen.com/development-resources/test-cards/test-card-numbers/#description), and then select **OK**.</span></span>

    > [!NOTE]
    > <span data-ttu-id="9e455-237">Jos syöttämäsi kortin numero eroaa tuotemerkistä, joka valittiin maksun aloittamisen yhteydessä, maksu menee silti läpi.</span><span class="sxs-lookup"><span data-stu-id="9e455-237">If the card brand for the card number that you entered differs from the brand that was selected when the payment was initiated, the payment will still go through.</span></span> <span data-ttu-id="9e455-238">Se kirjataan kuitenkin tileille, jotka on liitetty vaiheessa 10 valitsemaasi korttimerkkiin.</span><span class="sxs-lookup"><span data-stu-id="9e455-238">However, it will be posted to the accounts that are mapped to the card brand that you selected in step 10.</span></span>

12. <span data-ttu-id="9e455-239">Valitse uudelleen **OK** sulkeaksesi **Tilauksen loppuunmaksu** -valintaikkunan.</span><span class="sxs-lookup"><span data-stu-id="9e455-239">Select **OK** again to close the **Order completion payments** dialog box.</span></span>
13. <span data-ttu-id="9e455-240">Valitse **Myyntitilauksen yhteenveto** -sivulla **Lähetä**.</span><span class="sxs-lookup"><span data-stu-id="9e455-240">On the **Sales order summary** page, select **Submit**.</span></span>
14. <span data-ttu-id="9e455-241">Valitse myyntipisteen aloitussivulla **Noudettavat tilaukset** -toiminto, jotta voit tarkastella myymälän noudettavia tilauksia.</span><span class="sxs-lookup"><span data-stu-id="9e455-241">In the POS, on the welcome page, select the **Orders to pickup** operation to see the orders for in-store pickup.</span></span> 
15. <span data-ttu-id="9e455-242">Valitse yksi tai useita rivejä viitteenä luodusta tilauksesta ja valitse **Nouda**.</span><span class="sxs-lookup"><span data-stu-id="9e455-242">Select one or more lines from the order that was created in the reference storefront, and then select **Pick up**.</span></span>

    <span data-ttu-id="9e455-243">Tilaus haetaan taustajärjestelmästä.</span><span class="sxs-lookup"><span data-stu-id="9e455-243">The order is retrieved from the back office.</span></span> 

16. <span data-ttu-id="9e455-244">Kun tilausrivin tiedot haetaan taustajärjestelmästä ja järjestelmä havaitsee korttimaksun, jota voidaan käyttää Omni-kanavalla, sinulle ilmoitetaan, että maksutapa on käytettävissä.</span><span class="sxs-lookup"><span data-stu-id="9e455-244">When the order line details are retrieved from the back office, and a card payment that can be used for omni-channel is detected, you're informed that a payment method is available.</span></span>
17. <span data-ttu-id="9e455-245">Valitse **Käytä käytettävissä olevaa maksutapaa**, kun haluat suorittaa tapahtuman käyttämällä viitteenä myymälän korttitietoja.</span><span class="sxs-lookup"><span data-stu-id="9e455-245">Select **Use available payment method** to complete the transaction by using the card details that were entered in the reference storefront.</span></span>

    <span data-ttu-id="9e455-246">Tilausrivit ladataan tapahtumasivulle, ja erääntyvä saldo on 0 (nolla).</span><span class="sxs-lookup"><span data-stu-id="9e455-246">The order lines are loaded on the transaction page, and the balance due is 0 (zero).</span></span>

18. <span data-ttu-id="9e455-247">Valitse **Maksut**-välilehti ja tarkastele online-tilauksesta vedettynä maksuvälineriviä.</span><span class="sxs-lookup"><span data-stu-id="9e455-247">Select the **Payments** tab to view the tender line that was pulled from the online order.</span></span> 
19. <span data-ttu-id="9e455-248">Valitse mikä tahansa maksutapa tapahtuman suorittamista varten.</span><span class="sxs-lookup"><span data-stu-id="9e455-248">Select any payment method to complete the transaction.</span></span> 

### <a name="buy-in-store-a-pick-up-in-store-b"></a><span data-ttu-id="9e455-249">Osta myymälästä A, nouda myymälästä B</span><span class="sxs-lookup"><span data-stu-id="9e455-249">Buy in store A, pick up in store B</span></span>

1. <span data-ttu-id="9e455-250">Aloita myyntipiste Houston Storessa.</span><span class="sxs-lookup"><span data-stu-id="9e455-250">Start the POS for the Houston store.</span></span>
2. <span data-ttu-id="9e455-251">Lisää **Tapahtuma**-sivulla Karen Berg tapahtumaan ja kirjoita **2001** käyttämällä numeronäppäimistöä.</span><span class="sxs-lookup"><span data-stu-id="9e455-251">On the **Transaction** page, add Karen Berg to the transaction by using the number pad to enter **2001**.</span></span>
3. <span data-ttu-id="9e455-252">Lisää tapahtumaan vähintään yksi rivi.</span><span class="sxs-lookup"><span data-stu-id="9e455-252">Add one or more lines to the transaction.</span></span>
4. <span data-ttu-id="9e455-253">Valitse **Tilaukset**, jos haluat nähdä tilausvaihtoehdot.</span><span class="sxs-lookup"><span data-stu-id="9e455-253">Select **Orders** to see the order options.</span></span>
5. <span data-ttu-id="9e455-254">Valitse **Nouda kaikki** ja valitse sitten pyydettäessä **Asiakastilaus**.</span><span class="sxs-lookup"><span data-stu-id="9e455-254">Select **Pick up all**, and then, when you're prompted, select **Customer order**.</span></span>
6. <span data-ttu-id="9e455-255">Kirjoita hakupalkkiin **Seattle** ja valitse sitten noutopaikaksi **Seattle**-myymälä.</span><span class="sxs-lookup"><span data-stu-id="9e455-255">In the search bar, enter **Seattle**, and then select the **Seattle** store for pickup.</span></span> 
7. <span data-ttu-id="9e455-256">Valitse **OK**, jos haluat hyväksyä kuluvan päivän noutopäiväksi.</span><span class="sxs-lookup"><span data-stu-id="9e455-256">Select **OK** to accept the current date as the date of pickup.</span></span>
9. <span data-ttu-id="9e455-257">Valitse **Maksa kortilla** jos haluat aloittaa maksun.</span><span class="sxs-lookup"><span data-stu-id="9e455-257">Select **Pay card** to initiate the payment.</span></span>
10. <span data-ttu-id="9e455-258">Tarjoa korttimaksu määrästä, joka on maksettava talletuksesta.</span><span class="sxs-lookup"><span data-stu-id="9e455-258">Tender the card payment for the amount that is due for the deposit.</span></span> 
11. <span data-ttu-id="9e455-259">Suorita talletusmaksu maksupäätteessä.</span><span class="sxs-lookup"><span data-stu-id="9e455-259">Complete the deposit payment on the payment terminal.</span></span> 
12. <span data-ttu-id="9e455-260">Kun talletus on maksettu, valitse mahdollisuus käyttää samaa korttia toteumaa varten ja odota, kunnes tilaus on tehty.</span><span class="sxs-lookup"><span data-stu-id="9e455-260">After the deposit is paid, select the option to use the same card for fulfillment, and wait for the order to be completed.</span></span> 
13. <span data-ttu-id="9e455-261">Aloita myyntipiste Seattle Storessa.</span><span class="sxs-lookup"><span data-stu-id="9e455-261">Start the POS for the Seattle store.</span></span>
14. <span data-ttu-id="9e455-262">Valitse myyntipisteen aloitussivulla **Noudettavat tilaukset** -toiminto, jotta voit tarkastella myymälän noudettavia tilauksia.</span><span class="sxs-lookup"><span data-stu-id="9e455-262">In the POS, on the welcome page, select the **Orders to pickup** operation to see the orders for in-store pickup.</span></span> 
15. <span data-ttu-id="9e455-263">Valitse yksi tai useita rivejä viitteenä luodusta tilauksesta ja valitse **Nouda**.</span><span class="sxs-lookup"><span data-stu-id="9e455-263">Select one or more lines from the order that was created in the reference storefront, and then select **Pick up**.</span></span>

    <span data-ttu-id="9e455-264">Tilaus haetaan taustajärjestelmästä.</span><span class="sxs-lookup"><span data-stu-id="9e455-264">The order is retrieved from the back office.</span></span> 

16. <span data-ttu-id="9e455-265">Kun tilausrivin tiedot haetaan taustajärjestelmästä ja järjestelmä havaitsee korttimaksun, jota voidaan käyttää Omni-kanavalla, sinulle ilmoitetaan, että maksutapa on käytettävissä.</span><span class="sxs-lookup"><span data-stu-id="9e455-265">When the order line details are retrieved from the back office, and a card payment that can be used for omni-channel is detected, you're informed that a payment method is available.</span></span>
17. <span data-ttu-id="9e455-266">Valitse **Käytä käytettävissä olevaa maksutapaa**, kun haluat suorittaa tapahtuman käyttämällä viitteenä myymälän korttitietoja.</span><span class="sxs-lookup"><span data-stu-id="9e455-266">Select **Use available payment method** to complete the transaction by using the card details that were entered in the reference storefront.</span></span>

    <span data-ttu-id="9e455-267">Tilausrivit ladataan tapahtumasivulle, ja erääntyvä saldo on 0 (nolla).</span><span class="sxs-lookup"><span data-stu-id="9e455-267">The order lines are loaded on the transaction page, and the balance due is 0 (zero).</span></span>

18. <span data-ttu-id="9e455-268">Valitse **Maksut**-välilehti ja tarkastele online-tilauksesta vedettynä maksuvälineriviä.</span><span class="sxs-lookup"><span data-stu-id="9e455-268">Select the **Payments** tab to view the tender line that was pulled from the online order.</span></span> 
19. <span data-ttu-id="9e455-269">Valitse mikä tahansa maksutapa tapahtuman suorittamista varten.</span><span class="sxs-lookup"><span data-stu-id="9e455-269">Select any payment method to complete the transaction.</span></span> 

### <a name="buy-in-store-a-ship-to-customer"></a><span data-ttu-id="9e455-270">Osta myymälästä A, toimita asiakkaalle</span><span class="sxs-lookup"><span data-stu-id="9e455-270">Buy in store A, ship to customer</span></span>

1. <span data-ttu-id="9e455-271">Aloita myyntipiste Houston Storessa.</span><span class="sxs-lookup"><span data-stu-id="9e455-271">Start the POS for the Houston store.</span></span>
2. <span data-ttu-id="9e455-272">Lisää **Tapahtuma**-sivulla Karen Berg tapahtumaan ja kirjoita **2001** käyttämällä numeronäppäimistöä.</span><span class="sxs-lookup"><span data-stu-id="9e455-272">On the **Transaction** page, add Karen Berg to the transaction by using the number pad to enter **2001**.</span></span>
3. <span data-ttu-id="9e455-273">Lisää tapahtumaan vähintään yksi rivi.</span><span class="sxs-lookup"><span data-stu-id="9e455-273">Add one or more lines to the transaction.</span></span>
4. <span data-ttu-id="9e455-274">Valitse **Tilaukset**, jos haluat nähdä tilausvaihtoehdot.</span><span class="sxs-lookup"><span data-stu-id="9e455-274">Select **Orders** to see the order options.</span></span>
5. <span data-ttu-id="9e455-275">Valitse **Lähetä kaikki** ja valitse sitten pyydettäessä **Asiakastilaus**.</span><span class="sxs-lookup"><span data-stu-id="9e455-275">Select **Ship all**, and then, when you're prompted, select **Customer order**.</span></span>
6. <span data-ttu-id="9e455-276">Valitse lähetystapasivulla **Vakio yön yli** ja hyväksy sitten kuluva päivämäärä lähetyspäiväksi valitsemalla **OK**.</span><span class="sxs-lookup"><span data-stu-id="9e455-276">In the shipping method page, select **Standard overnight**, and then select **OK** to accept today's date as the shipping date.</span></span> 
7. <span data-ttu-id="9e455-277">Valitse **OK**, jos haluat hyväksyä kuluvan päivän noutopäiväksi.</span><span class="sxs-lookup"><span data-stu-id="9e455-277">Select **OK** to accept the current date as the date of pickup.</span></span>
8. <span data-ttu-id="9e455-278">Valitse **Maksa kortilla** jos haluat aloittaa maksun.</span><span class="sxs-lookup"><span data-stu-id="9e455-278">Select **Pay card** to initiate the payment.</span></span>
9. <span data-ttu-id="9e455-279">Tarjoa korttimaksu määrästä, joka on maksettava talletuksesta.</span><span class="sxs-lookup"><span data-stu-id="9e455-279">Tender the card payment for the amount that is due for the deposit.</span></span> 
10. <span data-ttu-id="9e455-280">Suorita talletusmaksu maksupäätteessä.</span><span class="sxs-lookup"><span data-stu-id="9e455-280">Complete the deposit payment on the payment terminal.</span></span> 
11. <span data-ttu-id="9e455-281">Kun talletus on maksettu, valitse mahdollisuus käyttää samaa korttia toteumaa varten ja odota, kunnes tilaus on tehty.</span><span class="sxs-lookup"><span data-stu-id="9e455-281">After the deposit is paid, select the option to use the same card for fulfillment, and wait for the order to be completed.</span></span>

<span data-ttu-id="9e455-282">Kun tilaus kerätään, pakataan ja laskutetaan taustajärjestelmässä, myyntipisteessä olevia maksutietoja käytetään, kun ne keräävät asiakkaalle toimitettavien tuotteiden varat.</span><span class="sxs-lookup"><span data-stu-id="9e455-282">When the order is picked, packed, and invoiced in the back office, the payment details that are provided at the POS will be used to capture the funds for the goods that are being shipped to the customer.</span></span> 

## <a name="scenario-details"></a><span data-ttu-id="9e455-283">Skenaarion tiedot</span><span class="sxs-lookup"><span data-stu-id="9e455-283">Scenario details</span></span>

<span data-ttu-id="9e455-284">Juuri kuvattujen perusskenaarioiden lisäksi maksujen SDK:hon on tehty useita lisäparannuksia, jotka tukevat Omni-Channel-maksuja.</span><span class="sxs-lookup"><span data-stu-id="9e455-284">In addition to the basic scenarios that were just described, several enhancements have been made to the Payments SDK to support omni-channel payments.</span></span> 

### <a name="pos"></a><span data-ttu-id="9e455-285">Myyntipiste</span><span class="sxs-lookup"><span data-stu-id="9e455-285">POS</span></span>

#### <a name="single-swipedip-for-customer-orders"></a><span data-ttu-id="9e455-286">Yksi pyyhkäisy/lukeminen asiakkaan tilauksille</span><span class="sxs-lookup"><span data-stu-id="9e455-286">Single swipe/dip for customer orders</span></span>

<span data-ttu-id="9e455-287">Ennen kuin Omni-Channel-maksutoiminto otettiin käyttöön, asiakastilaukset, jotka sisälsivät talletuksia, luotiin myyntipistesovelluksessa. Asiakkaiden oli pyyhkäistävä (tai luettava) korttinsa päätteessä kaksi kertaa: kerran maksaakseen talletuksen ja yhden kerran, jotta kortti voidaan määrittää myöhemmin tilauksen toteuttamiseksi.</span><span class="sxs-lookup"><span data-stu-id="9e455-287">Before the omni-channel payments feature was implemented, when customer orders that included deposits were created at the POS, customers were required to swipe (or dip) their card two times: one time to pay the deposit and one time to tokenize the card for subsequent order fulfillment.</span></span> <span data-ttu-id="9e455-288">Kun Omni-Channelin tunnusten määrittämisominaisuus on käytössä, asiakkaiden on pyyhkäistä korttinsa vain kerran, jotta molemmat maksavat talletuksen, ja sallivat myöhemmin erääntyvien tuotteiden summan.</span><span class="sxs-lookup"><span data-stu-id="9e455-288">When the omni-channel tokenization feature is turned on, customers must swipe their card only one time to both pay the deposit and authorize the amount that is due for goods that will be fulfilled later.</span></span> <span data-ttu-id="9e455-289">Toteutuksen hetkellä hyväksytyt varat otetaan talteen.</span><span class="sxs-lookup"><span data-stu-id="9e455-289">At the time of fulfillment, the authorized funds are captured.</span></span> <span data-ttu-id="9e455-290">Ennen kuin Omni-Channel tunnusten määritysominaisuus on toteutettu, vain toistuvan kortin tunnussanoma on luotu seuraavaa tilausten täyttämistä varten.</span><span class="sxs-lookup"><span data-stu-id="9e455-290">Before the omni-channel tokenization feature was implemented, only a recurring card token was created for subsequent order fulfillment.</span></span> <span data-ttu-id="9e455-291">Näin ollen vireillä olevan toteuman varoja ei hyväksytty, ja koska näitä varoja ei ole pidätetty kyseisen oston yhteydessä, on vähemmän todennäköistä, että ne voidaan siepata myöhemmin.</span><span class="sxs-lookup"><span data-stu-id="9e455-291">Therefore, the funds for the pending fulfillment weren't authorized, and because those funds weren't being held for that specific purchase, it was less likely that they could be captured later.</span></span>

> [!NOTE]
> <span data-ttu-id="9e455-292">Yksittäinen pyyhkäisy ei ole tuettu Retail-versiossa 8.1.3.</span><span class="sxs-lookup"><span data-stu-id="9e455-292">Single swipe isn't supported in Retail version 8.1.3.</span></span> <span data-ttu-id="9e455-293">Asiakkaan tilaukset versiossa 8.1.3 käyttävät samaa virtausta, jota käytettiin, ennen kuin Omni-Channel-tunnusten määritysominaisuus toteutettiin.</span><span class="sxs-lookup"><span data-stu-id="9e455-293">Customer orders in version 8.1.3 use the same flow that was used before the omni-channel tokenization feature was implemented.</span></span> 

### <a name="cards-that-cant-issue-recurring-card-tokens"></a><span data-ttu-id="9e455-294">Kortit, jotka eivät voi antaa toistuvia korttitunnuksia</span><span class="sxs-lookup"><span data-stu-id="9e455-294">Cards that can't issue recurring card tokens</span></span>

<span data-ttu-id="9e455-295">Joitakin kortteja ei voi käyttää Omni-Channel-maksuissa, koska ne eivät tue toistuvaa korttitunnusten antamista.</span><span class="sxs-lookup"><span data-stu-id="9e455-295">Some cards can't be used for omni-channel payments, because they don't support issuing recurring card tokens.</span></span> <span data-ttu-id="9e455-296">Kun tilaus luodaan myyntipisteessä, jos talletus maksetaan kortilla, joka ei tue toistuvia kortti tunnuksia, käytetään aiempaa korttimerkintävirtatoimintoa.</span><span class="sxs-lookup"><span data-stu-id="9e455-296">When an order is created at the POS, if the deposit is paid by using a card that doesn't support recurring card tokens, the previous card tokenization flow is used.</span></span> <span data-ttu-id="9e455-297">Näin ollen asiakkaan, joka haluaa tarjota seuraavassa tilauksessa käytettävän suorituksen, on esitettävä toinen kortti.</span><span class="sxs-lookup"><span data-stu-id="9e455-297">Therefore, a customer who wants to provide a payment that will be used for subsequent order fulfillment must present a second card.</span></span> <span data-ttu-id="9e455-298">Jos toinen kortti ei tue toistuvia korttitunnuksia, korttimerkintätoiminto hylätään, ja kassanhoitaja pyytää asiakasta antamaan toisen kortin.</span><span class="sxs-lookup"><span data-stu-id="9e455-298">If the second card doesn't support recurring card tokens, the tokenization action will be declined, and the cashier will be prompted to ask the customer to provide a different card.</span></span> 

### <a name="using-a-different-card"></a><span data-ttu-id="9e455-299">Toisen kortin käyttäminen</span><span class="sxs-lookup"><span data-stu-id="9e455-299">Using a different card</span></span>

<span data-ttu-id="9e455-300">Tilauksen noutoa varten myymälässä olevalla asiakkaalla on mahdollisuus käyttää toista korttia.</span><span class="sxs-lookup"><span data-stu-id="9e455-300">A customer who comes to the store for order pickup has the option to use a different card.</span></span> <span data-ttu-id="9e455-301">Kun kassanhoitaja saa käyttöönsä **Käytettävissä olevan maksutavan** kehotteen tilauksen noutoa varten, hän voi kysyä, haluaako asiakas käyttää samaa korttia.</span><span class="sxs-lookup"><span data-stu-id="9e455-301">When the cashier receives the **Use available payment method** prompt at the time of order pickup, the cashier can ask whether the customer wants to use the same card.</span></span> <span data-ttu-id="9e455-302">Jos asiakas on kadottanut tilauksen luomisessa käytetyn kortin ja haluaa maksaa tilauksen toisen kortin avulla, kassanhoitaja voi valita **Käytä eri maksutapaa.**</span><span class="sxs-lookup"><span data-stu-id="9e455-302">If the customer has lost the card that was used to create the order and wants to pay for the order by using a different card, the cashier can select **Use a different payment method**.</span></span> <span data-ttu-id="9e455-303">Jos asiakas palaa myöhemmin hakemaan useampia nimikkeitä samalle tilaukselle ja alkuperäisen kortin valtuutus on edelleen voimassa, kassanhoitaja voi kysyä, haluaako asiakas käyttää kyseistä korttia.</span><span class="sxs-lookup"><span data-stu-id="9e455-303">If the customer comes back later to pick up more items for the same order, if the original card authorization is still valid, the cashier can again ask whether the customer wants to use that card.</span></span>

### <a name="invalid-authorizations"></a><span data-ttu-id="9e455-304">Virheelliset valtuutukset</span><span class="sxs-lookup"><span data-stu-id="9e455-304">Invalid authorizations</span></span>

<span data-ttu-id="9e455-305">Jos tilauksen luonnissa käytetty kortti ei ole enää voimassa, kun tuotteet valitaan noutoa varten, suorituksen sieppauspyyntö epäonnistuu.</span><span class="sxs-lookup"><span data-stu-id="9e455-305">If the card that was used to create an order is no longer valid, when products are selected for pickup, the payment capture request will fail.</span></span> <span data-ttu-id="9e455-306">Myyntipistemaksuyhteys yrittää luoda uuden valtuutuksen ja siepata käyttämällä samoja korttitietoja.</span><span class="sxs-lookup"><span data-stu-id="9e455-306">The POS payment connector will then try to create a new authorization and capture by using the same card details.</span></span> <span data-ttu-id="9e455-307">Jos uusi valtuutus tai sieppaus epäonnistuu, kassanhoitaja saa tiedon siitä, että maksuja ei voitu käsitellä.</span><span class="sxs-lookup"><span data-stu-id="9e455-307">If the new authorization or capture fails, the cashier will be informed that the payment could not be processed.</span></span> <span data-ttu-id="9e455-308">Kassan on tällöin saatava asiakkaalta uusi maksuerä.</span><span class="sxs-lookup"><span data-stu-id="9e455-308">The cashier must then get a new payment from the customer.</span></span> 

### <a name="multiple-available-payments"></a><span data-ttu-id="9e455-309">Useita käytettävissä olevia maksuja</span><span class="sxs-lookup"><span data-stu-id="9e455-309">Multiple available payments</span></span>

<span data-ttu-id="9e455-310">Kun tilaus, jolla on useita tarjouksia ja useita rivejä, on noudettavissa, kassanhoitaja saa ensin käyttöön **Käytettävissä olevan maksutavan** kehotteen.</span><span class="sxs-lookup"><span data-stu-id="9e455-310">When an order that has multiple tenders and multiple lines is picked up, the cashier first receives the **Use available payment method** prompt.</span></span> <span data-ttu-id="9e455-311">Jos on useita kortteja ja kassanhoitaja valitsee **Käytä käytettävissä olevaa maksutapaa**, olemassa olevat korttimaksuvälinerivit siepataan, kunnes saldo täyttyy parhaillaan kerättävissä tavaroissa.</span><span class="sxs-lookup"><span data-stu-id="9e455-311">If there are multiple cards, when the cashier selects **Use available payment method**, existing card tender lines will be captured until the balance is met for the goods that are currently being picked up.</span></span> <span data-ttu-id="9e455-312">Kassanhoitajilla ei ole mahdollisuutta valita korttia, jota käytetään noudettavissa tuotteissa.</span><span class="sxs-lookup"><span data-stu-id="9e455-312">The cashier won't have the option to select the card that should be used for the goods that are being picked up.</span></span> 

## <a name="related-topics"></a><span data-ttu-id="9e455-313">Liittyvät aiheet</span><span class="sxs-lookup"><span data-stu-id="9e455-313">Related topics</span></span>

- [<span data-ttu-id="9e455-314">Maksut – usein kysytyt kysymykset</span><span class="sxs-lookup"><span data-stu-id="9e455-314">Payments FAQ</span></span>](/dynamics365/unified-operations/retail/dev-itpro/payments-retail)
- [<span data-ttu-id="9e455-315">Dynamics 365 -maksuyhdistin Adyenia varten</span><span class="sxs-lookup"><span data-stu-id="9e455-315">Dynamics 365 Payment Connector for Adyen</span></span>](/dynamics365/unified-operations/retail/dev-itpro/adyen-connector?tabs=8-1-3)
- [<span data-ttu-id="9e455-316">BOPIS:n määritykset Dynamics 365 Commerce -arviointiympäristössä</span><span class="sxs-lookup"><span data-stu-id="9e455-316">Configure BOPIS in a Dynamics 365 Commerce evaluation environment</span></span>](./cpe-bopis.md)



[!INCLUDE[footer-include](../includes/footer-banner.md)]