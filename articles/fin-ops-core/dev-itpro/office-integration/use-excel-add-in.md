---
title: Yksikön tietojen näyttäminen ja päivittäminen Excelissä
description: Tässä aiheessa käsitellään yksikkötietojen avaamista Microsoft Excelissä sekä tietojen näyttämistä, päivittämistä ja muokkaamista Microsoft Dynamicsin Excel-apuohjelmalla.
author: jasongre
ms.date: 01/22/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Application User
ms.reviewer: sericks
ms.custom: 267914
ms.assetid: 4e6c7194-a059-4057-bd62-ec0c802c36fd
ms.search.region: Global
ms.author: jasongre
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: 05b5126b29351ca3093e75e878682f7a07186898
ms.sourcegitcommit: 074b6e212d19dd5d84881d1cdd096611a18c207f
ms.translationtype: HT
ms.contentlocale: fi-FI
ms.lasthandoff: 03/31/2021
ms.locfileid: "5752963"
---
# <a name="view-and-update-entity-data-with-excel"></a><span data-ttu-id="0ed13-103">Yksikön tietojen näyttäminen ja päivittäminen Excelissä</span><span class="sxs-lookup"><span data-stu-id="0ed13-103">View and update entity data with Excel</span></span> 

[!include [applies to](../includes/applies-to-commerce-finance-scm.md)]

[!include [banner](../includes/banner.md)]


<span data-ttu-id="0ed13-104">Tässä aiheessa käsitellään yksikkötietojen avaamista Microsoft Excelissä sekä tietojen näyttämistä, päivittämistä ja muokkaamista Microsoft Dynamicsin Excel-apuohjelmalla.</span><span class="sxs-lookup"><span data-stu-id="0ed13-104">This topic explains how to open entity data in Microsoft Excel, and then view, update, and edit the data by using the Microsoft Dynamics Excel add-in.</span></span> <span data-ttu-id="0ed13-105">Voit aloittaa yksikkötietojen avaamisen joko Excelissä tai Finance and Operations -sovelluksissa.</span><span class="sxs-lookup"><span data-stu-id="0ed13-105">To open entity data, you can start from either Excel or Finance and Operations apps.</span></span>

<span data-ttu-id="0ed13-106">Kun avaat yksikkötietoja Excelissä, voit tarkastella ja muokata nopeasti tietoja Excel-lisäosalla.</span><span class="sxs-lookup"><span data-stu-id="0ed13-106">By opening entity data in Excel, you can quickly and easily view and edit the data by using the Excel add-in.</span></span> <span data-ttu-id="0ed13-107">Apuohjelman käyttö edellyttää vähintään versiota Microsoft Excel 2016.</span><span class="sxs-lookup"><span data-stu-id="0ed13-107">This add-in requires Microsoft Excel 2016 or later.</span></span>

> [!NOTE]
> <span data-ttu-id="0ed13-108">Jos Microsoft Azure Active Directory (Azure AD) -vuokraaja on määritetty käyttämään Active Directory Federation Servicesiä (AD FS), varmista, että Officen toukokuun 2016 päivitys on asennettu, jotta Excel-lisäosa pystyy kirjaamaan sinut sisään.</span><span class="sxs-lookup"><span data-stu-id="0ed13-108">If your Microsoft Azure Active Directory (Azure AD) tenant is configured to use Active Directory Federation Services (AD FS), you must make sure that the May 2016 update for Office has been applied, so that the Excel add-in can correctly sign you in.</span></span>

<span data-ttu-id="0ed13-109">Lisätietoja Excel-apuohjelman käyttämisestä lyhyessä videossa [Excel-mallin luominen otsikolle ja rivimalleille](https://youtu.be/RTicLb-6dbI).</span><span class="sxs-lookup"><span data-stu-id="0ed13-109">To learn more about how to use the Excel add-in, watch the short [Create an Excel template for header and line patterns](https://youtu.be/RTicLb-6dbI) video.</span></span>

## <a name="open-entity-data-in-excel-when-you-start-from-a-finance-and-operations-app"></a><span data-ttu-id="0ed13-110">Yksikön tietojen avaaminen Excelissä Finance and Operations -sovelluksesta aloitettaessa</span><span class="sxs-lookup"><span data-stu-id="0ed13-110">Open entity data in Excel when you start from a Finance and Operations app</span></span>
1. <span data-ttu-id="0ed13-111">Valitse Finance and Operations -sovelluksen sivulla **Avaa kohteessa Microsoft Office**.</span><span class="sxs-lookup"><span data-stu-id="0ed13-111">On a page in a Finance and Operations app, select **Open in Microsoft Office**.</span></span>

    <span data-ttu-id="0ed13-112">Jos sivun juuritietolähde (taulukko) on sama kuin minkä tahansa yksikön juuritietolähde, sivulle muodostetaan oletusasetuksena **Avaa Excelissä**.</span><span class="sxs-lookup"><span data-stu-id="0ed13-112">If the root data source (table) for the page is the same as the root data source for any entities, default **Open in Excel** options are generated for the page.</span></span> <span data-ttu-id="0ed13-113">**Avaa Excelissä** -vaihtoehto löytyy usein käytetyillä sivuilla, kuten **Kaikki toimittajat** ja **Kaikki asiakkaat**.</span><span class="sxs-lookup"><span data-stu-id="0ed13-113">**Open in Excel** options can be found on frequently used pages, such as **All vendors** and **All customers**.</span></span>
 
2. <span data-ttu-id="0ed13-114">Valitse **Avaa Excelissä** -vaihtoehto ja avaa luotu työkirja.</span><span class="sxs-lookup"><span data-stu-id="0ed13-114">Select an **Open in Excel** option, and open the workbook that is generated.</span></span> <span data-ttu-id="0ed13-115">Tämä työkirja sisältää yksikön sidostiedot, osoitin ympäristöön ja osoitin Excel-lisäosaan.</span><span class="sxs-lookup"><span data-stu-id="0ed13-115">This workbook has binding information for the entity, a pointer to your environment, and a pointer to the Excel add-in.</span></span>
3. <span data-ttu-id="0ed13-116">Valitse Excelin **Ota muokkaus käyttöön** -painike, jotta voit ajaa Excel-lisäosan.</span><span class="sxs-lookup"><span data-stu-id="0ed13-116">In Excel, select **Enable editing** to enable the Excel add-in to run.</span></span> <span data-ttu-id="0ed13-117">Excel-lisäosa toimii Excel-ikkunan oikealla puolella olevassa ruudussa.</span><span class="sxs-lookup"><span data-stu-id="0ed13-117">The Excel add-in runs in a pane on the right side of the Excel window.</span></span>
4. <span data-ttu-id="0ed13-118">Jos käytät Excel-lisäosaa ensimmäistä kertaa, valitse **Luota tähän lisäosaan**.</span><span class="sxs-lookup"><span data-stu-id="0ed13-118">If you're running the Excel add-in for the first time, select **Trust this Add-in**.</span></span>
5. <span data-ttu-id="0ed13-119">Jos näet kirjautumisruudun, valitse **Kirjaudu sisään** ja kirjaudu sitten sisään samoilla tunnuksilla, joilla kirjaudut Finance and Operations -sovellukseen.</span><span class="sxs-lookup"><span data-stu-id="0ed13-119">If you're prompted to sign in, select **Sign in**, and then sign in by using the same credentials that you used to sign in to the Finance and Operations app.</span></span> <span data-ttu-id="0ed13-120">Excel-apuohjelma käyttää aiempaa sisäänkirjautumista selaimesta ja kirjaa sinut sisään automaattisesti, jos se on mahdollista.</span><span class="sxs-lookup"><span data-stu-id="0ed13-120">The Excel add-in will use a previous sign-in context from the browser and automatically sign you in, if it can.</span></span> <span data-ttu-id="0ed13-121">(Käyttöjärjestelmäkohtaisia lisätietoja käytetystä selaimesta on kohdassa [Office-apuohjelmien käyttämät selaimet](https://docs.microsoft.com/office/dev/add-ins/concepts/browsers-used-by-office-web-add-ins.) Kirjautumisen onnistumisen voi varmistaa tarkistamalla, mikä nimi on Excel-apuohjelman oikeassa yläkulmassa.</span><span class="sxs-lookup"><span data-stu-id="0ed13-121">(For information about the browser that is used based on the operating system, see [Browsers used by Office add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/browsers-used-by-office-web-add-ins.) To ensure that sign-in was successful, verify the user name in the upper-right corner of the Excel add-in.</span></span> 

<span data-ttu-id="0ed13-122">Excel-lisä lukee valitsemasi yksikön tiedot automaattisesti.</span><span class="sxs-lookup"><span data-stu-id="0ed13-122">The Excel add-in automatically reads the data for the entity that you selected.</span></span> <span data-ttu-id="0ed13-123">Huomaa, että työkirjassa ei ole tietoja ennen kuin Excel-lisäosa on lukenut tiedot.</span><span class="sxs-lookup"><span data-stu-id="0ed13-123">Note that there will be no data in the workbook until the Excel add-in reads it in.</span></span>

## <a name="open-entity-data-in-excel-when-you-start-from-excel"></a><span data-ttu-id="0ed13-124">Avaa yksikön tiedot Excelissä käynnistämisen yhteydessä</span><span class="sxs-lookup"><span data-stu-id="0ed13-124">Open entity data in Excel when you start from Excel</span></span>
1. <span data-ttu-id="0ed13-125">Avaa Office-kauppa valitsemalla **Myymälä**-painike Excelin **Lisää**-välilehden **Lisäosat**-ryhmässä.</span><span class="sxs-lookup"><span data-stu-id="0ed13-125">In Excel, on the **Insert** tab, in the **Add-ins** group, select **Store** to open the Office Store.</span></span>
2. <span data-ttu-id="0ed13-126">Etsi Office-kaupasta avainsanalla **Dynamics** ja valitse **Lisää** **Microsoft Dynamics Office -lisäosa** -kohdan vieressä (Excel-lisäosa).</span><span class="sxs-lookup"><span data-stu-id="0ed13-126">In the Office Store, search on the keyword **Dynamics**, and then select **Add** next to **Microsoft Dynamics Office Add-in** (the Excel add-in).</span></span>
3. <span data-ttu-id="0ed13-127">Jos käytät Excel-lisäosaa ensimmäistä kertaa, valitse **Luota tähän lisäosaan** voidaksesi käyttää sitä.</span><span class="sxs-lookup"><span data-stu-id="0ed13-127">If you're running the Excel add-in for the first time, select **Trust this Add-in** to enable the Excel add-in to run.</span></span> <span data-ttu-id="0ed13-128">Excel-lisäosa toimii Excel-ikkunan oikealla puolella olevassa ruudussa.</span><span class="sxs-lookup"><span data-stu-id="0ed13-128">The Excel add-in runs in a pane on the right side of the Excel window.</span></span>
4. <span data-ttu-id="0ed13-129">Avaa **Asetukset**-ruutu valitsemalla **Lisää palvelimen tiedot** -painike.</span><span class="sxs-lookup"><span data-stu-id="0ed13-129">Select **Add server information** to open the **Options** pane.</span></span>
5. <span data-ttu-id="0ed13-130">Kopioi kohteena olevan Finance and Operations -sovellusesiintymän URL-osoite selaimessa, liitä se **Palvelimen URL-osoite** -kenttään ja poista kaikki teksti isäntänimen jälkeen.</span><span class="sxs-lookup"><span data-stu-id="0ed13-130">In your browser, copy the URL of your target Finance and Operations app instance, paste it into the **Server URL** field, and then delete everything after the host name.</span></span> <span data-ttu-id="0ed13-131">URL-osoitteessa tulisi olla vain isäntänimi.</span><span class="sxs-lookup"><span data-stu-id="0ed13-131">The resulting URL should have only the host name.</span></span>

    <span data-ttu-id="0ed13-132">Jos URL-osoite on esimerkiksi `https://xxx.dynamics.com/?cmp=usmf&amp;mi=CustTableListPage`, poista kaikki kaikki muut tiedot paitsi `https://xxx.dynamics.com`.</span><span class="sxs-lookup"><span data-stu-id="0ed13-132">For example, if the URL is `https://xxx.dynamics.com/?cmp=usmf&amp;mi=CustTableListPage`, delete everything except `https://xxx.dynamics.com`.</span></span>

6. <span data-ttu-id="0ed13-133">Valitse **OK** ja vahvista muutos valitsemalla **Kyllä**.</span><span class="sxs-lookup"><span data-stu-id="0ed13-133">Select **OK**, and then select **Yes** to confirm the change.</span></span> <span data-ttu-id="0ed13-134">Excel-lisäosa käynnistetään uudelleen. Se lataa metatiedot.</span><span class="sxs-lookup"><span data-stu-id="0ed13-134">The Excel add-in is restarted and loads metadata.</span></span>

    <span data-ttu-id="0ed13-135">**Rakenne**-painike on nyt käytettävissä.</span><span class="sxs-lookup"><span data-stu-id="0ed13-135">The **Design** button is now available.</span></span> <span data-ttu-id="0ed13-136">Jos Excel-lisäosassa on **Lataa sovelmat** -painike, et ehkä ole kirjautunut oikeana käyttäjänä.</span><span class="sxs-lookup"><span data-stu-id="0ed13-136">If the Excel add-in has a **Load applets** button, you probably aren't signed in as the correct user.</span></span> <span data-ttu-id="0ed13-137">Lisätietoja on tämän ohjeaiheen [Vianmääritys](https://docs.microsoft.com/dynamics365/unified-operations/dev-itpro/office-integration/use-excel-add-in#troubleshooting) -osan Lataa sovelmat -painike on näkyvissä -kohdassa.</span><span class="sxs-lookup"><span data-stu-id="0ed13-137">For more information, see "The Load applets button is shown" in the [Troubleshooting](https://docs.microsoft.com/dynamics365/unified-operations/dev-itpro/office-integration/use-excel-add-in#troubleshooting) section of this topic.</span></span>

7. <span data-ttu-id="0ed13-138">Valitse **Rakenne**.</span><span class="sxs-lookup"><span data-stu-id="0ed13-138">Select **Design**.</span></span> <span data-ttu-id="0ed13-139">Excel-lisäosa hakee yksikön metatiedot.</span><span class="sxs-lookup"><span data-stu-id="0ed13-139">The Excel add-in retrieves entity metadata.</span></span>
8. <span data-ttu-id="0ed13-140">Valitse **Lisää taulu**.</span><span class="sxs-lookup"><span data-stu-id="0ed13-140">Select **Add table**.</span></span> <span data-ttu-id="0ed13-141">Näkyviin tulee luettelo yksiköistä.</span><span class="sxs-lookup"><span data-stu-id="0ed13-141">A list of entities appears.</span></span> <span data-ttu-id="0ed13-142">Yksiköt näytetään muodossa "Nimi – Otsikko".</span><span class="sxs-lookup"><span data-stu-id="0ed13-142">The entities are listed in "Name - Label" format.</span></span>
9. <span data-ttu-id="0ed13-143">Valitse luettelosta yksikkö, kuten **Asiakas - Asiakkaat**. Valitse sitten **Seuraava**.</span><span class="sxs-lookup"><span data-stu-id="0ed13-143">Select an entity in the list, such as **Customer - Customers**, and then select **Next**.</span></span>
10. <span data-ttu-id="0ed13-144">Jos haluat lisätä kentän **Käytettävissä olevat kentät** -luettelosta **Valitut kentät** -luetteloon, valitse kenttä ja valitse sitten **Lisää**.</span><span class="sxs-lookup"><span data-stu-id="0ed13-144">To add a field from the **Available fields** list to the **Selected fields** list, select the field, and then select **Add**.</span></span> <span data-ttu-id="0ed13-145">Vaihtoehtoisesti voit kaksoisnapsauttaa **Käytettävissä olevat kentät** -luettelon kenttää.</span><span class="sxs-lookup"><span data-stu-id="0ed13-145">Alternatively, double-click the field in the **Available fields** list.</span></span>
11. <span data-ttu-id="0ed13-146">Kun olet lisännyt haluamasi kentät **Valitut kentät** -luetteloon, varmista, että kohdistin on oikeassa kohdassa taulukkoa (esimerkiksi solu A1) ja valitse sitten **Valmis**.</span><span class="sxs-lookup"><span data-stu-id="0ed13-146">After you've finished adding fields to the **Selected fields** list, make sure that the cursor is in the correct place in the worksheet (for example, cell A1), and then select **Done**.</span></span> <span data-ttu-id="0ed13-147">Valitse sitten **Valmis** ja sulje suunnitteluohjelma.</span><span class="sxs-lookup"><span data-stu-id="0ed13-147">Then select **Done** to exit the designer.</span></span>
12. <span data-ttu-id="0ed13-148">Valitse **Päivitä** ja hae tietojoukko.</span><span class="sxs-lookup"><span data-stu-id="0ed13-148">Select **Refresh** to pull in a set of data.</span></span>

## <a name="view-and-update-entity-data-in-excel"></a><span data-ttu-id="0ed13-149">Näytä ja päivitä yksikön tiedot Excelissä</span><span class="sxs-lookup"><span data-stu-id="0ed13-149">View and update entity data in Excel</span></span>
<span data-ttu-id="0ed13-150">Kun Excel-lisäosa lukee yksikön tiedot työkirjaan, voit päivittää tiedot milloin tahansa valitsemalla Excel-lisäosassa **Päivitä**.</span><span class="sxs-lookup"><span data-stu-id="0ed13-150">After the Excel add-in reads entity data into the workbook, you can update the data at any time by selecting **Refresh** in the Excel add-in.</span></span>

## <a name="edit-entity-data-in-excel"></a><span data-ttu-id="0ed13-151">Muokkaa yksikön tietoja Excelissä</span><span class="sxs-lookup"><span data-stu-id="0ed13-151">Edit entity data in Excel</span></span>
<span data-ttu-id="0ed13-152">Voit muuttaa yksikön tietoja tarpeen mukaan ja julkaista muutokset takaisin Finance and Operations -sovelluksiin valitsemalla Excel-apuohjelmassa **Julkaise**.</span><span class="sxs-lookup"><span data-stu-id="0ed13-152">You can change entity data as you require and then publish it back to Finance and Operations apps by selecting **Publish** in the Excel add-in.</span></span> <span data-ttu-id="0ed13-153">Jos haluat muokata tietuetta, valitse työkirjassa solu ja muuta sitten solun arvoa.</span><span class="sxs-lookup"><span data-stu-id="0ed13-153">To edit a record, select a cell in the worksheet, and then change the cell value.</span></span> <span data-ttu-id="0ed13-154">Jos haluat lisätä uuden tietueen, seuraa jotakin näistä vaiheista:</span><span class="sxs-lookup"><span data-stu-id="0ed13-154">To add a new record, follow one of these steps:</span></span>

- <span data-ttu-id="0ed13-155">Napsauta tietolähdetaulun jotakin kohtaa ja valitse sitten **Uusi** Excel-lisäosassa.</span><span class="sxs-lookup"><span data-stu-id="0ed13-155">Click anywhere in the data sources table, and then select **New** in the Excel add-in.</span></span>
- <span data-ttu-id="0ed13-156">Napsauta tietolähdetaulun viimeistä riviä ja paina sarkainpainiketta, kunnes kohdistin siirtyy pois rivin viimeisestä sarakkeesta ja luo uuden rivin.</span><span class="sxs-lookup"><span data-stu-id="0ed13-156">Click anywhere in the last row of the data sources table, and then press the Tab key until the cursor moves out of the last column of that row and a new row is created.</span></span>
- <span data-ttu-id="0ed13-157">Napsauta tietolähdetaulun alapuolella olevaa riviä ja aloita tietojen syöttäminen soluun.</span><span class="sxs-lookup"><span data-stu-id="0ed13-157">Click anywhere in the row immediately below the data sources table, and start to enter data in a cell.</span></span> <span data-ttu-id="0ed13-158">Kun siirrät kohdistuksen pois solusta, taulu laajentuu uudelle riville.</span><span class="sxs-lookup"><span data-stu-id="0ed13-158">When you move the focus out of that cell, the table expands to include the new row.</span></span>
- <span data-ttu-id="0ed13-159">Valitse otsikkotietueiden kenttäsidoksia varten jotakin kentistä ja valitse sitten **Uusi** Excel-apuohjelmassa.</span><span class="sxs-lookup"><span data-stu-id="0ed13-159">For field bindings of header records, select one of the fields, and then select **New** in the Excel add-in.</span></span>

<span data-ttu-id="0ed13-160">Huomaa, että uusi tietue luodaan vain, jos kaikki avain- ja pakolliset kentät on sidottu työkirjassa tai jos oletusarvot on täytetty suodatusehdon avulla.</span><span class="sxs-lookup"><span data-stu-id="0ed13-160">Note that a new record can be created only if all the key and mandatory fields are bound in the worksheet, or if default values were filled in by using the filter condition.</span></span>

<span data-ttu-id="0ed13-161">Jos haluat poistaa tietueen, seuraa jotakin näistä vaiheista:</span><span class="sxs-lookup"><span data-stu-id="0ed13-161">To delete a record, follow one of these steps:</span></span>

- <span data-ttu-id="0ed13-162">Napsauta hiiren kakkospainikkeella poistettavan rivin numeroa työkirjan rivin vieressä ja valitse sitten **Poista**.</span><span class="sxs-lookup"><span data-stu-id="0ed13-162">Right-click the row number next to the worksheet row that should be deleted, and then select **Delete**.</span></span>
- <span data-ttu-id="0ed13-163">Napsauta hiiren kakkospainikkeella poistettavan rivin numeroa ja valitse sitten **Poista** &gt; **Taulun rivit**.</span><span class="sxs-lookup"><span data-stu-id="0ed13-163">Right-click anywhere in the worksheet row that should be deleted, and then select **Delete** &gt; **Table Rows**.</span></span>

<span data-ttu-id="0ed13-164">Jos tietolähteitä on lisätty liittyvinä tietolähteinä, otsikko julkaistaan ennen rivejä.</span><span class="sxs-lookup"><span data-stu-id="0ed13-164">If data sources have been added as related data sources, the header is published before the lines.</span></span> <span data-ttu-id="0ed13-165">Jos muiden tietolähteiden välillä on riippuvaisuuksia, joudut ehkä vaihtamaan oletusjulkaisujärjestystä.</span><span class="sxs-lookup"><span data-stu-id="0ed13-165">If there are dependencies between other data sources, you might have to change the default publishing order.</span></span> <span data-ttu-id="0ed13-166">Jos haluat muuttaa julkaisujärjestystä, valitse Excel-lisäosassa **Asetukset**-painike (ratassymboli) ja valitse sitten **Data Connector** -pikavälilehdessä **Määritä julkaisujärjestys**.</span><span class="sxs-lookup"><span data-stu-id="0ed13-166">To change the publishing order, in the Excel add-in, select the **Options** button (the gear symbol), and then, on the **Data Connector** FastTab, select **Configure publish order**.</span></span>

## <a name="add-or-remove-columns"></a><span data-ttu-id="0ed13-167">Lisää tai poista sarakkeita</span><span class="sxs-lookup"><span data-stu-id="0ed13-167">Add or remove columns</span></span>
<span data-ttu-id="0ed13-168">Voit säätää työkirjaan automaattisesti lisättäviä sarakkeita suunnittelijasovelluksessa.</span><span class="sxs-lookup"><span data-stu-id="0ed13-168">You can use the designer to adjust the columns that are automatically added to the worksheet.</span></span>

> [!NOTE]
> <span data-ttu-id="0ed13-169">Jos **Rakenne**-painike ei näy Excel-lisäosan **Suodatin**-painikkeen alla, ota tietolähteen suunnitteluohjelma käyttöön.</span><span class="sxs-lookup"><span data-stu-id="0ed13-169">If the **Design** button doesn't appear below the **Filter** button in the Excel add-in, you must enable the data source designer.</span></span> <span data-ttu-id="0ed13-170">Valitse **Asetukset**-painike (ratassynboli) ja valitse sitten **Ota rakenne käyttöön** -valintaruutu.</span><span class="sxs-lookup"><span data-stu-id="0ed13-170">Select the **Options** button (the gear symbol), and then select the **Enable design** check box.</span></span>

1. <span data-ttu-id="0ed13-171">Valitse Excel-lisäosassa **Rakenne**.</span><span class="sxs-lookup"><span data-stu-id="0ed13-171">In the Excel add-in, select **Design**.</span></span> <span data-ttu-id="0ed13-172">Kaikki tietolähteet luetellaan.</span><span class="sxs-lookup"><span data-stu-id="0ed13-172">All the data sources are listed.</span></span>
2. <span data-ttu-id="0ed13-173">Valitse tietolähteen vierestä **Muokkaa**-painike (kynäsymboli).</span><span class="sxs-lookup"><span data-stu-id="0ed13-173">Next to the data source, select the **Edit** button (the pencil symbol).</span></span>
3. <span data-ttu-id="0ed13-174">Muuta **Valitut kentät** -luettelon kenttäluetteloa haluamallasi tavalla seuraavasti:</span><span class="sxs-lookup"><span data-stu-id="0ed13-174">In the **Selected fields** list, adjust the list of fields as you require:</span></span>

    - <span data-ttu-id="0ed13-175">Jos haluat lisätä kentän **Käytettävissä olevat kentät** -luettelosta **Valitut kentät** -luetteloon, valitse kenttä ja valitse sitten **Lisää**.</span><span class="sxs-lookup"><span data-stu-id="0ed13-175">To add a field from the **Available fields** list to the **Selected fields** list, select the field, and then select **Add**.</span></span> <span data-ttu-id="0ed13-176">Vaihtoehtoisesti voit kaksoisnapsauttaa **Käytettävissä olevat kentät** -luettelon kenttää.</span><span class="sxs-lookup"><span data-stu-id="0ed13-176">Alternatively, double-click the field in the **Available fields** list.</span></span>
    - <span data-ttu-id="0ed13-177">Voit poistaa kentän **Valitut kentät** -luettelosta valitsemalla kentän ja valitsemalla sitten **Poista**.</span><span class="sxs-lookup"><span data-stu-id="0ed13-177">To remove a field from the **Selected fields** list, select the field, and then select **Remove**.</span></span> <span data-ttu-id="0ed13-178">Vaihtoehtoisesti voit kaksoisnapsauttaa kenttää.</span><span class="sxs-lookup"><span data-stu-id="0ed13-178">Alternatively, double-click the field.</span></span>
    - <span data-ttu-id="0ed13-179">Jos haluat muuttaa kenttien järjestystä **Valitut kentät** -luettelossa, valitse kenttä ja valitse sitten **Ylös** tai **Alas**.</span><span class="sxs-lookup"><span data-stu-id="0ed13-179">To change the order of fields in the **Selected fields** list, select a field, and then select **Up** or **Down**.</span></span>

4. <span data-ttu-id="0ed13-180">Ota käyttöön tietolähteeseen tehdyt muutokset valitsemalla **Päivitä**.</span><span class="sxs-lookup"><span data-stu-id="0ed13-180">To apply your changes to the data source, select **Update**.</span></span> <span data-ttu-id="0ed13-181">Valitse sitten **Valmis** ja sulje suunnitteluohjelma.</span><span class="sxs-lookup"><span data-stu-id="0ed13-181">Then select **Done** to exit the designer.</span></span>
5. <span data-ttu-id="0ed13-182">Jos olet lisännyt kentän (sarakkeen), valitse **Päivitä**, niin ohjelma hakee päivitetyn tietojoukon.</span><span class="sxs-lookup"><span data-stu-id="0ed13-182">If you added a field (column), select **Refresh** to pull in an updated set of data.</span></span>

## <a name="change-the-publish-batch-size"></a><span data-ttu-id="0ed13-183">Julkaisuerän koon muuttaminen</span><span class="sxs-lookup"><span data-stu-id="0ed13-183">Change the publish batch size</span></span>
<span data-ttu-id="0ed13-184">Kun käyttäjä julkaisee muutoksia tietotietueisiin Excel-apuohjelmalla, päivitykset lähetetään erissä.</span><span class="sxs-lookup"><span data-stu-id="0ed13-184">When users publish changes to data records by using the Excel add-in, the updates are submitted in batches.</span></span> <span data-ttu-id="0ed13-185">Julkaisuerän oletuskoko on 100 riviä.</span><span class="sxs-lookup"><span data-stu-id="0ed13-185">The default publish batch size is 100 rows.</span></span> <span data-ttu-id="0ed13-186">Versiossa 10.0.17 ja sitä uudemmissa versioissa **Julkaisuerän koon määrittämisen salliminen Excel-apuohjelmassa** -toiminto antaa joustavan tavan hallita julkaisuerän kokoa.</span><span class="sxs-lookup"><span data-stu-id="0ed13-186">In version 10.0.17 and later, the **Allow configuration of the publish batch size in the Excel add-in** feature gives you flexible control over the publish batch size.</span></span>

<span data-ttu-id="0ed13-187">Järjestelmänvalvojat voivat määrittää koko järjestelmää koskevan julkaisuerän kokorajoituksen Avaa Excelissä -työkirjoissa. Määritys tehdään määrittämällä **Julkaisuerän raja** -kenttä **Office-sovelluksen parametrit** -sivun **Sovelluksen parametrit** -osassa.</span><span class="sxs-lookup"><span data-stu-id="0ed13-187">System administrators can specify a system-wide limit on the publish batch size for "Open in Excel" workbooks by setting the **Publish batch limit** field in the **App parameters** section of the **Office app parameters** page.</span></span>

<span data-ttu-id="0ed13-188">Julkaisuerän koko voidaan muuttaa myös yksittäisessä työkirjassa Excel-apuohjelman avulla.</span><span class="sxs-lookup"><span data-stu-id="0ed13-188">The publish batch size can also be changed for an individual workbook by using the Excel add-in.</span></span>

1. <span data-ttu-id="0ed13-189">Avaa työkirja Excelissä.</span><span class="sxs-lookup"><span data-stu-id="0ed13-189">Open the workbook in Excel.</span></span>
2. <span data-ttu-id="0ed13-190">Valitse **Asetukset**(ratas) -painike Excel-apuohjelman oikeassa yläkulmassa.</span><span class="sxs-lookup"><span data-stu-id="0ed13-190">Select the **Option** (gear) button in the upper right of the Excel add-in.</span></span>
3. <span data-ttu-id="0ed13-191">Määritä **Julkaisuerän koko** -kenttään sopiva arvo.</span><span class="sxs-lookup"><span data-stu-id="0ed13-191">Set the **Publish batch size** field as desired.</span></span> <span data-ttu-id="0ed13-192">Määritetyn arvon on oltava pienempi kuin koko järjestelmää koskeva julkaisuerän raja.</span><span class="sxs-lookup"><span data-stu-id="0ed13-192">The value that you set must be less than the system-wide publish batch limit.</span></span>
4. <span data-ttu-id="0ed13-193">Valitse **OK**.</span><span class="sxs-lookup"><span data-stu-id="0ed13-193">Select **OK**.</span></span>
5. <span data-ttu-id="0ed13-194">Tallenna työkirja.</span><span class="sxs-lookup"><span data-stu-id="0ed13-194">Save the workbook.</span></span> <span data-ttu-id="0ed13-195">Jos työkirjaa ei tallenneta, kun apuohjelman asetuksia on muutettu, kyseiset muutokset eivät ole työkirjassa, kun se avataan uudelleen.</span><span class="sxs-lookup"><span data-stu-id="0ed13-195">If you don't save the workbook after you make changes to the add-in settings, those changes won't persist when the workbook is reopened.</span></span>

<span data-ttu-id="0ed13-196">Excel-työkirjamallin tekijät voivat määrittää samalla tavoin mallien julkaisuerän koon, ennen kuin ne ladataan järjestelmään.</span><span class="sxs-lookup"><span data-stu-id="0ed13-196">Excel workbook template authors can use the same procedure to set the publish batch size for templates before they upload them into the system.</span></span>

## <a name="copy-environment-data"></a><span data-ttu-id="0ed13-197">Kopioi ympäristön tiedot</span><span class="sxs-lookup"><span data-stu-id="0ed13-197">Copy environment data</span></span>

<span data-ttu-id="0ed13-198">Ympäristöstä työkirjaan luettavat tiedot voidaan kopioida toiseen ympäristöön.</span><span class="sxs-lookup"><span data-stu-id="0ed13-198">The data that is read into the workbook from one environment can be copied to another environment.</span></span> <span data-ttu-id="0ed13-199">Et voi kuitenkaan muuttaa yhteyden URL-osoitetta noin vain, koska työkirjan tietovälimuisti jatkaa tietojen käsittelemistä aiemmin luotuina tietoina.</span><span class="sxs-lookup"><span data-stu-id="0ed13-199">However, you can't just change the connection URL, because the data cache in the workbook will continue to treat the data as existing data.</span></span> <span data-ttu-id="0ed13-200">Sen sijaan tietojen julkaisemisessa uuteen ympäristöön uusina tietoina on käytettävä Kopioi ympäristön tiedot -toimintoa.</span><span class="sxs-lookup"><span data-stu-id="0ed13-200">Instead, you must use the Copy Environment Data functionality to publish the data to a new environment as new data.</span></span>

1. <span data-ttu-id="0ed13-201">Valitse **Asetukset**-painike (ratassymboli) ja valitse sitten **Data Connector** -pikavälilehden **Kopioi ympäristön tiedot**.</span><span class="sxs-lookup"><span data-stu-id="0ed13-201">Select the **Options** button (the gear symbol), and then, on the **Data Connector** FastTab, select **Copy Environment Data**.</span></span> 
2. <span data-ttu-id="0ed13-202">Anna uuden ympäristön palvelimen URL-osoite.</span><span class="sxs-lookup"><span data-stu-id="0ed13-202">Enter the server URL for the new environment.</span></span> 
3. <span data-ttu-id="0ed13-203">Vahvista muutokset valitsemalla **OK**. Vahvista toiminto valitsemalla **Kyllä**.</span><span class="sxs-lookup"><span data-stu-id="0ed13-203">Select **OK**, and then select **Yes** to confirm the action.</span></span> <span data-ttu-id="0ed13-204">Excel-lisäosa käynnistetään uudelleen. Se muodostaa yhteyden uuteen ympäristöön.</span><span class="sxs-lookup"><span data-stu-id="0ed13-204">The Excel add-in is restarted and connects to the new environment.</span></span> <span data-ttu-id="0ed13-205">Työkirjan aiemmin luotuja tietoja käsitellään uusina tietoina.</span><span class="sxs-lookup"><span data-stu-id="0ed13-205">Any existing data in the workbook is treated as new data.</span></span>

    <span data-ttu-id="0ed13-206">Excel-lisäosan uudelleenkäynnistyksen jälkeen näkyviin tulee viestiruutu, jossa kerrotaan, että työkirja on ympäristön kopiointitilassa.</span><span class="sxs-lookup"><span data-stu-id="0ed13-206">After the Excel add-in is restarted, a message box states that the workbook is in Environment copy mode.</span></span>

4. <span data-ttu-id="0ed13-207">Voit kopioida tiedot uuteen ympäristöön uusina tietoina, kun valitset **Julkaise**.</span><span class="sxs-lookup"><span data-stu-id="0ed13-207">To copy the data into the new environment as new data, select **Publish**.</span></span> <span data-ttu-id="0ed13-208">Voit peruuttaa ympäristön kopiointitoiminnon ja tarkistaa aiemmin luodut tiedot uudessa ympäristössä valitsemalla **Päivitä**.</span><span class="sxs-lookup"><span data-stu-id="0ed13-208">To cancel the environment copy operation and review the existing data in the new environment, select **Refresh**.</span></span>

## <a name="troubleshooting"></a><span data-ttu-id="0ed13-209">Vianmääritys</span><span class="sxs-lookup"><span data-stu-id="0ed13-209">Troubleshooting</span></span>
<span data-ttu-id="0ed13-210">Tietyt ongelmat ovat ratkaistavissa muutaman helpon vaiheen kautta.</span><span class="sxs-lookup"><span data-stu-id="0ed13-210">There are a few issues that can be resolved through some easy steps.</span></span>

- <span data-ttu-id="0ed13-211">**Lataa sovelmat -painike on näkyvissä** – Jos Excel-lisäosassa on **Lataa sovelmat** -painike kirjautumisen jälkeen, et ehkä ole kirjautunut oikeana käyttäjänä.</span><span class="sxs-lookup"><span data-stu-id="0ed13-211">**The Load applets button is shown** – If the Excel add-in has a **Load applets** button after sign-in, you probably aren't signed in as the correct user.</span></span> <span data-ttu-id="0ed13-212">Ratkaise ongelma varmistamalla, että Excel-lisäosan oikeassa yläkulmassa on oikea käyttäjänimi.</span><span class="sxs-lookup"><span data-stu-id="0ed13-212">To resolve this issue, verify that the correct user name appears in the upper-right corner of the Excel add-in.</span></span> <span data-ttu-id="0ed13-213">Jos näkyvillä on väärä käyttäjänimi, valitse se. Kirjaudu sitten ulos ja kirjaudu takaisin sisään.</span><span class="sxs-lookup"><span data-stu-id="0ed13-213">If an incorrect user name appears, select it, sign out, and then sign back in.</span></span>
- <span data-ttu-id="0ed13-214">**Näyttöön tulee Kielletty-virhesanoma** –Jos näyttöön tulee Kielletty-virhesanoma, kun Excel-lisäosa lataa metatietoja, Excel-lisäosaan kirjautuneella tilillä ei ole käyttöoikeutta kohteena olevaan palveluun, ilmentymään tai tietokantaan.</span><span class="sxs-lookup"><span data-stu-id="0ed13-214">**You receive a "Forbidden" message** – If you receive a "Forbidden" message while the Excel add-in is loading metadata, the account that is signed in to the Excel add-in doesn't have permission to use the targeted service, instance, or database.</span></span> <span data-ttu-id="0ed13-215">Ratkaise ongelma varmistamalla, että Excel-lisäosan oikeassa yläkulmassa on oikea käyttäjänimi.</span><span class="sxs-lookup"><span data-stu-id="0ed13-215">To resolve this issue, verify that the correct user name appears in the upper-right corner of the Excel add-in.</span></span> <span data-ttu-id="0ed13-216">Jos näkyvillä on väärä käyttäjänimi, valitse se. Kirjaudu sitten ulos ja kirjaudu takaisin sisään.</span><span class="sxs-lookup"><span data-stu-id="0ed13-216">If an incorrect user name appears, select it, sign out, and then sign back in.</span></span>
- <span data-ttu-id="0ed13-217">**Excelin päällä näkyy tyhjä verkkosivu** – Jos kirjautumisen aikana avautuu tyhjä verkkosivu, tili vaatii AD FS:n käytön, mutta Excel-lisäosan suorittava Excel-versio ei ole tarpeeksi uusi eikä kirjautumisikkunaa voi ladata.</span><span class="sxs-lookup"><span data-stu-id="0ed13-217">**A blank webpage is shown over Excel** – If a blank webpage is opened during the sign-in process, the account requires AD FS, but the version of Excel that is running the Excel add-in isn't recent enough to load the sign-in dialog box.</span></span> <span data-ttu-id="0ed13-218">Ratkaise ongelma päivittämällä käytössä oleva Excel-versio.</span><span class="sxs-lookup"><span data-stu-id="0ed13-218">To resolve this issue, update the version of Excel that you're using.</span></span> <span data-ttu-id="0ed13-219">Jos olet yritys, jolla on käytössä hidas päivityskanava, voit päivittää Excel-version käyttämällä [Office Deployment Tool -työkalua](https://technet.microsoft.com/library/jj219422.aspx) [vaihtaaksesi hitaan päivityskanavan nykyiseen päivityskanavaan](https://technet.microsoft.com/library/mt455210.aspx).</span><span class="sxs-lookup"><span data-stu-id="0ed13-219">To update the version of Excel when you're in an enterprise that is on the deferred channel, use the [Office deployment tool](https://technet.microsoft.com/library/jj219422.aspx) to [move from the deferred channel to the current channel](https://technet.microsoft.com/library/mt455210.aspx).</span></span>
- <span data-ttu-id="0ed13-220">**Aikakatkaisu tapahtuu tietojen muutoksia julkaistaessa** – Jos ilmoitus aikakatkaisusta avautuu, kun tietojen muutoksia yritetään julkaista yksikköön, kyseisen työnkirjan julkaisuerän koon pienentämistä kannattaa harkita.</span><span class="sxs-lookup"><span data-stu-id="0ed13-220">**You receive a time-out while you publish data changes** – If you receive time-out messages while you're trying to publish data changes to an entity, consider reducing the publish batch size for the affected workbook.</span></span> <span data-ttu-id="0ed13-221">Jos yksikkö käynnistää suuren määrän logiikkaa tietueen muutosten yhteydessä, aikakatkaisujen estäminen voi edellyttää, että päivitykset lähetetään pienissä erissä.</span><span class="sxs-lookup"><span data-stu-id="0ed13-221">Entities that trigger larger amounts of logic on record changes might require updates to be sent in smaller batches to help prevent time-outs.</span></span>


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
