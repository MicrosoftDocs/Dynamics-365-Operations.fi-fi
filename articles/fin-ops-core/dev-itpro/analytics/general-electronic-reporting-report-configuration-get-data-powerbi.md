---
title: Sähköisen raportoinnin (ER) määrittäminen hakemaan tiedot Power BI:hin
description: Tässä ohjeaiheessa kerrotaan, miten omaa sähköisen raportoinnin konfiguraatiota voidaan käyttää tietojen siirron järjestämiseen omasta esiintymästä Power BI -palveluihin.
author: NickSelin
manager: AnnBe
ms.date: 06/20/2017
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.search.scope: Core, Operations
ms.custom: 220314
ms.assetid: 2685df16-5ec8-4fd7-9495-c0f653e82567
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2016-11-30
ms.dyn365.ops.version: Version 1611
ms.openlocfilehash: c5401f310138d19f78412dff318959414c31a191
ms.sourcegitcommit: fbc106af09bdadb860677f590464fb93223cbf65
ms.translationtype: HT
ms.contentlocale: fi-FI
ms.lasthandoff: 11/06/2019
ms.locfileid: "2770020"
---
# <a name="configure-electronic-reporting-er-to-pull-data-into-power-bi"></a><span data-ttu-id="0028a-103">Sähköisen raportoinnin (ER) määrittäminen hakemaan tiedot Power BI:hin</span><span class="sxs-lookup"><span data-stu-id="0028a-103">Configure Electronic reporting (ER) to pull data into Power BI</span></span>

[!include [banner](../includes/banner.md)]

<span data-ttu-id="0028a-104">Tässä ohjeaiheessa kerrotaan, miten omaa sähköisen raportoinnin konfiguraatiota voidaan käyttää tietojen siirron järjestämiseen omasta esiintymästä Power BI -palveluihin.</span><span class="sxs-lookup"><span data-stu-id="0028a-104">This topic explains how you can use your Electronic reporting (ER) configuration to arrange the transfer of data from your instance to Power BI services.</span></span> <span data-ttu-id="0028a-105">Tässä aiheessa käytetään esimerkkinä Intrastat-tapahtumia siirrettävinä liiketoimintatietoina.</span><span class="sxs-lookup"><span data-stu-id="0028a-105">As an example, this topic uses Intrastat transactions as business data that must be transferred.</span></span> <span data-ttu-id="0028a-106">Power BI -karttavisualisointi käyttää tätä Intrastat-tapahtumatietoa näkymän esittämiseen yrityksen tuonti-/vientitoimintojen analyysia varten Power BI -raportissa.</span><span class="sxs-lookup"><span data-stu-id="0028a-106">The Power BI map visualization uses this Intrastat transaction data to present a view for analysis of company import/export activities on the Power BI report.</span></span>

## <a name="overview"></a><span data-ttu-id="0028a-107">Yleiskuvaus</span><span class="sxs-lookup"><span data-stu-id="0028a-107">Overview</span></span>

<span data-ttu-id="0028a-108">Microsoft Power BI on kokoelma ohjelmistopalveluita, sovelluksia ja yhdistimiä, jotka yhdessä muuttavat ulkoiset tietolähteet yhdenmukaiseksi, visuaalisesti mukaansatempaavaksi ja interaktiiviseksi tiedoksi.</span><span class="sxs-lookup"><span data-stu-id="0028a-108">Microsoft Power BI is a collection of software services, apps, and connectors that work together to turn external sources of data into coherent, visually immersive, and interactive insights.</span></span> <span data-ttu-id="0028a-109">Sähköisen raportoinnin (ER) avulla in käyttäjät voivat helposti määrittää tietolähteet ja järjestää sovelluksen tietojen siirron Power BI -palveluun.</span><span class="sxs-lookup"><span data-stu-id="0028a-109">Electronic reporting (ER) lets users easily configure data sources and arrange the transfer of data from the application to Power BI.</span></span> <span data-ttu-id="0028a-110">Tiedot siirretään tiedostoina OpenXML-laskentataulukkomuodossa (Microsoft Excel -työkirjatiedostona).</span><span class="sxs-lookup"><span data-stu-id="0028a-110">The data is transferred as files in the OpenXML worksheet (Microsoft Excel workbook file) format.</span></span> <span data-ttu-id="0028a-111">Siirretyt tiedostot tallennetaan Microsoft SharePoint Serveriin, joka on konfiguroitu tähän tarkoitukseen.</span><span class="sxs-lookup"><span data-stu-id="0028a-111">The transferred files are stored on a Microsoft SharePoint Server that has been configured for that purpose.</span></span> <span data-ttu-id="0028a-112">Tallennettuja tiedostoja Power BI:ssa laadittaessa raportteja, jotka sisältävät visualisointeja (taulukot, kaaviot, kartat ja niin edelleen).</span><span class="sxs-lookup"><span data-stu-id="0028a-112">The stored files are used in Power BI to make reports that include visualizations (tables, charts, maps, and so on).</span></span> <span data-ttu-id="0028a-113">Power BI -raportit jaetaan Power BI -käyttäjille, ja ne saadaan käyttöön Power BI -koontinäytöissä ja sovelluksen sivuilla.</span><span class="sxs-lookup"><span data-stu-id="0028a-113">Power BI reports are shared with Power BI users, and they are accessed in Power BI dashboards and on the application pages.</span></span> <span data-ttu-id="0028a-114">Tässä aiheessa esitellään seuraavat tehtävät:</span><span class="sxs-lookup"><span data-stu-id="0028a-114">This topic explains the following tasks:</span></span>

- <span data-ttu-id="0028a-115">Määritä Microsoft Dynamics 365 Finance.</span><span class="sxs-lookup"><span data-stu-id="0028a-115">Configure Microsoft Dynamics 365 Finance.</span></span>
- <span data-ttu-id="0028a-116">Sähköisen raportoinnin konfiguraation valmistelu Finance-sovelluksen tietojen noutoa varten.</span><span class="sxs-lookup"><span data-stu-id="0028a-116">Prepare your ER format configuration to get data from the Finance application.</span></span>
- <span data-ttu-id="0028a-117">ER-ympäristön konfigurointi tietojen siirtoon Power BI:sta</span><span class="sxs-lookup"><span data-stu-id="0028a-117">Configure the ER environment to transfer data to Power BI.</span></span>
- <span data-ttu-id="0028a-118">Siirretyn tiedon käyttö Power BI -raporttia luotaessa</span><span class="sxs-lookup"><span data-stu-id="0028a-118">Use transferred data to create a Power BI report.</span></span>
- <span data-ttu-id="0028a-119">Power BI -raportin valmistelu Finance-käyttöä varten.</span><span class="sxs-lookup"><span data-stu-id="0028a-119">Make the Power BI report accessible in Finance.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="0028a-120">Edellytykset</span><span class="sxs-lookup"><span data-stu-id="0028a-120">Prerequisites</span></span>
<span data-ttu-id="0028a-121">Tämän aiheen esimerkin suorittaminen edellyttää seuraavia käyttöoikeuksia:</span><span class="sxs-lookup"><span data-stu-id="0028a-121">To complete the example in this topic, you must have the following access:</span></span>

- <span data-ttu-id="0028a-122">Käyttöoikeudet seuraaville rooleille:</span><span class="sxs-lookup"><span data-stu-id="0028a-122">Access for one of the following roles:</span></span>

    - <span data-ttu-id="0028a-123">Sähköisen raportoinnin kehittäjä</span><span class="sxs-lookup"><span data-stu-id="0028a-123">Electronic reporting developer</span></span>
    - <span data-ttu-id="0028a-124">Sähköisen raportoinnin toiminnallinen konsultti</span><span class="sxs-lookup"><span data-stu-id="0028a-124">Electronic reporting functional consultant</span></span>
    - <span data-ttu-id="0028a-125">Järjestelmänvalvoja</span><span class="sxs-lookup"><span data-stu-id="0028a-125">System administrator</span></span>

- <span data-ttu-id="0028a-126">Sovelluksen käyttöön määritetyn SharePoint Serverin käyttöoikeudet.</span><span class="sxs-lookup"><span data-stu-id="0028a-126">Access to the SharePoint Server that is configured for use with the application</span></span>
- <span data-ttu-id="0028a-127">Power BI -kehikon käyttöoikeudet</span><span class="sxs-lookup"><span data-stu-id="0028a-127">Access to the Power BI framework</span></span>

## <a name="configure-document-management-parameters"></a><span data-ttu-id="0028a-128">Tiedostonhallintaparametrien konfigurointi</span><span class="sxs-lookup"><span data-stu-id="0028a-128">Configure document management parameters</span></span>
1. <span data-ttu-id="0028a-129">Konfiguroi **Tiedostonhallintaparametrit**-sivulla SharePoint Serve -käyttöoikeudet, joita käytetään yrityksessä, johon olet kirjautunut (DEMF tässä esimerkissä).</span><span class="sxs-lookup"><span data-stu-id="0028a-129">On the **Document management parameters** page, configure access to the SharePoint Server that will be used in the company that you're signed in to (the DEMF company in this example).</span></span>
2. <span data-ttu-id="0028a-130">Testaa yhteys varmistaaksesi, että sinulle myönnetty SharePoint Server -käyttöoikeudet.</span><span class="sxs-lookup"><span data-stu-id="0028a-130">Test the connection to the SharePoint Server to make sure that you've been granted access.</span></span>

    <span data-ttu-id="0028a-131">[![Asiakirjahallinnan parametrisivu](./media/ger-power-bi-sharepoint-server-setting-1024x369.png)](./media/ger-power-bi-sharepoint-server-setting.png)</span><span class="sxs-lookup"><span data-stu-id="0028a-131">[![Document management parameters page](./media/ger-power-bi-sharepoint-server-setting-1024x369.png)](./media/ger-power-bi-sharepoint-server-setting.png)</span></span>

3. <span data-ttu-id="0028a-132">Avaa määritetty SharePoint-sivusto.</span><span class="sxs-lookup"><span data-stu-id="0028a-132">Open the configured SharePoint site.</span></span> <span data-ttu-id="0028a-133">Luo uusi kansio, johon ER tallentaa Excel-tiedostot, jotka sisältävä liiketoimintatietoja, joita Power BI -raportit tarvitsevat Power BI -tietojoukkojen lähteenä.</span><span class="sxs-lookup"><span data-stu-id="0028a-133">Create a new folder where ER will store Excel files that have the business data that the Power BI reports require as a source of Power BI datasets.</span></span>
4. <span data-ttu-id="0028a-134">Voit luoda **Tiedostotyypit**-sivulla uuden tiedostotyypin, jota käytetään juuri luomaasi SharePoint-kansioon kirjauduttaessa.</span><span class="sxs-lookup"><span data-stu-id="0028a-134">On the **Document types** page, create a new document type that will be used to access the SharePoint folder that you just created.</span></span> <span data-ttu-id="0028a-135">Kirjoita **Tiedosto** **Ryhmä**-kenttään ja **SharePoint** **Sijainti**-kenttään ja kirjoita SharePoint-kansion osoite.</span><span class="sxs-lookup"><span data-stu-id="0028a-135">Enter **File** in the **Group** field and **SharePoint** in the **Location** field, and then enter the address of the SharePoint folder.</span></span>

    <span data-ttu-id="0028a-136">[![Tiedostotyypit-sivu](./media/ger-power-bi-sharepoint-document-type-1024x485.png)](./media/ger-power-bi-sharepoint-document-type.png)</span><span class="sxs-lookup"><span data-stu-id="0028a-136">[![Document types page](./media/ger-power-bi-sharepoint-document-type-1024x485.png)](./media/ger-power-bi-sharepoint-document-type.png)</span></span>

## <a name="configure-er-parameters"></a><span data-ttu-id="0028a-137">Konfiguroi ER-parametrit</span><span class="sxs-lookup"><span data-stu-id="0028a-137">Configure ER parameters</span></span>
1. <span data-ttu-id="0028a-138">**Sähköinen raportointi** -työtilassa valitse **Sähköisen raportoinnin parametrit** -linkki.</span><span class="sxs-lookup"><span data-stu-id="0028a-138">In the **Electronic reporting** workspace, click the **Electronic reporting parameters** link.</span></span>
2. <span data-ttu-id="0028a-139">**Liitteet** -välilehdessä valitse **Tiedosto** -tiedostotyyppi kaikissa kentissä.</span><span class="sxs-lookup"><span data-stu-id="0028a-139">On the **Attachments** tab, select the **File** document type for all the fields.</span></span>
3. <span data-ttu-id="0028a-140">**Sähköinen raportointi** -työtilassa aktivoi pakollinen palveluntarjoaja valitsemalla **Aktivoi**.</span><span class="sxs-lookup"><span data-stu-id="0028a-140">In the **Electronic reporting** workspace, make the required provider active by clicking **Set active**.</span></span> <span data-ttu-id="0028a-141">Lisätietoja saat **ER Valitse palveluntarjoaja** -tehtäväoppaasta.</span><span class="sxs-lookup"><span data-stu-id="0028a-141">For more information, play the **ER Select service provider** task guide.</span></span>

## <a name="use-an-er-data-model-as-the-source-of-data"></a><span data-ttu-id="0028a-142">ER-tietomallin käyttö tietolähteenä</span><span class="sxs-lookup"><span data-stu-id="0028a-142">Use an ER data model as the source of data</span></span>
<span data-ttu-id="0028a-143">ER-tietomallin täytyy olla liiketoimintatietolähteenä, jota käytetään Power BI -raporteissa.</span><span class="sxs-lookup"><span data-stu-id="0028a-143">You must have an ER data model as the source of business data that will be used on Power BI reports.</span></span> <span data-ttu-id="0028a-144">Tämä tietomalli ladataan ER-konfiguraatiot-tietovarastosta.</span><span class="sxs-lookup"><span data-stu-id="0028a-144">This data model is uploaded from the ER configurations repository.</span></span> <span data-ttu-id="0028a-145">Lisätietoja on kohdassa [Lataa sähköiset raportoinnin määritykset Lifecycle Services -palvelusta](download-electronic-reporting-configuration-lcs.md) tai **ER Tuo kokoonpano Lifecycle Services -palvelusta** -tehtäväoppaasta.</span><span class="sxs-lookup"><span data-stu-id="0028a-145">For more information, see [Download Electronic reporting configurations from Lifecycle Services](download-electronic-reporting-configuration-lcs.md), or play the **ER Import a configuration from Lifecycle Services** task guide.</span></span> <span data-ttu-id="0028a-146">Valitse **Intrastat** tietomalliksi joka ladataan valitusta ER-konfiguraatiot-tietovarastosta.</span><span class="sxs-lookup"><span data-stu-id="0028a-146">Select **Intrastat** as the data model that will be uploaded from the selected ER configurations repository.</span></span> <span data-ttu-id="0028a-147">(Tässä esimerkissä käytetään mallin 1 versiota.) Tämän jälkeen voit käyttää **Intrastatin** ER-mallin kokoonpanoa **Konfiguroinnit**-sivulla.</span><span class="sxs-lookup"><span data-stu-id="0028a-147">(In this example, version 1 of the model is used.) You can then access the **Intrastat** ER model configuration on the **Configurations** page.</span></span>

<span data-ttu-id="0028a-148">[![Konfiguroinnit-sivu](./media/ger-power-bi-data-model-1024x371.png)](./media/ger-power-bi-data-model.png)</span><span class="sxs-lookup"><span data-stu-id="0028a-148">[![Configurations page](./media/ger-power-bi-data-model-1024x371.png)](./media/ger-power-bi-data-model.png)</span></span>

## <a name="design-an-er-format-configuration"></a><span data-ttu-id="0028a-149">Suunnittele ER-muotokonfiguraatio</span><span class="sxs-lookup"><span data-stu-id="0028a-149">Design an ER format configuration</span></span>
<span data-ttu-id="0028a-150">Sinun on luotava uusi ER-muotokonfiguraatio, joka käyttää **Intrastat**-tietomallia liiketoimintatietolähteenä.</span><span class="sxs-lookup"><span data-stu-id="0028a-150">You must create a new ER format configuration that uses the **Intrastat** data model as the source of business data.</span></span> <span data-ttu-id="0028a-151">Tämän muotokonfiguraation on luotava tulosteet sähköisinä asiakirjoina OpenXML (Excel-tiedosto) -muodossa.</span><span class="sxs-lookup"><span data-stu-id="0028a-151">This format configuration must generate output results as electronic documents in OpenXML (Excel file) format.</span></span> <span data-ttu-id="0028a-152">Lisätietoja on **Sähköisen raportoinnin OPENXML-muotoisten raporttimääritysten luonti** -tehtäväoppaassa.</span><span class="sxs-lookup"><span data-stu-id="0028a-152">For more information, play the **ER Create a configuration for reports in OPENXML format** task guide.</span></span> <span data-ttu-id="0028a-153">Nimeä uusi konfiguraatio **Tuonti-/vientitoiminnot** (Tuonti-/vientitoiminnot) kuvassa esitetyllä tavalla.</span><span class="sxs-lookup"><span data-stu-id="0028a-153">Name the new configuration **Import / export activities**, as shown in the following illustration.</span></span> <span data-ttu-id="0028a-154">Käytä Excel-tiedostoa [ER-tiedot - tuonnin ja viennin tiedot](https://go.microsoft.com/fwlink/?linkid=845208) mallina suunniteltaessa ER-muotoa.</span><span class="sxs-lookup"><span data-stu-id="0028a-154">Use the [ER data - import and export details](https://go.microsoft.com/fwlink/?linkid=845208) Excel file as a template when you design the ER format.</span></span> <span data-ttu-id="0028a-155">(Lisätietoja muotomallin tuomisesta on tehtäväoppassa.)</span><span class="sxs-lookup"><span data-stu-id="0028a-155">(For information about how to import a format template, play the task guide.)</span></span>

<span data-ttu-id="0028a-156">[![Tuonti- tai vientitehtävien määritys](media/ger-power-bi-format-configuration.png)](media/ger-power-bi-format-configuration.png)</span><span class="sxs-lookup"><span data-stu-id="0028a-156">[![Import / export activities configuration](media/ger-power-bi-format-configuration.png)](media/ger-power-bi-format-configuration.png)</span></span>

<span data-ttu-id="0028a-157">Voit muokata **Tuonti-/vientitoiminnot** muotokonfiguraatiota seuraavasti.</span><span class="sxs-lookup"><span data-stu-id="0028a-157">To modify the **Import / export activities** format configuration, follow these steps.</span></span>

1. <span data-ttu-id="0028a-158">Valitse **Suunnittelutoiminto**.</span><span class="sxs-lookup"><span data-stu-id="0028a-158">Click **Designer**.</span></span>
2. <span data-ttu-id="0028a-159">**Muoto**-välilehdellä anna tämän muodon tiedostoelementille nimi **Excel-tulostustiedosto**.</span><span class="sxs-lookup"><span data-stu-id="0028a-159">On the **Format** tab, name the file element for this format **Excel output file**.</span></span>

    <span data-ttu-id="0028a-160">[![Excel-tulostiedoston elementti](./media/ger-power-bi-format-configuration-file-element-name-1024x395.png)](./media/ger-power-bi-format-configuration-file-element-name.png)</span><span class="sxs-lookup"><span data-stu-id="0028a-160">[![Excel output file element](./media/ger-power-bi-format-configuration-file-element-name-1024x395.png)](./media/ger-power-bi-format-configuration-file-element-name.png)</span></span>

3. <span data-ttu-id="0028a-161">Määritä **Määritys**-välilehdessä Excel-tiedoston nimi, joka luodaan aina, kun tämä muoto suoritetaan.</span><span class="sxs-lookup"><span data-stu-id="0028a-161">On the **Mapping** tab, specify the name of the Excel file that will be generated whenever this format is run.</span></span> <span data-ttu-id="0028a-162">Määritä liittyvä lauseke palauttamaan arvon **Tietojen tuonti ja vienti** (Tuodut ja viedyt tiedot) (.xlsx-tiedostotunniste lisätään automaattisesti).</span><span class="sxs-lookup"><span data-stu-id="0028a-162">Configure the related expression to return the value **Import and export details** (the .xlsx file name extension will be added automatically).</span></span>

    <span data-ttu-id="0028a-163">[![Muodon suunnittelija](./media/ger-power-bi-format-configuration-output-file-name-1024x396.png)](./media/ger-power-bi-format-configuration-output-file-name.png)</span><span class="sxs-lookup"><span data-stu-id="0028a-163">[![Format designer](./media/ger-power-bi-format-configuration-output-file-name-1024x396.png)](./media/ger-power-bi-format-configuration-output-file-name.png)</span></span>

4. <span data-ttu-id="0028a-164">Lisää uusi tietolähdenimike tälle muodolle.</span><span class="sxs-lookup"><span data-stu-id="0028a-164">Add a new data source item for this format.</span></span> <span data-ttu-id="0028a-165">(Tätä numerointia tarvitaan myöhempää tietojen sidontaa varten.)</span><span class="sxs-lookup"><span data-stu-id="0028a-165">(This enumeration will be required for further data binding.)</span></span>

    1. <span data-ttu-id="0028a-166">Nimeä tietolähde **direction\_enum**.</span><span class="sxs-lookup"><span data-stu-id="0028a-166">Name the data source **direction\_enum**.</span></span>
    2. <span data-ttu-id="0028a-167">Valitse **Tietomallin luettelointi** tietolähdetyypiksi.</span><span class="sxs-lookup"><span data-stu-id="0028a-167">Select **Data model enumeration** as the data source type.</span></span>
    3. <span data-ttu-id="0028a-168">Lisätietoja on kohdassa **Suunta**-tietomallin luettelointi.</span><span class="sxs-lookup"><span data-stu-id="0028a-168">Refer to the **Direction** data model enumeration.</span></span>

    <span data-ttu-id="0028a-169">[![direction_enum](./media/ger-power-bi-format-configuration-mapping-added-enum-1024x454.png)](./media/ger-power-bi-format-configuration-mapping-added-enum.png)</span><span class="sxs-lookup"><span data-stu-id="0028a-169">[![direction_enum](./media/ger-power-bi-format-configuration-mapping-added-enum-1024x454.png)](./media/ger-power-bi-format-configuration-mapping-added-enum.png)</span></span>

5. <span data-ttu-id="0028a-170">Suorita **Intrastat**-tietomallin elementtien ja suunnitellun muodon elementtien sidonta kuvassa esitetyllä tavalla.</span><span class="sxs-lookup"><span data-stu-id="0028a-170">Complete the binding of elements of the **Intrastat** data model and elements of the designed format, as shown in the following illustration.</span></span>

    <span data-ttu-id="0028a-171">[![Sidonnan viimeistely](./media/ger-power-bi-format-configuration-mapping-details-1024x454.png)](./media/ger-power-bi-format-configuration-mapping-details.png)</span><span class="sxs-lookup"><span data-stu-id="0028a-171">[![Completing the binding](./media/ger-power-bi-format-configuration-mapping-details-1024x454.png)](./media/ger-power-bi-format-configuration-mapping-details.png)</span></span>

<span data-ttu-id="0028a-172">Kun se on suoritettu, ER-muoto luo tulosteen Excel-muodossa.</span><span class="sxs-lookup"><span data-stu-id="0028a-172">After it's run, the ER format generates the output result in Excel format.</span></span> <span data-ttu-id="0028a-173">Se lähettää Intrastat-tapahtumien tiedot tulosteeseen ja erottaa ne tapahtumina, jotka kuvaavat tuonti- tai vientitehtäviä.</span><span class="sxs-lookup"><span data-stu-id="0028a-173">It sends the details of the Intrastat transactions to the output result, and separates them as transactions that describe either import activities or export activities.</span></span> <span data-ttu-id="0028a-174">Valitsemalla **Suorita** voit testata Intrastat-tapahtumaluettelon uuden ER-muodon **Intrastat**-sivulla (**Vero** &gt; **Ilmoitukset** &gt; **Ulkomaankauppa** &gt; **Intrastat**).</span><span class="sxs-lookup"><span data-stu-id="0028a-174">Click **Run** to test the new ER format for the list of Intrastat transactions on the **Intrastat** page (**Tax** &gt; **Declarations** &gt; **Foreign trade** &gt; **Intrastat**).</span></span>

<span data-ttu-id="0028a-175">[![Intrastat-sivu](./media/ger-power-bi-format-test-run-transactions-1024x322.png)](./media/ger-power-bi-format-test-run-transactions.png)</span><span class="sxs-lookup"><span data-stu-id="0028a-175">[![Intrastat page](./media/ger-power-bi-format-test-run-transactions-1024x322.png)](./media/ger-power-bi-format-test-run-transactions.png)</span></span>

<span data-ttu-id="0028a-176">Seuraava tuloste luodaan.</span><span class="sxs-lookup"><span data-stu-id="0028a-176">The following output result is generated.</span></span> <span data-ttu-id="0028a-177">Tiedoston nimi on **Import and export details.xlsx**, kuten määritit muodon asetuksissa.</span><span class="sxs-lookup"><span data-stu-id="0028a-177">The file is named **Import and export details.xlsx**, as you specified in the format settings.</span></span>

<span data-ttu-id="0028a-178">[![Import and export details.xlsx](./media/ger-power-bi-format-test-run-output-1024x472.png)](./media/ger-power-bi-format-test-run-output.png)</span><span class="sxs-lookup"><span data-stu-id="0028a-178">[![Import and export details.xlsx](./media/ger-power-bi-format-test-run-output-1024x472.png)](./media/ger-power-bi-format-test-run-output.png)</span></span>

## <a name="configure-the-er-destination"></a><span data-ttu-id="0028a-179">ER-kohteiden määrittäminen</span><span class="sxs-lookup"><span data-stu-id="0028a-179">Configure the ER destination</span></span>
<span data-ttu-id="0028a-180">Sinun on määritettävä ER-kehys uuden ER-muotokonfiguraation tulosteen lähettämiseksi erityistavalla.</span><span class="sxs-lookup"><span data-stu-id="0028a-180">You must configure the ER framework to send the output result of the new ER format configuration in a special way.</span></span>

- <span data-ttu-id="0028a-181">Tuloste on lähetettävä valitun SharePoint Serverin kansioon.</span><span class="sxs-lookup"><span data-stu-id="0028a-181">The output result must be sent to the folder of the selected SharePoint Server.</span></span>
- <span data-ttu-id="0028a-182">Jokaisen muotokonfiguraatioon suorituksen on luotava saman Excel-tiedoston uusi versio.</span><span class="sxs-lookup"><span data-stu-id="0028a-182">Each execution of the format configuration must create a new version of same Excel file.</span></span>

<span data-ttu-id="0028a-183">**Sähköinen raportointi** -sivulla (**Organisaation hallinto** &gt; **Sähköinen raportointi**) valitse kohta **Sähköisen raportoinnin kohde** ja lisää uusi kohde.</span><span class="sxs-lookup"><span data-stu-id="0028a-183">On the **Electronic reporting** page (**Organization administration** &gt; **Electronic reporting**), click the **Electronic reporting destination** item, and add a new destination.</span></span> <span data-ttu-id="0028a-184">**Viite**-kentässä valitse **Tuonti-/vientitoiminnot**-muotokonfiguraatio, jonka loit aiemmin.</span><span class="sxs-lookup"><span data-stu-id="0028a-184">In the **Reference** field, select the **Import / export activities** format configuration that you created earlier.</span></span> <span data-ttu-id="0028a-185">Lisää uusi tiedoston kohdetietue viitteeksi seuraavasti.</span><span class="sxs-lookup"><span data-stu-id="0028a-185">Follow these steps to add a new file destination record for the reference.</span></span>

1. <span data-ttu-id="0028a-186">Valitse **Nimi**-kenttään tiedoston kohteen otsikko.</span><span class="sxs-lookup"><span data-stu-id="0028a-186">In the **Name** field, enter the title of the file destination.</span></span>
2. <span data-ttu-id="0028a-187">**Tiedostonimi**-kentässä valitse nimi **Excel-tulostustiedosto** Excel-tiedoston muodoksi.</span><span class="sxs-lookup"><span data-stu-id="0028a-187">In the **File name** field, select the name **Excel output file** for the Excel file format component.</span></span>

<span data-ttu-id="0028a-188">Valitse **Asetukset**-painike uudelle kohdetietueelle.</span><span class="sxs-lookup"><span data-stu-id="0028a-188">Click the **Settings** button for the new destination record.</span></span> <span data-ttu-id="0028a-189">Noudata seuraavia ohjeita **Kohdeasetukset**-valintaikkunassa.</span><span class="sxs-lookup"><span data-stu-id="0028a-189">Then, in the **Destination settings** dialog box, follow these steps.</span></span>

1. <span data-ttu-id="0028a-190">Määritä **Power BI** -välilehdessä **Käytössä**-asetukseksi **Kyllä**.</span><span class="sxs-lookup"><span data-stu-id="0028a-190">On the **Power BI** tab, set the **Enabled** option to **Yes**.</span></span>
2. <span data-ttu-id="0028a-191">Valitse **SharePoint**-kentässä **Jaettu**-tiedostotyyppi, jonka loit aiemmin.</span><span class="sxs-lookup"><span data-stu-id="0028a-191">In the **SharePoint** field, select the **Shared** document type that you created earlier.</span></span>

## <a name="schedule-execution-of-the-configured-er-format"></a><span data-ttu-id="0028a-192">Konfiguroidun ER-muodon suorituksen ajoittaminen</span><span class="sxs-lookup"><span data-stu-id="0028a-192">Schedule execution of the configured ER format</span></span>
1. <span data-ttu-id="0028a-193">**Konfiguroinnit**-sivulla (**Organisaation hallinto** &gt; **Sähköinen raportointi** &gt; **Konfiguroinnit**) konfiguraatioiden puurakenteessa, valitse **Tuonti-/vientitoiminnot**-konfiguraatio, jonka loit aiemmin.</span><span class="sxs-lookup"><span data-stu-id="0028a-193">On the **Configurations** page (**Organization administration** &gt; **Electronic reporting** &gt; **Configurations**), in the configurations tree, select the **Import / export activities** configuration that you created earlier.</span></span>
2. <span data-ttu-id="0028a-194">Vaihda version 1.1 tila **Luonnos**-tilasta **Valmis** -tilaan, jotta voit ottaa tämän muodon käyttöön.</span><span class="sxs-lookup"><span data-stu-id="0028a-194">Change the status of version 1.1 from **Draft** to **Complete** to make this format available for use.</span></span>

    <span data-ttu-id="0028a-195">[![Konfiguroinnit-sivu](./media/ger-power-bi-format-configuration-complete-1024x401.png)](./media/ger-power-bi-format-configuration-complete.png)</span><span class="sxs-lookup"><span data-stu-id="0028a-195">[![Configurations page](./media/ger-power-bi-format-configuration-complete-1024x401.png)](./media/ger-power-bi-format-configuration-complete.png)</span></span>

3. <span data-ttu-id="0028a-196">Valitse valmis versio **Tuonti-/vientitoiminnot**-konfiguraatiosta ja valitse sitten **Suorita**.</span><span class="sxs-lookup"><span data-stu-id="0028a-196">Select the completed version of the **Import / export activities** configuration, and then click **Run**.</span></span> <span data-ttu-id="0028a-197">Huomaa, että konfiguroitua kohdetta sovelletaan tulosteeseen, joka luodaan Excel-muodossa.</span><span class="sxs-lookup"><span data-stu-id="0028a-197">Note that the configured destination is applied to the output result that is generated in Excel format.</span></span>
4. <span data-ttu-id="0028a-198">Määritä **Eräkäsittely**-asetukseksi **Kyllä** raportin suorittamiseksi valvomattomassa tilassa.</span><span class="sxs-lookup"><span data-stu-id="0028a-198">Set the **Batch processing** option to **Yes** to run this report in unattended mode.</span></span>
5. <span data-ttu-id="0028a-199">Valitse **Toistuminen** ja ajoita eräajon suorittamisen pakollinen toistuminen.</span><span class="sxs-lookup"><span data-stu-id="0028a-199">Click **Recurrence** to schedule the required recurrence of this batch execution.</span></span> <span data-ttu-id="0028a-200">Toistuminen määrittää, kuinka usein päivitetyt tiedot siirretään Power BI:hin.</span><span class="sxs-lookup"><span data-stu-id="0028a-200">The recurrence defines how often the updated data will be transferred to Power BI.</span></span>

    <span data-ttu-id="0028a-201">[![Sähköisen raportin parametrit -valintaikkuna](./media/ger-power-bi-format-configuration-run-to-schedule-1024x413.png)](./media/ger-power-bi-format-configuration-run-to-schedule.png)</span><span class="sxs-lookup"><span data-stu-id="0028a-201">[![Electronic report parameters dialog box](./media/ger-power-bi-format-configuration-run-to-schedule-1024x413.png)](./media/ger-power-bi-format-configuration-run-to-schedule.png)</span></span>

6. <span data-ttu-id="0028a-202">Kun se on määritetty, ER-raportin suoritustyö löytyy **Erätyöt**-sivulla (**Järjestelmän hallinta &gt; Kyselyt &gt; Erätyöt**).</span><span class="sxs-lookup"><span data-stu-id="0028a-202">After it's configured, you can find the ER report execution job on the **Batch jobs** page (**System administration &gt; Inquiries &gt; Batch jobs**).</span></span>

    <span data-ttu-id="0028a-203">[![Erätyöt-sivu](./media/ger-power-bi-format-configuration-running-job-1024x410.png)](./media/ger-power-bi-format-configuration-running-job.png)</span><span class="sxs-lookup"><span data-stu-id="0028a-203">[![Batch jobs page](./media/ger-power-bi-format-configuration-running-job-1024x410.png)](./media/ger-power-bi-format-configuration-running-job.png)</span></span>

7. <span data-ttu-id="0028a-204">Kun tämä työ suoritetaan ensimmäisen kerran, kohde luo uuden Excel-tiedoston, jolle on määritetty nimi valitussa SharePoint-kansiossa.</span><span class="sxs-lookup"><span data-stu-id="0028a-204">When this job is run for the first time, the destination creates a new Excel file that has the configured name in the selected SharePoint folder.</span></span> <span data-ttu-id="0028a-205">Myöhemmin joka kerta, kun työ suoritetaan, kohde luo Excel-tiedostosta uuden version.</span><span class="sxs-lookup"><span data-stu-id="0028a-205">Every subsequent time that the job is run, the destination creates a new version of this Excel file.</span></span>

    <span data-ttu-id="0028a-206">[![Excel-tiedoston uusi versio](./media/ger-power-bi-output-file-in-sharepoint-server-folder-2-1024x412.png)](./media/ger-power-bi-output-file-in-sharepoint-server-folder-2.png)</span><span class="sxs-lookup"><span data-stu-id="0028a-206">[![New version of the Excel file](./media/ger-power-bi-output-file-in-sharepoint-server-folder-2-1024x412.png)](./media/ger-power-bi-output-file-in-sharepoint-server-folder-2.png)</span></span>

## <a name="create-a-power-bi-dataset-by-using-the-output-result-of-the-er-format"></a><span data-ttu-id="0028a-207">Power BI -tietojoukon luominen käyttämällä ER-muodon tulostetta</span><span class="sxs-lookup"><span data-stu-id="0028a-207">Create a Power BI dataset by using the output result of the ER format</span></span>
1. <span data-ttu-id="0028a-208">Kirjaudu Power BI:hin ja avaa aiemmin luotu Power BI -ryhmä (työtila) tai luo uusi ryhmä.</span><span class="sxs-lookup"><span data-stu-id="0028a-208">Sign in to Power BI, and either open an existing Power BI group (workspace) or create a new group.</span></span> <span data-ttu-id="0028a-209">Napsauta **Lisää** kohdassa **Tiedostot** **Tuo tai yhdistä tietoihin** -osassa tai napsauta plus-merkkiä (**+**) **Tietojoukot**-kohdan vieressä vasemmassa ruudussa.</span><span class="sxs-lookup"><span data-stu-id="0028a-209">Either click **Add** under **Files** in the **Import or Connect to Data** section, or click the plus sign (**+**) next to **Datasets** in the left pane.</span></span>

    <span data-ttu-id="0028a-210">[![Tietojoukon luonti](./media/ger-power-bi-add-dataset-1024x524.png)](./media/ger-power-bi-add-dataset.png)</span><span class="sxs-lookup"><span data-stu-id="0028a-210">[![Creating a dataset](./media/ger-power-bi-add-dataset-1024x524.png)](./media/ger-power-bi-add-dataset.png)</span></span>

2. <span data-ttu-id="0028a-211">Valitse **SharePoint - ryhmäsivustot** -vaihtoehto ja kirjoita polku, jota käytät SharePoint Serverissä (esimerkissä `https://ax7partner.litware.com`).</span><span class="sxs-lookup"><span data-stu-id="0028a-211">Select the **SharePoint – Team sites** option, and then enter the path of SharePoint Server that you're using (`https://ax7partner.litware.com` in our example).</span></span>
3. <span data-ttu-id="0028a-212">Siirry **/Shared Documents/GER data/PowerBI**-kansioon ja valitse Excel-tiedosto, jonka olet luonut uuden Power BI -tietojoukon tietojen lähteeksi.</span><span class="sxs-lookup"><span data-stu-id="0028a-212">Browse to the **/Shared Documents/GER data/PowerBI** folder, and select the Excel file that you created as the source of data for the new Power BI dataset.</span></span>

    <span data-ttu-id="0028a-213">[![Excel-tiedoston valitseminen](./media/ger-power-bi-add-dataset-select-excel-file-1024x522.png)](./media/ger-power-bi-add-dataset-select-excel-file.png)</span><span class="sxs-lookup"><span data-stu-id="0028a-213">[![Selecting the Excel file](./media/ger-power-bi-add-dataset-select-excel-file-1024x522.png)](./media/ger-power-bi-add-dataset-select-excel-file.png)</span></span>

4. <span data-ttu-id="0028a-214">Valitse **Yhdistä**ja valitse **Tuo**.</span><span class="sxs-lookup"><span data-stu-id="0028a-214">Click **Connect**, and then click **Import**.</span></span> <span data-ttu-id="0028a-215">Luodaan uusi tietojoukko, joka perustuu valittuun Excel-tiedostoon.</span><span class="sxs-lookup"><span data-stu-id="0028a-215">A new dataset is created that is based on the selected Excel file.</span></span> <span data-ttu-id="0028a-216">Tietojoukko voidaan lisätä myös automaattisesti äsken luotuun raporttinäkymään.</span><span class="sxs-lookup"><span data-stu-id="0028a-216">The dataset can also be added automatically to the newly created dashboard.</span></span>

    <span data-ttu-id="0028a-217">[![Tietojoukko koontinäytössä](./media/ger-power-bi-added-dataset-1024x489.png)](./media/ger-power-bi-added-dataset.png)</span><span class="sxs-lookup"><span data-stu-id="0028a-217">[![Dataset on the dashboard](./media/ger-power-bi-added-dataset-1024x489.png)](./media/ger-power-bi-added-dataset.png)</span></span>

5. <span data-ttu-id="0028a-218">Määritä päivitysaikataulu tälle tietojoukolle kausittainen päivityksen pakottamiseksi</span><span class="sxs-lookup"><span data-stu-id="0028a-218">Configure the refresh schedule for this dataset to force a periodic update.</span></span> <span data-ttu-id="0028a-219">Kausittaiset päivitykset mahdollistavat uusien liiketoimintatietojen käytön ER-raportin kausittaisen suorittamisen ansiosta SharePoint Serverille luodun Excel-tiedoston uuden version avulla.</span><span class="sxs-lookup"><span data-stu-id="0028a-219">Periodic updates enable the consumption of new business data that comes via periodic execution of the ER report through new versions of the Excel file that are created on the SharePoint Server.</span></span>

## <a name="create-a-power-bi-report-by-using-the-new-dataset"></a><span data-ttu-id="0028a-220">Power BI -raportin luominen käyttämällä uutta tietojoukkoa</span><span class="sxs-lookup"><span data-stu-id="0028a-220">Create a Power BI report by using the new dataset</span></span>
1. <span data-ttu-id="0028a-221">Valitse **Tietojen tuonti ja vienti** luomassasi Power BI -tietojoukossa.</span><span class="sxs-lookup"><span data-stu-id="0028a-221">Click the **Import and export details** Power BI dataset that you created.</span></span>
2. <span data-ttu-id="0028a-222">Määritä visualisointi.</span><span class="sxs-lookup"><span data-stu-id="0028a-222">Configure the visualization.</span></span> <span data-ttu-id="0028a-223">Valitse esimerkiksi **Täytetty kartta** -visualisointi ja määritä se seuraavasti:</span><span class="sxs-lookup"><span data-stu-id="0028a-223">For example, select the **Filled map** visualization, and configure it as follows:</span></span>

    - <span data-ttu-id="0028a-224">Määritä **CountryOrigin**- tietojoukkokenttä kartan visualisoinnin **Sijainti**-kenttään.</span><span class="sxs-lookup"><span data-stu-id="0028a-224">Assign the **CountryOrigin** dataset field to the **Location** field of the map visualization.</span></span>
    - <span data-ttu-id="0028a-225">Määritä **Määrä**- tietojoukkokenttä kartan visualisoinnin **Värikylläisyys**-kenttään.</span><span class="sxs-lookup"><span data-stu-id="0028a-225">Assign the **Amount** dataset field to the **Color saturation** field of the map visualization.</span></span>
    - <span data-ttu-id="0028a-226">Lisää **Tehtävä** ja **Vuosi** tietojoukkokentät kartan visualisoinnin **Suodattimet**-tietokenttäkokoelmaan.</span><span class="sxs-lookup"><span data-stu-id="0028a-226">Add the **Activity** and **Year** dataset fields to the **Filters** fields collection of the map visualization.</span></span>

3. <span data-ttu-id="0028a-227">Tallenna Power BI -raportti **Tuodut ja viedyt tiedot -raporttina**.</span><span class="sxs-lookup"><span data-stu-id="0028a-227">Save the Power BI report as **Import and export details report**.</span></span>

    <span data-ttu-id="0028a-228">[![Tuonnin ja viennin tietojen raportti](./media/ger-power-bi-added-report-1024x498.png)](./media/ger-power-bi-added-report.png)</span><span class="sxs-lookup"><span data-stu-id="0028a-228">[![Import and export details report](./media/ger-power-bi-added-report-1024x498.png)](./media/ger-power-bi-added-report.png)</span></span>

    <span data-ttu-id="0028a-229">Huomaa, että kartassa näkyvät maat/alueet, jotka on mainittu Excel-tiedostosta (Itävalta ja Sveitsi tässä esimerkissä).</span><span class="sxs-lookup"><span data-stu-id="0028a-229">Note that the map shows the countries/regions that are mentioned in the Excel file (Austria and Switzerland in this example).</span></span> <span data-ttu-id="0028a-230">Nämä maat/alueet näkyvät värillisinä ja osoittavat laskutettujen summien osuuden.</span><span class="sxs-lookup"><span data-stu-id="0028a-230">These countries/regions are colored to show the proportion of invoiced amounts for each.</span></span>

4. <span data-ttu-id="0028a-231">Päivitä Intrastat-tapahtumien luettelo.</span><span class="sxs-lookup"><span data-stu-id="0028a-231">Update the list of Intrastat transactions.</span></span> <span data-ttu-id="0028a-232">Vientitapahtuma, joka on peräisin Italiasta, lisätään.</span><span class="sxs-lookup"><span data-stu-id="0028a-232">The export transaction that originated from Italy is added.</span></span>

    <span data-ttu-id="0028a-233">[![Intrastat-tapahtumien luettelo](./media/ger-power-bi-new-run-new-transaction-1024x321.png)](./media/ger-power-bi-new-run-new-transaction.png)</span><span class="sxs-lookup"><span data-stu-id="0028a-233">[![Intrastat transactions list](./media/ger-power-bi-new-run-new-transaction-1024x321.png)](./media/ger-power-bi-new-run-new-transaction.png)</span></span>

5. <span data-ttu-id="0028a-234">Odota ER-raportin seuraavaa ajoitettua suorittamista ja Power BI -tietojoukon seuraavaa ajoitettua päivitystä.</span><span class="sxs-lookup"><span data-stu-id="0028a-234">Wait for the next scheduled execution of the ER report and the next scheduled update of the Power BI dataset.</span></span> <span data-ttu-id="0028a-235">Käy läpi Power BI -raportti (valitse vain tuotujen tapahtumien näyttö).</span><span class="sxs-lookup"><span data-stu-id="0028a-235">Then review the Power BI report (select to show import transactions only).</span></span> <span data-ttu-id="0028a-236">Päivitetyssä kartassa näkyy nyt Italia.</span><span class="sxs-lookup"><span data-stu-id="0028a-236">The updated map now shows Italy.</span></span>

    <span data-ttu-id="0028a-237">[![Päivitetty määritys](./media/ger-power-bi-new-run-new-map-1024x511.png)](./media/ger-power-bi-new-run-new-map.png)</span><span class="sxs-lookup"><span data-stu-id="0028a-237">[![Updated map](./media/ger-power-bi-new-run-new-map-1024x511.png)](./media/ger-power-bi-new-run-new-map.png)</span></span>

## <a name="access-power-bi-report-in-finance"></a><span data-ttu-id="0028a-238">Power BI -raportin käyttö Financessa</span><span class="sxs-lookup"><span data-stu-id="0028a-238">Access Power BI report in Finance</span></span>
<span data-ttu-id="0028a-239">Voit määrittää Power BI -integraation.</span><span class="sxs-lookup"><span data-stu-id="0028a-239">Set up the integration with Power BI.</span></span> <span data-ttu-id="0028a-240">Lisätietoja on kohdassa [Power BI -integroinnin määrittäminen työtiloille](configure-power-bi-integration.md).</span><span class="sxs-lookup"><span data-stu-id="0028a-240">For more information, see [Configure Power BI integration for workspaces](configure-power-bi-integration.md).</span></span>

1. <span data-ttu-id="0028a-241">Valitse **Sähköinen raportointi** -työtilan sivulla, joka tukee Power BI -integrointia (**Organisaation hallinto** &gt; **Työtilat** &gt; **Sähköisen raportoinnin työtila**), **Asetukset** &gt; **Avaa raporttiluettelo**.</span><span class="sxs-lookup"><span data-stu-id="0028a-241">On the **Electronic reporting** workspace page that supports Power BI integration (**Organization administration** &gt; **Workspaces** &gt; **Electronic reporting workspace**), click **Options** &gt; **Open report catalog**.</span></span>
2. <span data-ttu-id="0028a-242">Valitse **Tuodut ja viedyt tiedot** Power BI -raportti, jonka olet luonut, jotta raportti näytetään valitun sivun toimintonimikkeenä.</span><span class="sxs-lookup"><span data-stu-id="0028a-242">Select the **Import and export details** Power BI report that you created, to show that report as an action item on the selected page.</span></span>
3. <span data-ttu-id="0028a-243">Valitse toimintonimike, joka avaa sivun, jossa näkyy Power BI:ssa suunniteltu raportti.</span><span class="sxs-lookup"><span data-stu-id="0028a-243">Click the action item to open the page that shows the report that you designed in Power BI.</span></span>

    <span data-ttu-id="0028a-244">[![Tuonnin ja viennin tietojen raportti](./media/ger-power-bi-review-bi-report-in-ax-form-1024x586.png)](./media/ger-power-bi-review-bi-report-in-ax-form.png)</span><span class="sxs-lookup"><span data-stu-id="0028a-244">[![Import and export details report](./media/ger-power-bi-review-bi-report-in-ax-form-1024x586.png)](./media/ger-power-bi-review-bi-report-in-ax-form.png)</span></span>

## <a name="additional-resources"></a><span data-ttu-id="0028a-245">Lisäresurssit</span><span class="sxs-lookup"><span data-stu-id="0028a-245">Additional resources</span></span>

[<span data-ttu-id="0028a-246">Sähköisen raportoinnin (ER) kohteet</span><span class="sxs-lookup"><span data-stu-id="0028a-246">Electronic reporting (ER) destinations</span></span>](electronic-reporting-destinations.md)

[<span data-ttu-id="0028a-247">Sähköisen raportoinnin (ER) yleiskatsaus</span><span class="sxs-lookup"><span data-stu-id="0028a-247">Electronic reporting (ER) overview</span></span>](general-electronic-reporting.md)
