---
title: Sähköisen raportoinnin (ER) kaavojen suunnittelutoiminto
description: Tässä ohjeaiheessa on tietoja siitä, miten käyttää kaavasuunnittelijaa sähköisessä raportoinnissa (ER).
author: NickSelin
manager: kfend
ms.date: 12/05/2019
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
ms.search.form: ERDataModelDesigner, ERExpressionDesignerFormula, ERMappedFormatDesigner, ERModelMappingDesigner
audience: Application User, IT Pro
ms.reviewer: kfend
ms.custom: 58771
ms.assetid: 24223e13-727a-4be6-a22d-4d427f504ac9
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: d96fe041fd0ffb292909c1e724068efebe0184b9
ms.sourcegitcommit: 659375c4cc7f5524cbf91cf6160f6a410960ac16
ms.translationtype: HT
ms.contentlocale: fi-FI
ms.lasthandoff: 12/05/2020
ms.locfileid: "4682646"
---
# <a name="formula-designer-in-electronic-reporting-er"></a><span data-ttu-id="8919a-103">Sähköisen raportoinnin (ER) kaavojen suunnittelutoiminto</span><span class="sxs-lookup"><span data-stu-id="8919a-103">Formula designer in Electronic reporting (ER)</span></span>

[!include [banner](../includes/banner.md)]

<span data-ttu-id="8919a-104">Tässä aiheessa kerrotaan, miten kaavojen suunnittelutoimintoa käytetään sähköisessä raportoinnissa (ER).</span><span class="sxs-lookup"><span data-stu-id="8919a-104">This topic explains how to use the formula designer in Electronic reporting (ER).</span></span> <span data-ttu-id="8919a-105">Kun tietyn sähköisen asiakirjan muotoa suunnitellaan ER:ssä, voit muuntaa tiedot kaavojen avulla vastaamaan asiakirjan toteuttamis- ja muotoiluvaatimuksia.</span><span class="sxs-lookup"><span data-stu-id="8919a-105">When you design a format for a specific electronic document in ER, you can use formulas to transform data so that it meets the requirements for the document's fulfillment and formatting.</span></span> <span data-ttu-id="8919a-106">Nämä kaavat muistuttavat Microsoft Excelin kaavoja.</span><span class="sxs-lookup"><span data-stu-id="8919a-106">These formulas resemble formulas in Microsoft Excel.</span></span> <span data-ttu-id="8919a-107">Kaavoissa tuetaan erilaisia toimintoja: teksti, päivämäärä ja aika, matemaattiset ja loogiset funktiot, tiedot ja tietotyyppien muunnostoiminnot ja myös muut liiketoiminnan toimialuekohtaiset toiminnot.</span><span class="sxs-lookup"><span data-stu-id="8919a-107">Various types of functions are supported in the formulas: text, date and time, mathematical, logical, information, and data type conversion functions, and also other, business domain–specific functions.</span></span>

## <a name="formula-designer-overview"></a><span data-ttu-id="8919a-108">Yleiskatsaus kaavan suunnittelutoimintoon</span><span class="sxs-lookup"><span data-stu-id="8919a-108">Formula designer overview</span></span>

<span data-ttu-id="8919a-109">Sähköinen raportointi tukee kaavojen suunnittelutoimintoa.</span><span class="sxs-lookup"><span data-stu-id="8919a-109">ER supports the formula designer.</span></span> <span data-ttu-id="8919a-110">Tämän vuoksi voit määrittää suunnittelun yhteydessä lausekkeita, joita voidaan käyttää suorituksen aikana seuraavissa tehtävissä:</span><span class="sxs-lookup"><span data-stu-id="8919a-110">Therefore, at design time, you can configure expressions that can be used for the following tasks at runtime:</span></span>

- <span data-ttu-id="8919a-111">Sovelluksen tietokannasta vastaanotettujen tietojen muuntaminen. Tiedot täytetään ER-tietomalliin, joka on suunniteltu ER-muotojen (kuten suodatus, ryhmittely ja tietotyypin muunnos) tietolähteeksi.</span><span class="sxs-lookup"><span data-stu-id="8919a-111">Transform data that is received from an application database and that should be entered in an ER data model that is designed to be a data source for ER formats.</span></span> <span data-ttu-id="8919a-112">(Näitä muunnoksia ovat esimerkiksi suodatus, ryhmitys ja tietotyypin muunto.)</span><span class="sxs-lookup"><span data-stu-id="8919a-112">(For example, these transformations might include filtering, grouping, and data type conversion.)</span></span>
- <span data-ttu-id="8919a-113">Muodostettavaan sähköiseen asiakirjaan lähetettävien tietojen muotoilu tietyn ER-muodon asettelun ja ehtojen mukaisesti.</span><span class="sxs-lookup"><span data-stu-id="8919a-113">Format data that must be sent to a generating electronic document in accordance with the layout and conditions of a specific ER format.</span></span> <span data-ttu-id="8919a-114">(Muotoilu voidaan tehdä esimerkiksi pyydetyn kielen tai kulttuurin tai koodauksen mukaisesti.)</span><span class="sxs-lookup"><span data-stu-id="8919a-114">(For example, the formatting might be done in accordance with the requested language or culture, or the encoding).</span></span>
- <span data-ttu-id="8919a-115">Sähköisten asiakirjojen luontiprosessin hallinta.</span><span class="sxs-lookup"><span data-stu-id="8919a-115">Control the process of creating electronic documents.</span></span> <span data-ttu-id="8919a-116">(Lausekkeet voivat esimerkiksi ottaa käyttöön muodon tiettyjen elementtien tuottamisen tai poistaa sen käytöstä käsiteltävien tietojen mukaan.</span><span class="sxs-lookup"><span data-stu-id="8919a-116">(For example, the expressions can enable or disable the output of specific elements of the format, depending on processing data.</span></span> <span data-ttu-id="8919a-117">Ne voivat myös keskeyttää asiakirjan luontiprosessin tai näyttää sanomia käyttäjille.)</span><span class="sxs-lookup"><span data-stu-id="8919a-117">They can also interrupt the document creation process or throw messages to users.)</span></span>

<span data-ttu-id="8919a-118">Voit avata **Kaavojen suunnittelutoiminto** -sivun, kun teet jonkin seuraavista toiminnoista:</span><span class="sxs-lookup"><span data-stu-id="8919a-118">You can open the **Formula designer** page when you perform any of the following actions:</span></span>

- <span data-ttu-id="8919a-119">Tietolähteen nimikkeiden sidonta tietomallin komponentteihin</span><span class="sxs-lookup"><span data-stu-id="8919a-119">Bind data source items to data model components.</span></span>
- <span data-ttu-id="8919a-120">Tietolähteen nimikkeiden sidonta muotokomponentteihin</span><span class="sxs-lookup"><span data-stu-id="8919a-120">Bind data source items to format components.</span></span>
- <span data-ttu-id="8919a-121">Laskettujen kenttien täydellinen ylläpito tietolähteiden osana</span><span class="sxs-lookup"><span data-stu-id="8919a-121">Complete maintenance of calculated fields that are part of data sources.</span></span>
- <span data-ttu-id="8919a-122">Käyttäjän syöttöparametrien näkyvyyden ehtojen määritys</span><span class="sxs-lookup"><span data-stu-id="8919a-122">Define the visibility conditions for user input parameters.</span></span>
- <span data-ttu-id="8919a-123">Muodon muunnosten rakenne</span><span class="sxs-lookup"><span data-stu-id="8919a-123">Design a format's transformations.</span></span>
- <span data-ttu-id="8919a-124">Muotokomponenttien ehtojen käyttöönottamisen määritys</span><span class="sxs-lookup"><span data-stu-id="8919a-124">Define the enabling conditions for the format's components.</span></span>
- <span data-ttu-id="8919a-125">Muodon tiedostokomponenttien tiedostonimien määritys</span><span class="sxs-lookup"><span data-stu-id="8919a-125">Define the file names for the format's FILE components.</span></span>
- <span data-ttu-id="8919a-126">Prosessin hallinnan tarkistusten ehtojen määritys</span><span class="sxs-lookup"><span data-stu-id="8919a-126">Define the conditions for process control validations.</span></span>
- <span data-ttu-id="8919a-127">Prosessin hallinnan tarkistusten sanoman tekstin määritys</span><span class="sxs-lookup"><span data-stu-id="8919a-127">Define the message text for process control validations.</span></span>

## <a name="data-binding"></a><a name="Binding"></a><span data-ttu-id="8919a-128">Tietojen sidonta</span><span class="sxs-lookup"><span data-stu-id="8919a-128">Data binding</span></span>

<span data-ttu-id="8919a-129">ER-kaavojen suunnittelutoiminnon avulla voi määrittää lausekkeen, joka muuntaa tietolähteistä vastaanotetut tiedot niin, että tiedot voidaan täyttää tietojen käyttäjään seuraavalla tavalla suorituksen aikana:</span><span class="sxs-lookup"><span data-stu-id="8919a-129">The ER formula designer can be used to define an expression that transforms data that is received from data sources, so that the data can be entered in the data consumer in the following ways at runtime:</span></span>

- <span data-ttu-id="8919a-130">Sovelluksen tietolähteistä ja suorituksen aikaisista parametreista ER-tietomalliin</span><span class="sxs-lookup"><span data-stu-id="8919a-130">From application data sources and runtime parameters to an ER data model</span></span>
- <span data-ttu-id="8919a-131">ER-tietomallista ER-muotoon</span><span class="sxs-lookup"><span data-stu-id="8919a-131">From an ER data model to an ER format</span></span>
- <span data-ttu-id="8919a-132">Sovelluksen tietolähteistä ja suorituksen aikaisista parametreista ER-muotoon</span><span class="sxs-lookup"><span data-stu-id="8919a-132">From application data sources and runtime parameters to an ER format</span></span>

<span data-ttu-id="8919a-133">Seuraavassa kuvassa esitellään tämäntyyppisen lausekkeen rakenne.</span><span class="sxs-lookup"><span data-stu-id="8919a-133">The following illustration shows the design of an expression of this type.</span></span> <span data-ttu-id="8919a-134">Tässä esimerkissä lauseke pyöristää **Intrastat.AmountMST**-kentän arvon Intrastat-taulussa kahteen desimaaliin ja palauttaa sitten pyöristetyn arvon.</span><span class="sxs-lookup"><span data-stu-id="8919a-134">In this example, the expression rounds the value of the **Intrastat.AmountMST** field in the Intrastat table to two decimal places and then returns the rounded value.</span></span>

<span data-ttu-id="8919a-135">[![Tietoja sitova lauseke](./media/picture-expression-binding.jpg)](./media/picture-expression-binding.jpg)</span><span class="sxs-lookup"><span data-stu-id="8919a-135">[![Data binding expression](./media/picture-expression-binding.jpg)](./media/picture-expression-binding.jpg)</span></span>

<span data-ttu-id="8919a-136">Seuraavassa kuvassa esitellään, miten tämän tyyppistä lauseketta voidaan käyttää.</span><span class="sxs-lookup"><span data-stu-id="8919a-136">The following illustration shows how an expression of this type can be used.</span></span> <span data-ttu-id="8919a-137">Tässä esimerkissä suunnitellun lausekkeen tulos täytetään **Veroraportointimalli**-tietomallin **Transaction.InvoicedAmount**-komponentilla.</span><span class="sxs-lookup"><span data-stu-id="8919a-137">In this example, the result of the designed expression is entered in the **Transaction.InvoicedAmount** component of the **Tax reporting model** data model.</span></span>

<span data-ttu-id="8919a-138">[![Tietojen sitovaa lauseketta käytetään](./media/picture-expression-binding2.jpg)](./media/picture-expression-binding2.jpg)</span><span class="sxs-lookup"><span data-stu-id="8919a-138">[![Data binding expression being used](./media/picture-expression-binding2.jpg)](./media/picture-expression-binding2.jpg)</span></span>

<span data-ttu-id="8919a-139">Suorituksen aikana suunniteltu kaava, `ROUND (Intrastat.AmountMST, 2)` pyöristää kunkin Intrasat-taulun tietueen **AmountMST**-kentän arvon kahteen desimaaliin.</span><span class="sxs-lookup"><span data-stu-id="8919a-139">At runtime, the designed formula, `ROUND (Intrastat.AmountMST, 2)`, rounds the value of the **AmountMST** field for each record in the Intrastat table to two decimal places.</span></span> <span data-ttu-id="8919a-140">Sen jälkeen pyöristetty arvo annetaan **Veroilmoitus**-tietomallin **Transaction.InvoicedAmount**-komponentissa.</span><span class="sxs-lookup"><span data-stu-id="8919a-140">It then enters the rounded value in the **Transaction.InvoicedAmount** component of the **Tax reporting** data model.</span></span>

## <a name="data-formatting"></a><a name="Transformation"></a><span data-ttu-id="8919a-141">Tietojen muotoilu</span><span class="sxs-lookup"><span data-stu-id="8919a-141">Data formatting</span></span>

<span data-ttu-id="8919a-142">ER-kaavojen suunnittelutoiminnon avulla voi määrittää lausekkeen, joka muotoilee tietolähteistä vastaanotetut tiedot niin, että tiedot voidaan lähettää sähköisen asiakirjan luonnin osana.</span><span class="sxs-lookup"><span data-stu-id="8919a-142">The ER formula designer can be used to define an expression that formats data that is received from data sources, so that the data can be sent as part of the generating electronic document.</span></span> <span data-ttu-id="8919a-143">Käytössä voi olla muotoilu, jota on käytettävä tyypillisenä muotoiluna ja jota on käytettävä kaavassa uudelleen.</span><span class="sxs-lookup"><span data-stu-id="8919a-143">You might have formatting that must be applied as a typical rule that should be reused for a format.</span></span> <span data-ttu-id="8919a-144">Siinä tapauksessa voit käyttää kyseistä muotoilua kerran muodon määrityksessä nimettynä muunnoksena, jolla on muotoilulauseke.</span><span class="sxs-lookup"><span data-stu-id="8919a-144">In this case, you can introduce that formatting one time in the format configuration, as a named transformation that has a formatting expression.</span></span> <span data-ttu-id="8919a-145">Tämän jälkeen nimetty muunnos voidaan linkittää useisiin muotokomponentteihin, joiden tulosten on oltava luodun muotoilulausekkeen mukaisesti muotoiltuja.</span><span class="sxs-lookup"><span data-stu-id="8919a-145">This named transformation can then be linked to many format components where the output must be formatted according to the formatting expression that you created.</span></span>

<span data-ttu-id="8919a-146">Seuraavassa kuvassa esitellään tämäntyyppisen muotoilun rakenne.</span><span class="sxs-lookup"><span data-stu-id="8919a-146">The following illustration shows the design of a transformation of this type.</span></span> <span data-ttu-id="8919a-147">Tässä esimerkissä **TrimmedString**-muunnos lyhentää *Merkkijono*-tyyppiset tiedot ja poistamalla ylimääräiset välilyönnit alusta ja lopusta.</span><span class="sxs-lookup"><span data-stu-id="8919a-147">In this example, the **TrimmedString** transformation truncates incoming data of the *String* data type by removing leading and trailing spaces.</span></span> <span data-ttu-id="8919a-148">Se palauttaa sitten lyhennetyn merkkijonon arvon.</span><span class="sxs-lookup"><span data-stu-id="8919a-148">It then returns the truncated string value.</span></span>

<span data-ttu-id="8919a-149">[![Muunnos](./media/picture-transformation-design.jpg)](./media/picture-transformation-design.jpg)</span><span class="sxs-lookup"><span data-stu-id="8919a-149">[![Transformation](./media/picture-transformation-design.jpg)](./media/picture-transformation-design.jpg)</span></span>

<span data-ttu-id="8919a-150">Seuraavassa kuvassa esitellään, miten tämäntyyppistä muunnosta voidaan käyttää.</span><span class="sxs-lookup"><span data-stu-id="8919a-150">The following illustration shows how a transformation of this type can be used.</span></span> <span data-ttu-id="8919a-151">Tässä esimerkissä useat muotokomponentit lähettävä tekstin tuloksena suorituksen aikana muodostettavaan sähköiseen asiakirjaan.</span><span class="sxs-lookup"><span data-stu-id="8919a-151">In this example, several format components send text as output to the generating electronic document at runtime.</span></span> <span data-ttu-id="8919a-152">Kaikki nämä muotokomponentit viittaavat **TrimmedString**-muunnokseen nimellä.</span><span class="sxs-lookup"><span data-stu-id="8919a-152">All these format components refer to the **TrimmedString** transformation by name.</span></span>

<span data-ttu-id="8919a-153">[![Käytettävä muunnos](./media/picture-transformation-usage.jpg)](./media/picture-transformation-usage.jpg)</span><span class="sxs-lookup"><span data-stu-id="8919a-153">[![Transformation being used](./media/picture-transformation-usage.jpg)](./media/picture-transformation-usage.jpg)</span></span>

<span data-ttu-id="8919a-154">Kun muodon komponentit, kuten edellisen kuvan **partyName**-komponentti viittaavat **TrimmedString**-muunnokseen, muunnos lähettää tekstin tuotoksena muodostettava sähköiseen asiakirjaan.</span><span class="sxs-lookup"><span data-stu-id="8919a-154">When format components, such as the **partyName** component in the preceding illustration, refer to the **TrimmedString** transformation, the transformation sends text as output to the generating electronic document.</span></span> <span data-ttu-id="8919a-155">Tämä teksti ei sisällä edeltäviä eikä lopussa olevia välilyöntejä.</span><span class="sxs-lookup"><span data-stu-id="8919a-155">This text doesn't include leading and trailing spaces.</span></span>

<span data-ttu-id="8919a-156">Jos sinulla on muotoiluja, joita tulee kohdistaa yksitellen, voit käyttää muotoilua tietyn muotokomponentin sidonnan yksittäisenä lausekkeena.</span><span class="sxs-lookup"><span data-stu-id="8919a-156">If you have formatting that must be applied individually, you can introduce that formatting as an individual expression of a binding of a specific format component.</span></span> <span data-ttu-id="8919a-157">Seuraavassa kuvassa esitellään tämäntyyppinen lauseke.</span><span class="sxs-lookup"><span data-stu-id="8919a-157">The following illustration shows an expression of this type.</span></span> <span data-ttu-id="8919a-158">Tässä esimerkissä **partyType**-muotokomponentti on sidottu tietolähteeseen sen lausekkeen kautta, joka muuntaa saapuvat tiedot tietolähteen **Model.Company.RegistrationType**-kentästä isoilla kirjaimilla kirjoitetuksi tekstiksi.</span><span class="sxs-lookup"><span data-stu-id="8919a-158">In this example, the **partyType** format component is bound to the data source via an expression that converts incoming data from the **Model.Company.RegistrationType** field in the data source to uppercase text.</span></span> <span data-ttu-id="8919a-159">Lauseke lähettää sitten tekstin tuloksena sähköiseen asiakirjaan.</span><span class="sxs-lookup"><span data-stu-id="8919a-159">The expression then sends that text as output to the electronic document.</span></span>

<span data-ttu-id="8919a-160">[![Muotoilun käyttö yksittäisessä asiakirjassa](./media/picture-binding-with-formula.jpg)](./media/picture-binding-with-formula.jpg)</span><span class="sxs-lookup"><span data-stu-id="8919a-160">[![Applying formatting to an individual component](./media/picture-binding-with-formula.jpg)](./media/picture-binding-with-formula.jpg)</span></span>

## <a name="process-flow-control"></a><a name="Validation"></a><span data-ttu-id="8919a-161">Prosessinkulun hallinta</span><span class="sxs-lookup"><span data-stu-id="8919a-161">Process flow control</span></span>

<span data-ttu-id="8919a-162">ER-kaavojen suunnittelutoimintoa voidaan käyttää määritettäessä lausekkeita, joilla hallitaan muodostettavien sähköisten asiakirjojen prosessinkulkua.</span><span class="sxs-lookup"><span data-stu-id="8919a-162">The ER formula designer can be used to define expressions that control the process flow of generating electronic documents.</span></span> <span data-ttu-id="8919a-163">Voit suorittaa seuraavat tehtävät:</span><span class="sxs-lookup"><span data-stu-id="8919a-163">You can perform the following tasks:</span></span>

- <span data-ttu-id="8919a-164">Määritä ehdot, jotka määrittävät, milloin asiakirjan luontiprosessi on pysäytettävä.</span><span class="sxs-lookup"><span data-stu-id="8919a-164">Define conditions that determine when a document creation process must be stopped.</span></span>
- <span data-ttu-id="8919a-165">Määritä lausekkeet, jotka luovat käyttäjälle sanomia pysäytetyistä prosesseista tai näyttävät suorituslokin sanomia raportin luontiprosessin jatkamisesta.</span><span class="sxs-lookup"><span data-stu-id="8919a-165">Specify expressions that either create messages for the user about stopped processes or throw execution log messages about the continuing process of report generation.</span></span>
- <span data-ttu-id="8919a-166">Määritä sähköisten asiakirjojen luonnin tiedostonimet ja ohjaa niiden luontiehtoja.</span><span class="sxs-lookup"><span data-stu-id="8919a-166">Specify the file names of generating electronic documents, and control the conditions of their creation.</span></span>

<span data-ttu-id="8919a-167">Jokainen prosessinkulun hallinnan sääntö suunnitellaan yksittäiseksi tarkistukseksi.</span><span class="sxs-lookup"><span data-stu-id="8919a-167">Each rule of the process flow control is designed as an individual validation.</span></span> <span data-ttu-id="8919a-168">Seuraavassa kuvassa esitellään tämäntyyppinen tarkistus.</span><span class="sxs-lookup"><span data-stu-id="8919a-168">The following illustration shows a validation of this type.</span></span> <span data-ttu-id="8919a-169">Tässä on kyseisen esimerkin konfiguraation selitys:</span><span class="sxs-lookup"><span data-stu-id="8919a-169">Here is an explanation of the configuration in this example:</span></span>

- <span data-ttu-id="8919a-170">Tarkistus arvioidaan, kun **INSTAT**-solmu luodaan XML-tiedoston muodostuksen yhteydessä.</span><span class="sxs-lookup"><span data-stu-id="8919a-170">The validation is evaluated when the **INSTAT** node is created during generation of the XML file.</span></span>
- <span data-ttu-id="8919a-171">Jos tapahtumaluettelo on tyhjä, tarkistus pysäyttää suoritusprosessin ja palauttaa **EPÄTOSI**-arvon.</span><span class="sxs-lookup"><span data-stu-id="8919a-171">If the list of transactions is empty, the validation stops the execution process and returns **FALSE**.</span></span>
- <span data-ttu-id="8919a-172">Tarkistus palauttaa virhesanoman otsikolla SYS70894 käyttäjän ensisijaisella kielellä.</span><span class="sxs-lookup"><span data-stu-id="8919a-172">The validation returns an error message that includes the text of label SYS70894 in the user's preferred language.</span></span>

<span data-ttu-id="8919a-173">[![Valintasäännöt](./media/picture-validation.jpg)](./media/picture-validation.jpg)</span><span class="sxs-lookup"><span data-stu-id="8919a-173">[![Validation](./media/picture-validation.jpg)](./media/picture-validation.jpg)</span></span>

<span data-ttu-id="8919a-174">ER-kaavan luontitoimintoa voidaan käyttää myös sähköisen asiakirjan luonnin tiedostonimen muodostamisessa ja tiedoston luontiprosessin hallinnassa.</span><span class="sxs-lookup"><span data-stu-id="8919a-174">The ER formula designer can also be used to generate a file name for a generating electronic document and to control the file creation process.</span></span> <span data-ttu-id="8919a-175">Seuraavassa kuvassa esitellään tämäntyyppisen prosessikulun hallinnan rakenne.</span><span class="sxs-lookup"><span data-stu-id="8919a-175">The following illustration shows the design of a process flow control of this type.</span></span> <span data-ttu-id="8919a-176">Tässä on kyseisen esimerkin konfiguraation selitys:</span><span class="sxs-lookup"><span data-stu-id="8919a-176">Here is an explanation of the configuration in this example:</span></span>

- <span data-ttu-id="8919a-177">Luettelo **model.Intrastat**-tietolähteen tietueista on jaettu eriin.</span><span class="sxs-lookup"><span data-stu-id="8919a-177">The list of records from the **model.Intrastat** data source is divided into batches.</span></span> <span data-ttu-id="8919a-178">Kussakin erässä on enintään 1 000 tietuetta.</span><span class="sxs-lookup"><span data-stu-id="8919a-178">Each batch contains up to 1,000 records.</span></span>
- <span data-ttu-id="8919a-179">Tulos luo zip-tiedoston, joka sisältää yhden XML-muodossa olevan tiedoston jokaisessa luodussa erässä.</span><span class="sxs-lookup"><span data-stu-id="8919a-179">The output creates a zip file that contains one file in XML format for every batch that was created.</span></span>
- <span data-ttu-id="8919a-180">Lauseke palauttaa sähköisen asiakirjan luomiselle tiedostonimen liittämällä tiedostonimen ja tiedostonimen tunnisteen.</span><span class="sxs-lookup"><span data-stu-id="8919a-180">An expression returns a file name for generating electronic documents by concatenating the file name and the file name extension.</span></span> <span data-ttu-id="8919a-181">Toisen erän ja seuraavien erien tiedostonimi sisältää erän tunnuksen loppuliitteenä.</span><span class="sxs-lookup"><span data-stu-id="8919a-181">For the second batch and all subsequent batches, the file name contains the batch ID as a suffix.</span></span>
- <span data-ttu-id="8919a-182">Lauseke ottaa käyttöön (palauttamalla **TOSI**-arvon) vähintään yhden tietueen sisältävien erien tiedoston luontiprosessin.</span><span class="sxs-lookup"><span data-stu-id="8919a-182">An expression enables (by returning **TRUE**) the file creation process for batches that contain at least one record.</span></span>

<span data-ttu-id="8919a-183">[![Prosessinkulun hallinta](./media/picture-file-control.jpg)](./media/picture-file-control.jpg)</span><span class="sxs-lookup"><span data-stu-id="8919a-183">[![Process flow control](./media/picture-file-control.jpg)](./media/picture-file-control.jpg)</span></span>

## <a name="document-content-control"></a><a name="Enabled"></a><span data-ttu-id="8919a-184">Asiakirjan sisältöohjausobjekti</span><span class="sxs-lookup"><span data-stu-id="8919a-184">Document content control</span></span>

<span data-ttu-id="8919a-185">ER-kaavan suunnittelun avulla voidaan määrittää lausekkeita, jotka ohjaavat, mitä tietoja sijoitetaan luotuihin sähköisiin tiedostoihin suorituksen aikana.</span><span class="sxs-lookup"><span data-stu-id="8919a-185">The ER formula designer can be used to configure expressions that control what data will be put into generated electronic documents at runtime.</span></span> <span data-ttu-id="8919a-186">Lausekkeet voivat ottaa käyttöön muodon tiettyjen elementtien tuottamisen tai poistaa sen käytöstä käsiteltävien tietojen ja määritetyn logiikan mukaan.</span><span class="sxs-lookup"><span data-stu-id="8919a-186">The expressions can enable or disable the output of specific elements of the format, depending on processing data and configured logic.</span></span> <span data-ttu-id="8919a-187">Nämä lausekkeet voidaan määrittää yksittäiselle muotoelementille **Toimintojen suunnitteluohjelma** -sivun **Yhdistämismääritykset**-välilehden **Käytössä**-kentässä.</span><span class="sxs-lookup"><span data-stu-id="8919a-187">These expressions can be entered for a single format element in the **Enabled** field on the **Mapping** tab of the **Operations designer** page.</span></span> <span data-ttu-id="8919a-188">Voit kirjoittaa lausekkeet loogiseksi ehdoksi, joka palauttaa *totuusarvon*:</span><span class="sxs-lookup"><span data-stu-id="8919a-188">You can enter the expressions as a logic condition that returns a *Boolean* value:</span></span>

- <span data-ttu-id="8919a-189">Jos ehto palauttaa arvon **Tosi**, nykyinen muotoelementti suoritetaan.</span><span class="sxs-lookup"><span data-stu-id="8919a-189">If the condition returns **True**, the current format element is run.</span></span>
- <span data-ttu-id="8919a-190">Jos ehto palauttaa arvon **Epätosi**, nykyinen muotoelementti ohitetaan.</span><span class="sxs-lookup"><span data-stu-id="8919a-190">If the condition returns **False**, the current format element is skipped.</span></span>

<span data-ttu-id="8919a-191">Seuraavassa kuvassa esitellään tämäntyyppisiä lausekkeita.</span><span class="sxs-lookup"><span data-stu-id="8919a-191">The following illustration shows expressions of this type.</span></span> <span data-ttu-id="8919a-192">(Esimerkkinä käytetään Microsoftin tarjoamaa **ISO20022-siirto (NO)** -muodon kokoonpanon versiota 11.12.11.) **XMLHeader**-muotokomponentti on konfiguroitu kuvaamaan tilisiirtosanoman rakenne ISO 20022 XML -viestistandardien mukaisesti.</span><span class="sxs-lookup"><span data-stu-id="8919a-192">(Version 11.12.11 of the **ISO20022 Credit transfer (NO)** format configuration that is provided by Microsoft is used as an example.) The **XMLHeader** format component is configured to describe the structure of the credit transfer message according to the ISO 20022 XML message standards.</span></span> <span data-ttu-id="8919a-193">**XMLHeader/Document/CstmrCdtTrfInitn/PmtInf/CdtTrfTxInf/RmtInf/Ustrd** -muotokomponentti on määritetty lisäämään luotuun viestiin **Ustrd** XML-elementin ja sijoittamaan maksusuoritustiedot ei-rakenteellisessa muodossa tekstinä seuraaviin XML-elementteihin:</span><span class="sxs-lookup"><span data-stu-id="8919a-193">The **XMLHeader/Document/CstmrCdtTrfInitn/PmtInf/CdtTrfTxInf/RmtInf/Ustrd** format component is configured to add the **Ustrd** XML element to the generated message and to put the remittance information in an unstructured format as text of the following XML elements:</span></span>

- <span data-ttu-id="8919a-194">**PaymentNotes**-komponenttia käytetään maksuhuomautusten tekstin luomiseen.</span><span class="sxs-lookup"><span data-stu-id="8919a-194">The **PaymentNotes** component is used to generate the text of payment notes.</span></span>
- <span data-ttu-id="8919a-195">**DelimitedSequence**-komponentti luo pilkuilla erotetut laskunumerot, joita käytetään nykyisen luottosiirron tilittämiseen.</span><span class="sxs-lookup"><span data-stu-id="8919a-195">The **DelimitedSequence** component generates comma-separated invoice numbers that are used to settle the current credit transfer.</span></span>

<span data-ttu-id="8919a-196">[![PaymentNotes ja DelimitedSequence -osat](./media/GER-FormulaEditor-ControlContent-1.png)](./media/GER-FormulaEditor-ControlContent-1.png)</span><span class="sxs-lookup"><span data-stu-id="8919a-196">[![PaymentNotes and DelimitedSequence components](./media/GER-FormulaEditor-ControlContent-1.png)](./media/GER-FormulaEditor-ControlContent-1.png)</span></span>

> [!NOTE]
> <span data-ttu-id="8919a-197">**PaymentNotes**- ja **DelimitedSequence** -komponentit merkitään kysymysmerkillä.</span><span class="sxs-lookup"><span data-stu-id="8919a-197">The **PaymentNotes** and **DelimitedSequence** components are labeled by using a question mark.</span></span> <span data-ttu-id="8919a-198">Kysymysmerkki osoittaa, että komponentin käyttö on ehdollinen.</span><span class="sxs-lookup"><span data-stu-id="8919a-198">A question mark indicates that the use of a component is conditional.</span></span> <span data-ttu-id="8919a-199">Tässä tapauksessa komponenttien käyttö perustuu seuraaviin kriteereihin:</span><span class="sxs-lookup"><span data-stu-id="8919a-199">In this case, use of the components is based on the following criteria:</span></span>
>
> - <span data-ttu-id="8919a-200">`@.PaymentsNotes <> ""`-lauseke, joka on määritetty **PaymentsNotes**-komponentille mahdollistaa (palauttamalla **TOSI**) **Ustrd**-XML-elementin täyttämisen maksuhuomautusten tekstillä, jos nykyisen luottosiirron teksti ei ole tyhjä.</span><span class="sxs-lookup"><span data-stu-id="8919a-200">The `@.PaymentsNotes <> ""` expression that is defined for the **PaymentNotes** component enables (by returning **TRUE**) the **Ustrd** XML element to be filled with the text of payment notes, if that text isn't blank for the current credit transfer.</span></span>
>
>    <span data-ttu-id="8919a-201">[![PaymentNotes-komponentin lauseke](./media/GER-FormulaEditor-ControlContent-2.png)](./media/GER-FormulaEditor-ControlContent-2.png)</span><span class="sxs-lookup"><span data-stu-id="8919a-201">[![Expression for the PaymentNotes component](./media/GER-FormulaEditor-ControlContent-2.png)](./media/GER-FormulaEditor-ControlContent-2.png)</span></span>
>
> - <span data-ttu-id="8919a-202">**DelimitedSequence**-komponentille määritetty `@.PaymentsNotes = ""`-lauseke mahdollistaa (palauttamalla **TOSI**) **Ustrd**-XML-elementin täyttämisen pilkulla erotetuilla laskunumeroilla, joita käytetään nykyisen luottosiirron tilittämiseen, jos maksuhuomautusten teksti tälle luottosiirrolle on tyhjä.</span><span class="sxs-lookup"><span data-stu-id="8919a-202">The `@.PaymentsNotes = ""` expression that is defined for the **DelimitedSequence** component enables (by returning **TRUE**) the **Ustrd** XML element to be filled with a comma-separated list of the invoice numbers that are used to settle the current credit transfer, if the text of payment notes for that credit transfer is blank.</span></span>
>
>    <span data-ttu-id="8919a-203">[![DelimitedSequence-komponentin lauseke](./media/GER-FormulaEditor-ControlContent-3.png)](./media/GER-FormulaEditor-ControlContent-3.png)</span><span class="sxs-lookup"><span data-stu-id="8919a-203">[![Expression for the DelimitedSequence component](./media/GER-FormulaEditor-ControlContent-3.png)](./media/GER-FormulaEditor-ControlContent-3.png)</span></span>
> 
> <span data-ttu-id="8919a-204">Tämän asetuksen perusteella kullekin velallisen maksulle luotu **Ustrd**-XML-elementti sisältää joko maksuhuomautusten tekstin tai, kun teksti on tyhjä, tämän maksun tilittämiseen käytetyt pilkulla erotetut laskunumerot.</span><span class="sxs-lookup"><span data-stu-id="8919a-204">Based on this setup, the message that is generated for each debtor payment, the **Ustrd** XML element, will contain either the text of payment notes or, when that text is blank, a comma-separated list of the invoice numbers that are used to settle the payment.</span></span>

## <a name="validation-of-configured-formulas"></a><a name="TestFormula"></a><span data-ttu-id="8919a-205">Määritettyjen kaavojen oikeellisuustarkistus</span><span class="sxs-lookup"><span data-stu-id="8919a-205">Validation of configured formulas</span></span>

<span data-ttu-id="8919a-206">Valitse **Kaavansuunnittelija**-sivulla **Testaa** vahvistaaksesi, miten määritetty kaava toimii.</span><span class="sxs-lookup"><span data-stu-id="8919a-206">On the **Formula designer** page, select **Test** to validate how the configured formula works.</span></span>

<span data-ttu-id="8919a-207">[![Testin valitseminen kaavan tarkistamiseksi](./media/ER-FormulaTest-Start.png)](./media/ER-FormulaTest-Start.png)</span><span class="sxs-lookup"><span data-stu-id="8919a-207">[![Selecting Test to validate a forumula](./media/ER-FormulaTest-Start.png)](./media/ER-FormulaTest-Start.png)</span></span>

<span data-ttu-id="8919a-208">Kun kaavan argumenttien arvot ovat pakollisia, voit avata **Testaa lauseke** -valintaikkunan **Kaavan suunnittelu** -sivulta.</span><span class="sxs-lookup"><span data-stu-id="8919a-208">When the values of formula arguments are required, you can open the **Test expression** dialog box from the **Formula designer** page.</span></span> <span data-ttu-id="8919a-209">Useimmissa tapauksissa nämä argumentit on määritettävä manuaalisesti, koska määritettyjä sidoksia ei suoriteta suunnittelun aikana.</span><span class="sxs-lookup"><span data-stu-id="8919a-209">In most cases, these arguments must be manually defined, because the configured bindings aren't run at design time.</span></span> <span data-ttu-id="8919a-210">**Kaavansuunnittelija**- sivun **Testi tulos**-välilehdellä näkyy määritetyn kaavan suorituksen tulos.</span><span class="sxs-lookup"><span data-stu-id="8919a-210">The **Test result** tab on the **Formula designer** page shows the result from execution of the configured formula.</span></span>

<span data-ttu-id="8919a-211">Seuraava esimerkki osoittaa, miten voit testata ulkomaankaupan toimialueelle määritetyn kaavan ja varmistaa, että Intrastat-kauppatavarakoodi sisältää vain numeroita.</span><span class="sxs-lookup"><span data-stu-id="8919a-211">The following example shows how you can test the formula that is configured for the foreign trade domain to make sure that the Intrastat commodity code contains only digits.</span></span>

<span data-ttu-id="8919a-212">Kun testaat tätä kaavaa, voit käyttää **Testaa lauseke** -valintaikkunaa määrittämään Intrastat-kauppatavarakoodin arvon testausta varten.</span><span class="sxs-lookup"><span data-stu-id="8919a-212">When you test this formula, you can use the **Test expression** dialog box to specify the value of the Intrastat commodity code for testing.</span></span>

<span data-ttu-id="8919a-213">[![Intrastat-kauppatavarakoodin määrittäminen testausta varten](./media/ER-FormulaTest-Start-EnterArguments.png)](./media/ER-FormulaTest-Start-EnterArguments.png)</span><span class="sxs-lookup"><span data-stu-id="8919a-213">[![Specifying the Intrastat commodity code for testing](./media/ER-FormulaTest-Start-EnterArguments.png)](./media/ER-FormulaTest-Start-EnterArguments.png)</span></span>

<span data-ttu-id="8919a-214">Kun olet määrittänyt Intrastat-kauppatavarakoodin ja valinnut **OK**, **Kaavan suunnittelija** -sivun **testitulos** -välilehdessä näkyy määritetyn kaavan suorituksen tulos.</span><span class="sxs-lookup"><span data-stu-id="8919a-214">After you specify the Intrastat commodity code and select **OK**, the **Test result** tab on the **Formula designer** page shows the result of execution of the configured formula.</span></span> <span data-ttu-id="8919a-215">Tämän jälkeen voit arvioida, onko tulos hyväksyttävä.</span><span class="sxs-lookup"><span data-stu-id="8919a-215">You can then evaluate whether the result is acceptable.</span></span> <span data-ttu-id="8919a-216">Jos tulosta ei hyväksytä, voit päivittää kaavan ja testata sen uudelleen.</span><span class="sxs-lookup"><span data-stu-id="8919a-216">If the result isn't acceptable, you can update the formula and test it again.</span></span>

<span data-ttu-id="8919a-217">[![Testin tulos](./media/ER-FormulaTest-Result.png)](./media/ER-FormulaTest-Result.png)</span><span class="sxs-lookup"><span data-stu-id="8919a-217">[![Test result](./media/ER-FormulaTest-Result.png)](./media/ER-FormulaTest-Result.png)</span></span>

<span data-ttu-id="8919a-218">Joitakin kaavoja ei voi testata suunnittelun aikana.</span><span class="sxs-lookup"><span data-stu-id="8919a-218">Some formulas can't be tested at design time.</span></span> <span data-ttu-id="8919a-219">Kaava voi esimerkiksi palauttaa sellaisen tietotyypin tuloksen, jota ei voi näyttää **Testitulos**-välilehdellä. Tässä tapauksessa näyttöön tulee virhesanoma, joka toteaa, että kaavaa ei voi testata.</span><span class="sxs-lookup"><span data-stu-id="8919a-219">For example, a formula might return a result of a data type that can't be shown on the **Test result** tab. In this case, you receive an error message that states that the formula can't be tested.</span></span>

<span data-ttu-id="8919a-220">[![Virhesanoma](./media/ER-FormulaTest-Error.png)](./media/ER-FormulaTest-Error.png)</span><span class="sxs-lookup"><span data-stu-id="8919a-220">[![Error message](./media/ER-FormulaTest-Error.png)](./media/ER-FormulaTest-Error.png)</span></span>

## <a name="additional-resources"></a><span data-ttu-id="8919a-221">Lisäresurssit</span><span class="sxs-lookup"><span data-stu-id="8919a-221">Additional resources</span></span>

- [<span data-ttu-id="8919a-222">Sähköisen raportoinnin yleiskatsaus</span><span class="sxs-lookup"><span data-stu-id="8919a-222">Electronic Reporting overview</span></span>](general-electronic-reporting.md)
- [<span data-ttu-id="8919a-223">Sähköisen raportoinnin kaavakieli</span><span class="sxs-lookup"><span data-stu-id="8919a-223">Electronic reporting formula language</span></span>](er-formula-language.md)
