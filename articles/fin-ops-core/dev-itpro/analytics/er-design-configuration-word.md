---
title: Uuden ER-määrityksen suunnitteleminen luomaan Word-muotoisia raportteja
description: Tässä aiheessa käsitellään tapaa, jolla käyttävät voivat määrittää uuden sähköisen raportoinnin (ER) muodon luomaan raportteja Microsoft Word -asiakirjoina.
author: NickSelin
ms.date: 12/17/2020
ms.topic: business-process
ms.prod: ''
ms.technology: ''
ms.search.form: ERWorkspace, ERSolutionTable, EROperationDesigner,  LedgerJournalTable, LedgerJournalTransVendPaym
audience: Application User
ms.reviewer: kfend
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2020-01-01
ms.dyn365.ops.version: Version 10.0.6
ms.openlocfilehash: 4885caf017fa0f9d36d293fa32aad53c21d3f162
ms.sourcegitcommit: 074b6e212d19dd5d84881d1cdd096611a18c207f
ms.translationtype: HT
ms.contentlocale: fi-FI
ms.lasthandoff: 03/31/2021
ms.locfileid: "5753573"
---
# <a name="design-a-new-er-configuration-to-generate-reports-in-word-format"></a><span data-ttu-id="1aedd-103">Uuden ER-määrityksen suunnitteleminen luomaan Word-muotoisia raportteja</span><span class="sxs-lookup"><span data-stu-id="1aedd-103">Design a new ER configuration to generate reports in Word format</span></span>

[!include [banner](../includes/banner.md)]

<span data-ttu-id="1aedd-104">Raporttien luominen Microsoft Word -asiakirjoina edellyttää, että raporteille suunnitellaan malli käyttämällä esimerkiksi Wordin työpöytäsovellusta.</span><span class="sxs-lookup"><span data-stu-id="1aedd-104">To generate reports as Microsoft Word documents, you must design a template for the reports by using, for example, the Word desktop application.</span></span> <span data-ttu-id="1aedd-105">Seuraavassa kuvassa on esimerkkimalli valvontaraportista, joka voidaan luoda näyttämään käsiteltyjen toimittajamaksujen tiedot.</span><span class="sxs-lookup"><span data-stu-id="1aedd-105">The following illustration shows the sample template for the control report that can be generated to show details of processed vendor payments.</span></span>

![Valvontaraportin esimerkkimalli Wordin työpöytäsovelluksessa](./media/er-design-configuration-word-image1.png)

<span data-ttu-id="1aedd-107">Word-asiakirjaa voi käyttää Word-muotoisten raporttien mallina määrittämällä uuden [sähköisen raportoinnin (ER)](general-electronic-reporting.md) [ratkaisun](er-quick-start1-new-solution.md).</span><span class="sxs-lookup"><span data-stu-id="1aedd-107">To use a Word document as a template for reports in Word format, you can configure a new [Electronic reporting (ER)](general-electronic-reporting.md) [solution](er-quick-start1-new-solution.md).</span></span> <span data-ttu-id="1aedd-108">Tässä ratkaisussa on oltava ER-[määritys](general-electronic-reporting.md#Configuration), joka sisältää ER-[muodon](general-electronic-reporting.md#FormatComponentOutbound) osan.</span><span class="sxs-lookup"><span data-stu-id="1aedd-108">This solution must include an ER [configuration](general-electronic-reporting.md#Configuration) that contains an ER [format](general-electronic-reporting.md#FormatComponentOutbound) component.</span></span>

> [!NOTE]
> <span data-ttu-id="1aedd-109">Kun uusi ER-muotomääritys luodaan muodostamaan Word-muotoisia raportteja, **Word** on joko valittava muodon tyypiksi avattavassa **Luo määritys** -valintaikkunassa tai **Muodon tyyppi** -kenttä on jätettävä tyhjäksi.</span><span class="sxs-lookup"><span data-stu-id="1aedd-109">When you create a new ER format configuration to generate reports in Word format, you must either select **Word** as the format type in the **Create configuration** drop-down dialog box or leave the **Format type** field blank.</span></span>

![Muodon määrityksen luominen Määritykset-sivulla](./media/er-design-configuration-word-image2.gif)

<span data-ttu-id="1aedd-111">Ratkaisun ER-muoto-osan on sisällettävä **Excel\\Tiedosto**-muotoelementti, ja kyseinen muotoelementti on linkitettävä siihen Word-asiakirjaan, jota käytetään luotavien raporttien mallina suorituksen aikana.</span><span class="sxs-lookup"><span data-stu-id="1aedd-111">The ER format component of the solution must contain the **Excel\\File** format element, and that format element must be linked to the Word document that will be used as the template for generated reports at runtime.</span></span> <span data-ttu-id="1aedd-112">ER-muoto-osan määrittämistä varten on avattava luodun ER-määrityksen [luonnos](general-electronic-reporting.md#component-versioning) ER-muodon suunnittelutoiminnossa.</span><span class="sxs-lookup"><span data-stu-id="1aedd-112">To configure the ER format component, you must open the [draft](general-electronic-reporting.md#component-versioning) version of the created ER configuration in the ER format designer.</span></span> <span data-ttu-id="1aedd-113">Tämän jälkeen lisätään **Excel\\Tiedosto**-elementti, liitetään Word-malli muokattavaan ER-muotoon ja linkitetään kyseinen malli lisättyyn **Excel\\Tiedosto**-elementtiin.</span><span class="sxs-lookup"><span data-stu-id="1aedd-113">Then add the **Excel\\File** element, attach your Word template to the editable ER format, and link that template to the **Excel\\File** element that you added.</span></span>

> [!NOTE]
> <span data-ttu-id="1aedd-114">Mallia liitettäessä on käytettävä [asiakirjatyyppiä](https://docs.microsoft.com/dynamics365/fin-ops-core/fin-ops/organization-administration/configure-document-management#configure-document-types), joka on [määritetty](electronic-reporting-er-configure-parameters.md#parameters-to-manage-documents) aiemmin ER-parametreissa tallentamaan ER-muotojen mallit.</span><span class="sxs-lookup"><span data-stu-id="1aedd-114">When you attach a template, you must use a [document type](https://docs.microsoft.com/dynamics365/fin-ops-core/fin-ops/organization-administration/configure-document-management#configure-document-types) that has previously been [configured](electronic-reporting-er-configure-parameters.md#parameters-to-manage-documents) in the ER parameters to store templates of ER formats.</span></span>

![Mallin liittäminen Muodon suunnittelija -sivulla](./media/er-design-configuration-word-image3.gif)

<span data-ttu-id="1aedd-116">Sisäkkäiset **Excel\\Alue**- ja **Excel\\Solu**-elementit voidaan lisätä **Excel\\Tiedosto**-elementtiin määrittämään niiden tietojen rakenne, jotka annetaan luotavissa raporteissa suorituksen aikana.</span><span class="sxs-lookup"><span data-stu-id="1aedd-116">You can add **Excel\\Range** and **Excel\\Cell** nested elements for the **Excel\\File** element to specify the structure of data that will be entered in generated reports at runtime.</span></span> <span data-ttu-id="1aedd-117">Nämä elementit on sitten sidottava muokattavan ER-muodon tietolähteisiin, jotta niillä voidaan määrittää todelliset luotaviin raportteihin suorituksen aikana annettavat tiedot.</span><span class="sxs-lookup"><span data-stu-id="1aedd-117">You must then bind those elements to data sources of the editable ER format to specify the actual data that will be entered in generated reports at runtime.</span></span>

![Sisäkkäisten elementtien lisääminen Muodon suunnittelija -sivulla](./media/er-design-configuration-word-image4.gif)

<span data-ttu-id="1aedd-119">Kun ER-muodon muutokset tallennetaan suunnittelun yhteydessä, muodon hierarkkinen rakenne tallennetaan liitettyyn Word-malliin **Raportti**-nimisenä [mukautettuna XML-osana](https://docs.microsoft.com/visualstudio/vsto/custom-xml-parts-overview?view=vs-2019).</span><span class="sxs-lookup"><span data-stu-id="1aedd-119">When you save your changes to the ER format at design time, the hierarchical format structure is stored in the attached Word template as a [custom XML part](https://docs.microsoft.com/visualstudio/vsto/custom-xml-parts-overview?view=vs-2019) that is named **Report**.</span></span> <span data-ttu-id="1aedd-120">Mukautettuun malliin on siirryttävä ja se on ladattava Financesta, tallennettava paikallisesti ja avattava Wordin työpöytäsovelluksessa.</span><span class="sxs-lookup"><span data-stu-id="1aedd-120">You must access the modified template, download it from Finance, store it locally, and open it in the Word desktop application.</span></span> <span data-ttu-id="1aedd-121">Seuraavassa kuvassa paikallisesti tallennettu esimerkkimalli valvontaraportista, joka sisältää mukautetun **Raportti**-XML-osan.</span><span class="sxs-lookup"><span data-stu-id="1aedd-121">The following illustration shows the locally stored sample template for the control report that contains the **Report** custom XML part.</span></span>

![Raporttimalliesimerkin esikatselu Wordin työpöytäsovelluksessa](./media/er-design-configuration-word-image5.gif)

<span data-ttu-id="1aedd-123">Kun **Excel\\Alue**- ja **Excel\\Solu**-muotoelementtien sidonnat suoritetaan suorituksen aikana, kunkin sidonnan tiedot tuodaan luotuihin Word-asiakirjoihin mukautetun **Raportti**-XML-osan yksittäisinä kenttinä.</span><span class="sxs-lookup"><span data-stu-id="1aedd-123">When bindings of **Excel\\Range** and **Excel\\Cell** format elements are run at runtime, the data that every binding delivers comes into the generated Word document as an individual field of the **Report** custom XML part.</span></span> <span data-ttu-id="1aedd-124">Mukautetun XML-osan kenttien arvojen antaminen luodussa asiakirjassa edellyttää, että soveltuvat Wordin [sisällön ohjausobjektit](https://docs.microsoft.com/office/client-developer/word/content-controls-in-word) lisätään Word-malleihin suorituksen aikana täytettävien tietojen paikkamerkkeinä.</span><span class="sxs-lookup"><span data-stu-id="1aedd-124">To enter the values from the fields of the custom XML part in a generated document, you must add the appropriate Word [content controls](https://docs.microsoft.com/office/client-developer/word/content-controls-in-word) to your Word template to serve as placeholders for data that will be filled in at runtime.</span></span> <span data-ttu-id="1aedd-125">Sisällön ohjausobjektien täyttäminen määritetään yhdistämällä jokainen sisällön ohjausobjekti sopivaan mukautetun **Raportti**-XML-osan kenttään.</span><span class="sxs-lookup"><span data-stu-id="1aedd-125">To specify how content controls are filled in, map every content control to the appropriate field of the **Report** custom XML part.</span></span>

![Sisällön ohjausobjektien lisääminen ja yhdistäminen Wordin työpöytäsovelluksessa](./media/er-design-configuration-word-image6.gif)

<span data-ttu-id="1aedd-127">Muokattavan ER-muodon alkuperäinen Word-malli on sitten korvattava muokatulla mallilla, joka sisältää nyt mukautetun **Raportti**-XML-osan kenttiin yhdistetyt Wordin sisällön ohjausobjektit.</span><span class="sxs-lookup"><span data-stu-id="1aedd-127">You must then replace the original Word template of the editable ER format with the modified template that now contains Word content controls that were mapped to the fields of the **Report** custom XML part.</span></span>

![Mallin korvaaminen Muodon suunnittelija -sivulla](./media/er-design-configuration-word-image7.gif)

<span data-ttu-id="1aedd-129">Kun määritetty ER-muoto suoritetaan, liitettyä Word-mallia käytetään luomaan uusi raportti:</span><span class="sxs-lookup"><span data-stu-id="1aedd-129">When you run the configured ER format, the attached Word template is used to generate a new report.</span></span> <span data-ttu-id="1aedd-130">Varsinaiset tiedot tallennetaan Word-raportin **Raportti**-nimisenä mukautettuna XML-osana.</span><span class="sxs-lookup"><span data-stu-id="1aedd-130">The actual data is stored in the Word report as a custom XML part that is named **Report**.</span></span> <span data-ttu-id="1aedd-131">Kun luotu raportti avataan, Wordin sisällön ohjausobjekteihin täytetään mukautetun **Raportti**-XML-osan tiedot.</span><span class="sxs-lookup"><span data-stu-id="1aedd-131">When the generated report is opened, the Word content controls are filled in with data from the **Report** custom XML part.</span></span>

## <a name="frequently-asked-questions"></a><span data-ttu-id="1aedd-132">Usein kysytyt kysymykset</span><span class="sxs-lookup"><span data-stu-id="1aedd-132">Frequently asked questions</span></span>

<span data-ttu-id="1aedd-133">**Kysymys:** ER-muoto on määritetty tulostamaan yrityksen osoitteen sisältävä Word-asiakirja.</span><span class="sxs-lookup"><span data-stu-id="1aedd-133">**Question:** I configured an ER format to print a Word document that contains a company address.</span></span> <span data-ttu-id="1aedd-134">Tämän ER-muodon Word-malliin on lisätty muotoiltu sisällön ohjausobjekti ilmaisemaan yrityksen osoite.</span><span class="sxs-lookup"><span data-stu-id="1aedd-134">In the Word template for this ER format, I inserted a rich text content control to present a company address.</span></span> <span data-ttu-id="1aedd-135">Yrityksen osoite annettiin Financessa monirivisenä tekstinä ja rivinvaihto lisättiin **Enter**-näppäimellä.</span><span class="sxs-lookup"><span data-stu-id="1aedd-135">In Finance, I entered the company address as multiline text and selected **Enter** to add a carriage return for every line that I entered.</span></span> <span data-ttu-id="1aedd-136">Yrityksen osoitteen pitäisikin tämän vuoksi näkyä monirivisenä tekstinä luoduissa asiakirjoissa.</span><span class="sxs-lookup"><span data-stu-id="1aedd-136">Therefore, I expect the company address to appear as multiline text in generated documents.</span></span> <span data-ttu-id="1aedd-137">Osoite näkyy kuitenkin yhtenä tekstirivinä, joka sisältää erikoismerkkejä eikä rivinvaihtoja.</span><span class="sxs-lookup"><span data-stu-id="1aedd-137">However, the address appears as a single line of text that contains special symbols instead of carriage returns.</span></span> <span data-ttu-id="1aedd-138">Mitä vikaa asetuksessa on?</span><span class="sxs-lookup"><span data-stu-id="1aedd-138">What is wrong with my settings?</span></span>

<span data-ttu-id="1aedd-139">**Vastaus:** Muotoillun tekstisisällön ohjausobjektin sijaan on käytettävä vain teksti -muotoista sisällön ohjausobjektia ja valittava **Salli rivinvaihdot (useat kappaleet)** -valintaruutu ohjausobjektin ominaisuuksissa.</span><span class="sxs-lookup"><span data-stu-id="1aedd-139">**Answer:** Instead of using a rich text content control, you must use a plain text content control and select the **Allow carriage returns (multiple paragraphs)** check box in the control's properties.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="1aedd-140">Lisäresurssit</span><span class="sxs-lookup"><span data-stu-id="1aedd-140">Additional resources</span></span>

- [<span data-ttu-id="1aedd-141">Excel-malleja sisältävien ER-määritysten käyttäminen uudelleen Word-muotoisten raporttien luontiin</span><span class="sxs-lookup"><span data-stu-id="1aedd-141">Reuse ER configurations with Excel templates to generate reports in Word format</span></span>](./tasks/er-design-configuration-word-2016-11.md)
- [<span data-ttu-id="1aedd-142">Kuvien ja muotojen upottaminen luomiisi asiakirjoihin ER:n avulla</span><span class="sxs-lookup"><span data-stu-id="1aedd-142">Embed images and shapes in documents that you generate by using ER</span></span>](electronic-reporting-embed-images-shapes.md#embed-an-image-in-a-word-document)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]