---
title: Haun tietolähteiden määrittäminen ER-sovelluskohtaisten parametrien käyttämiseksi
description: Tässä ohjeaiheessa kerrotaan, kuinka voit määrittää hakutietolähteet sähköisen raportoinnin (ER) muodoissa käyttämään ER-sovelluskohtaisia parametreja.
author: NickSelin
manager: AnnBe
ms.date: 04/02/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: ERSolutionTable, EROperationDesigner, ERLookupDesigner, ERComponentLookupStructureEditing
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.custom: ''
ms.assetid: ''
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2019-01-01
ms.dyn365.ops.version: Release 8.1.3
ms.openlocfilehash: 542580c859759c25da84589ec82495eb72bbcbe5
ms.sourcegitcommit: 74f5b04b482b2ae023c728e0df0eb78305493c6a
ms.translationtype: HT
ms.contentlocale: fi-FI
ms.lasthandoff: 04/02/2021
ms.locfileid: "5853518"
---
# <a name="configure-lookup-data-sources-to-use-er-application-specific-parameters"></a><span data-ttu-id="a9c54-103">Haun tietolähteiden määrittäminen ER-sovelluskohtaisten parametrien käyttämiseksi</span><span class="sxs-lookup"><span data-stu-id="a9c54-103">Configure Lookup data sources to use ER application-specific parameters</span></span> 

[!include[banner](../includes/banner.md)]

<span data-ttu-id="a9c54-104">Sovelluskohtaisten [ER-parametrien](general-electronic-reporting.md) avulla voit määrittää ER-muodon tietojen suodattamisen abstraktin sääntöjoukon perusteella.</span><span class="sxs-lookup"><span data-stu-id="a9c54-104">The [Electronic reporting (ER)](general-electronic-reporting.md) application-specific parameters feature lets you configure data filtering in an ER format so that it's based on a set of abstract rules.</span></span> <span data-ttu-id="a9c54-105">Tämä sääntöjoukko voidaan määrittää käyttämään **Haku**-tyypin ER-muodossa käytettävissä olevaa tietolähdettä.</span><span class="sxs-lookup"><span data-stu-id="a9c54-105">This set of rules can be configured to use the data source of the **Lookup** type that is available in an ER format.</span></span> <span data-ttu-id="a9c54-106">Tämän jälkeen voit määrittää todelliset säännöt ER-komponenttien suunnittelijoiden ulkopuolella käyttämällä käyttöliittymää (UI), joka luodaan automaattisesti vastaavan ER-muodon **haku** tietolähteen asetusten ja nykyisten oikeushenkilötietojen perusteella.</span><span class="sxs-lookup"><span data-stu-id="a9c54-106">You can then specify real rules beyond the ER components designers by using the user interface (UI) that is automatically generated based on the settings of the **Lookup** data source of the corresponding ER format and the current legal entity data.</span></span> <span data-ttu-id="a9c54-107">Lopulta määritettyjä sääntöjä käytetään ER-muodon **Haku** tietolähde-kentässä, kun ER-muoto suoritetaan.</span><span class="sxs-lookup"><span data-stu-id="a9c54-107">Eventually, the specified rules will be accessed by the ER format's **Lookup** data source when this ER format is executed.</span></span>

> [!NOTE]
> <span data-ttu-id="a9c54-108">Muokkaatavissa ER-muodon konfiguroitujen tietolähteiden avulla voit määrittää, mitä sovellustietoja käytetään reaalisääntöjen määrityksessä.</span><span class="sxs-lookup"><span data-stu-id="a9c54-108">Use the configured data sources of the editable ER format to specify what application data is used to configure real rules.</span></span>

<span data-ttu-id="a9c54-109">[ER-toimintojen suunnittelutoiminto](general-electronic-reporting.md#building-a-format-that-uses-a-data-model-as-a-base) tuo **haku**-tyypin tietolähteen ER-muotoon.</span><span class="sxs-lookup"><span data-stu-id="a9c54-109">Use the [ER Operations designer](general-electronic-reporting.md#building-a-format-that-uses-a-data-model-as-a-base) to bring a data source of the **Lookup** type in to your ER format.</span></span> <span data-ttu-id="a9c54-110">Tietolähteen asetukset on määritettävä niin, että ne kuvaavat, miltä abstraktit säännöt näyttävät. Näitä ovat esimerkiksi seuraavat:</span><span class="sxs-lookup"><span data-stu-id="a9c54-110">The data source must be configured to describe how your abstract rules look, including the following:</span></span>

   - <span data-ttu-id="a9c54-111">Tietyn tietotyypin parametrijoukko, jonka arvoa annetaan yksittäisen säännön määrittämiseksi.</span><span class="sxs-lookup"><span data-stu-id="a9c54-111">The parameter set of certain data type whose value is provided to specify a single rule.</span></span>
   - <span data-ttu-id="a9c54-112">Tietyn tietotyypin arvotyyppi, jonka yksittäinen sääntö palauttaa, kun sääntöä pidetään muun muassa sopivina.</span><span class="sxs-lookup"><span data-stu-id="a9c54-112">The value type of certain data type that is returned by a single rule when this rule is considered the most appropriate among others.</span></span>

<span data-ttu-id="a9c54-113">Voit konfiguroida seuraavantyyppisiä **haku** tietolähteitä sen mukaan, minkä tyyppisen arvon mikä tahansa konfiguroitu sääntö palauttaa:</span><span class="sxs-lookup"><span data-stu-id="a9c54-113">You can configure the following types of **Lookup** data sources depending on the type of value that is returned by any configured rule:</span></span>

   - <span data-ttu-id="a9c54-114">Käytä **Tietomalli\Haku**-tyyppiä, kun mallin valintalista-arvo on palautettava.</span><span class="sxs-lookup"><span data-stu-id="a9c54-114">Use the **Data model\Lookup** type when a model enumeration value must be returned.</span></span>
   - <span data-ttu-id="a9c54-115">Käytä **Dynamics 365 Operations\Lookup** -tyyppiä, kun sovelluksen valintalistan arvo tai sovelluksen [laajennettu tietotyypin](../extensibility/extensible-edts.md) arvo on palautettava.</span><span class="sxs-lookup"><span data-stu-id="a9c54-115">Use the **Dynamics 365 Operations\Lookup** type when an application enumeration value or an application [extended data type](../extensibility/extensible-edts.md) value must be returned.</span></span>
   - <span data-ttu-id="a9c54-116">Käytä **Muotoile luettelo\Haku**-tyyppiä, kun muodon valintalista-arvo on palautettava.</span><span class="sxs-lookup"><span data-stu-id="a9c54-116">Use the **Format enumeration\Lookup** type when a format enumeration value must be returned.</span></span>

<span data-ttu-id="a9c54-117">Seuraavassa kuvassa esitetään, miten muodon valintalista voidaan konfiguroida ER-mallimuodossa.</span><span class="sxs-lookup"><span data-stu-id="a9c54-117">The following illustration shows how a format enumeration can be configured in the sample ER format.</span></span>

   ![Muodon valintalistan näyttäminen konfiguroitujen hakutietojen lähteen pohjana](./media/er-lookup-data-sources-img1.gif)

<span data-ttu-id="a9c54-119">Seuraavassa kuvassa esitetään muodon komponentit, jotka on konfiguroitu raportoimaan erityyppiset verot luodun raportin eri osassa.</span><span class="sxs-lookup"><span data-stu-id="a9c54-119">The following illustration shows the format components that were configured to report different type of taxes in a different section of a generated report.</span></span>

   ![Erilaisten verojen erityyppisten verojen erillisen raportin näyttäminen muotoilun osissa](./media/er-lookup-data-sources-img2.png)

<span data-ttu-id="a9c54-121">Seuraavassa kuvassa havainnollistaa, kuinka ER Operations -suunnittelu sallii **muotoile luettelo\haku** -tyypin tietolähteen lisäyksen.</span><span class="sxs-lookup"><span data-stu-id="a9c54-121">The following illustration shows how the ER Operations designer allows the addition of a data source of the **Format enumeration\Lookup** type.</span></span>  <span data-ttu-id="a9c54-122">Lisätty tietolähde on määritetty palauttamaan `List of taxation levels`- muodon valintalistan arvo.</span><span class="sxs-lookup"><span data-stu-id="a9c54-122">The added data source is configured as returning a value of the `List of taxation levels` format enumeration.</span></span>

   ![Muotoile luettelo\haku-tyypin ER-tietolähteen lisääminen](./media/er-lookup-data-sources-img3.gif)

<span data-ttu-id="a9c54-124">Seuraavassa kuvassa havainnollistetaan, miten lisätty tietolähde on konfiguroitu käyttämään mallitietolähteen **Koodi**-kenttää. **Mallin** tietolähteen **Model.Data.Tax**-tietue on määritetty parametriksi jokaista konfiguroitua sääntöä varten.</span><span class="sxs-lookup"><span data-stu-id="a9c54-124">The following illustration shows how the added data source is configured to use the **Code** field of the **Model.Data.Tax** record list of the **Model** data source as a parameter that must be specified for every configured rule.</span></span>

![Muotoile luettelo\haku-tyypin lisätyn tietolähteen parametrien konfiguroiminen](./media/er-lookup-data-sources-img4.gif)

<span data-ttu-id="a9c54-126">Lisätty `Model.Data.Tax`-tietolähde määritetään määrittämään verokoodi jokaiselle konfiguroitulle säännölle käyttämällä **TaxTable**-sovellustaulun tietueita.</span><span class="sxs-lookup"><span data-stu-id="a9c54-126">The added `Model.Data.Tax` data source is configured to specify a tax code for every configured rule by accessing records of the **TaxTable** application table.</span></span>

   ![Mallin muokkaaminen\haku-tyypin yhden yrityksen hakutietolähteen tarkastelu](./media/er-lookup-data-sources-img5.gif)

<span data-ttu-id="a9c54-128">Voit määrittää valitun ER-muodon hakusäännöt käyttämällä käyttöliittymää, joka on automaattisesti kohdistettu konfiguroidun valitun tietolähteen rakenteen kanssa.</span><span class="sxs-lookup"><span data-stu-id="a9c54-128">You can set up the lookup rules for the selected ER format by using the UI that is automatically aligned with the structure of the configured data source.</span></span> <span data-ttu-id="a9c54-129">Tämä käyttöliittymä edellyttää, että jokaiselle säännölle on määritettävä palautusarvo `List of taxation levels`-muodon valintalista-arvoksi sekä verokoodi parametriksi.</span><span class="sxs-lookup"><span data-stu-id="a9c54-129">Currently, this UI requires that for each rule, you specify the returned value as the `List of taxation levels` format enumeration value as well as the tax code as a parameter.</span></span>

   ![Konfiguroidun tietolähteen sääntöjen määrittäminen](./media/er-lookup-data-sources-img6.gif)

<span data-ttu-id="a9c54-131">Seuraavassa kuvassa havainnollistetaan, miten **lasketun kenttä** tyypin `Model.Data.Summary.LevelByLookup`-tietolähteen voi konfiguroida niin, että se kutsui määritettyä **haku** tietolähdettä ja antaa tarvittavat parametrit.</span><span class="sxs-lookup"><span data-stu-id="a9c54-131">The following illustration shows how the `Model.Data.Summary.LevelByLookup` data source of the **Calculated field** type can be configured to call the configured **Lookup** data source providing the required parameters.</span></span> <span data-ttu-id="a9c54-132">Voit käsitellä tätä puhelua ajon aikana ER käy läpi määritetyssä järjestyksessä määritettyjen sääntöjen luettelon ja etsii ensimmäisen säännön, joka täyttää määritetyt ehdot.</span><span class="sxs-lookup"><span data-stu-id="a9c54-132">To process this call at runtime, ER goes through the list of configured rules in the defined sequence to locate the first rule that satisfies the provided conditions.</span></span> <span data-ttu-id="a9c54-133">Tässä esimerkissä sääntö, joka sisältää annettua verokoodia vastaavat verokoodit.</span><span class="sxs-lookup"><span data-stu-id="a9c54-133">In this example, it's the rule that contains the tax code that matches the provided one.</span></span> <span data-ttu-id="a9c54-134">Näin saadaan selville, mikä sääntö on sopivin ja mikä on sääntöä varten konfiguroitu valintalista-arvo, jonka tämä tietolähde palauttaa.</span><span class="sxs-lookup"><span data-stu-id="a9c54-134">As the result, the most appropriate rule is found and the enumeration value that is configured for the found rule is returned by this data source.</span></span>

> [!NOTE]
> <span data-ttu-id="a9c54-135">Poikkeus ilmenee, jos sovellettavaa sääntöä ei löydy.</span><span class="sxs-lookup"><span data-stu-id="a9c54-135">An exception is thrown when no applicable rule is found.</span></span> <span data-ttu-id="a9c54-136">Voit estää nämä poikkeukset määrittämällä sääntöluettelon lopussa lisää sääntöjä, jotka käsittelevät tapauksia, joissa annetaan ei-konfiguroitu arvo tai arvoa ei ole.</span><span class="sxs-lookup"><span data-stu-id="a9c54-136">To prevent these exceptions, configure additional rules at the end of the rules list to handle cases when a non-configured value or no value is provided.</span></span> <span data-ttu-id="a9c54-137">Käytä **\*Ei tyhjä\***- ja **\*Tyhjä\***-asetuksia vastaavasti.</span><span class="sxs-lookup"><span data-stu-id="a9c54-137">Use the **\*Not blank**\* and **\*Blank**\* options accordingly.</span></span>  
>
> ![Määritetyn hakutietolähteen kutsuminen tietolähteen lisäämiseksi](./media/er-lookup-data-sources-img7.png)

<span data-ttu-id="a9c54-139">Kun määrität **Yritysten välinen**-asetuksen arvoksi **Kyllä** muokattavalle hakutietolähteelle, lisäät uuden pakollisen **yritys**-parametrin tämän tietolähteen parametrijoukkoon.</span><span class="sxs-lookup"><span data-stu-id="a9c54-139">When you set the **Cross-company** option to **Yes** for the editable lookup data source, you add a new required **Company** parameter to the set of parameters of this data source.</span></span> <span data-ttu-id="a9c54-140">**Yritys**-parametrin arvo on määritettävä ajon aikana, kun hakutietolähdettä kutsutaan.</span><span class="sxs-lookup"><span data-stu-id="a9c54-140">The value of the **Company** parameter must be specified at runtime when the lookup data source is called.</span></span> <span data-ttu-id="a9c54-141">Kun yrityskoodi määritetään ajon aikana, ohjelma käyttää tälle yritykselle määritettyjä sääntöjä sopivimman säännön etsimisessä ja vastaava arvo palautetaan.</span><span class="sxs-lookup"><span data-stu-id="a9c54-141">When the company code is specified at runtime, the rules configured for this company are used to find the most appropriate rule, and the corresponding value is returned.</span></span> <span data-ttu-id="a9c54-142">Seuraavassa kuvassa kerrotaan, miten tämä voidaan tehdä ja miten muokattavissa olevia tietolähdettä muutetaan.</span><span class="sxs-lookup"><span data-stu-id="a9c54-142">The following illustration shows how you can do this and how the set of parameters of the editable data source is changed.</span></span>

   ![Mallin muokkaaminen\haku-tyypin yritysten välisen hakutietolähteen tarkastelu](./media/er-lookup-data-sources-img8.gif)

> [!NOTE]
> <span data-ttu-id="a9c54-144">Valitse jokainen yritys erikseen, jos haluat määrittää tämän hakutietolähteen sääntöjoukon muokattavassa ER-muodossa.</span><span class="sxs-lookup"><span data-stu-id="a9c54-144">Select every company seperately to configure the set of rules for this lookup data source of the editable ER format.</span></span> <span data-ttu-id="a9c54-145">Poikkeus tulee suorituspalvelussa, kun yritystenvälistä hakua kutsutaan sen yrityksen koodilla, jonka hakuasetusta ei ole tehty loppuun.</span><span class="sxs-lookup"><span data-stu-id="a9c54-145">An exception is thrown at runtime when the cross-company lookup is called with the code of the company for which the lookup setting was not completed.</span></span>
>
> <span data-ttu-id="a9c54-146">Varmista, että myönnät käyttöoikeudet käyttäjälle, joka suorittaa ER-muodon yritystenvälisen **haku**-tietolähteen avulla, jotta voit käyttää kaikkien tämän tietolähteen käyttöalueeseen kuuluvien yritysten tietoja.</span><span class="sxs-lookup"><span data-stu-id="a9c54-146">Make sure that you grant permissions for a user who runs the ER format with the cross-company **Lookup** data source to access the data of every company that is in scope of this data source.</span></span> <span data-ttu-id="a9c54-147">Muussa tapauksessa tuotetaan poikkeus ajon aikana.</span><span class="sxs-lookup"><span data-stu-id="a9c54-147">Otherwise, an exception is thrown at runtime.</span></span>

<span data-ttu-id="a9c54-148">Versiosta 10.0.19 alkaen **haku**-tietolähteiden laajennetut toiminnot ovat käytettävissä.</span><span class="sxs-lookup"><span data-stu-id="a9c54-148">Starting in version 10.0.19, the extended capabilities of the **Lookup** data sources are available.</span></span> <span data-ttu-id="a9c54-149">Kun määrität muokattavan hakutietolähteen **Laajennettu**-asetuksen arvoksi **Kyllä**, konfiguroitu hakutietolähde muunnetaan rakenteeksi tietolähteeksi, joka tarjoaa lisätoimintoja konfiguroitujen sääntöjoukon analysoimista varten.</span><span class="sxs-lookup"><span data-stu-id="a9c54-149">When you set the **Extended** option to **Yes** for the editable lookup data source, the configured lookup data source is transformed to the structured data source that offers the additional capabilities to analyze the configured set of rules.</span></span> <span data-ttu-id="a9c54-150">Seuraavassa kuvassa näkyy tämä muunnos.</span><span class="sxs-lookup"><span data-stu-id="a9c54-150">The following illustration shows this transformation.</span></span>

   ![Mallin muokkaaminen\haku-tyypin jäsennellyn hakutietolähteen tarkastelu](./media/er-lookup-data-sources-img9.gif)

- <span data-ttu-id="a9c54-152">**Haku**-alinimike on suunniteltu toimintoksi, joka löytää sopivimman säännön parametrijoukon perusteella konfiguroitavien sääntöjen joukkoa joukon perusteella.</span><span class="sxs-lookup"><span data-stu-id="a9c54-152">The **Lookup** sub-item is designed as a function to find the most appropriate rule from the set of configurable rules based on the provided set of parameters.</span></span>
- <span data-ttu-id="a9c54-153">**IsLookupResultSet**-alinimike on suunniteltu toimintoksi, joka hyväksyy peruslistatietolähteen määritetyn arvon ja palauttaa *totuusarvon* **Tosi**, kun sääntöjoukko sisältää vähintään yhden säännön, jolle annettu valintalista-arvo on määritetty palautetuksi arvoksi.</span><span class="sxs-lookup"><span data-stu-id="a9c54-153">The **IsLookupResultSet** sub-item is designed as a function to accept the provided value of the base enumeration data source and return the *Boolean* value of **True** when the set of rules contain at least one rule for which the provided enumeration value was configured as a returned value.</span></span> <span data-ttu-id="a9c54-154">Tämä toiminto palauttaa *totuusarvon* **Epätosi**, kun ei ole sääntöjä, jotka palauttavat määritetyn valintalista-arvon.</span><span class="sxs-lookup"><span data-stu-id="a9c54-154">This function returns the *Boolean* value of **False** when there are no rules configured to return the provided enumeration value.</span></span>
- <span data-ttu-id="a9c54-155">**Asetus**-alinimikkeen määrittäminen on toiminto, joka palauttaa konfiguroitujen sääntöjen joukon tietueluettelon tietueista.</span><span class="sxs-lookup"><span data-stu-id="a9c54-155">The **Setting** sub-item is designed as a function that returns the set of configured rules as records of a record list.</span></span> <span data-ttu-id="a9c54-156">Palautetut arvot ja konfiguroitujen sääntöjen parametrijoukko näkyvät jokaisessa palautetussa tietueessa tietotyyppien kentissä:</span><span class="sxs-lookup"><span data-stu-id="a9c54-156">The returned values and the set of parameters of the configured rules are presented in every returned record as fields of the relevant data types:</span></span>

    - <span data-ttu-id="a9c54-157">Palautetut arvot näytetään **Hakutulos**-kentässä.</span><span class="sxs-lookup"><span data-stu-id="a9c54-157">The returned value is presented as the **Lookup result** field.</span></span>
    - <span data-ttu-id="a9c54-158">Konfiguroitu parametri esitetään kentissä parametrien niminä (tässä esimerkissä **koodi**-kenttä).</span><span class="sxs-lookup"><span data-stu-id="a9c54-158">The configured parameters are presented as fields having names of parameters (**Code** field in this example).</span></span>

<span data-ttu-id="a9c54-159">Lisätietoja **haku** tietolähteen konfiguroinnista on kohdassa [ER-muotojen konfiguroiminen käyttämään yritykselle määritettyjä parametreja](er-app-specific-parameters-configure-format.md).</span><span class="sxs-lookup"><span data-stu-id="a9c54-159">For more information about to how configure the **Lookup** data source, see [Configure ER formats to use parameters that are specified per legal entity](er-app-specific-parameters-configure-format.md).</span></span> <span data-ttu-id="a9c54-160">Lisätietoja hakusääntöjen määrittämisestä on kohdassa [ER-muodon parametrien määrittämisestä yritystä kohti](er-app-specific-parameters-set-up.md).</span><span class="sxs-lookup"><span data-stu-id="a9c54-160">To learn how to set the Lookup rules, see [Set up the parameters of an ER format per legal entity](er-app-specific-parameters-set-up.md).</span></span>

## <a name="additional-resources"></a><span data-ttu-id="a9c54-161">Lisäresurssit</span><span class="sxs-lookup"><span data-stu-id="a9c54-161">Additional resources</span></span>

[<span data-ttu-id="a9c54-162">Sähköisen raportoinnin muotojen määrittäminen käyttämään yrityskohtaisesti määritettyjä parametreja</span><span class="sxs-lookup"><span data-stu-id="a9c54-162">Configure ER formats to use parameters that are specified per legal entity</span></span>](er-app-specific-parameters-configure-format.md)

[<span data-ttu-id="a9c54-163">Sähköisen raportoinnin muodon parametrien määrittäminen yrityskohtaisesti</span><span class="sxs-lookup"><span data-stu-id="a9c54-163">Set up the parameters of an ER format per legal entity</span></span>](er-app-specific-parameters-set-up.md)
