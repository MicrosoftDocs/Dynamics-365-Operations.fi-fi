---
title: Azure-tallennustilin ja avainsäilön luominen
description: Tässä ohjeaiheessa kerrotaan, miten luodaan Azure-tallennustili ja avainsäilö.
author: gionoder
manager: AnnBe
ms.date: 09/22/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
ms.search.form: ''
audience: Application User
ms.reviewer: kfend
ms.search.scope: Core, Operations
ms.custom: 97423
ms.assetid: ''
ms.search.region: Global
ms.author: janeaug
ms.search.validFrom: 2020-07-08
ms.dyn365.ops.version: AX 10.0.12
ms.openlocfilehash: b8e39539f767cc2944a9a7fdda09121921c64763
ms.sourcegitcommit: 025561f6a21fe8705493daa290f3f6bfb9f1b962
ms.translationtype: HT
ms.contentlocale: fi-FI
ms.lasthandoff: 09/23/2020
ms.locfileid: "3835949"
---
# <a name="create-an-azure-storage-account-and-a-key-vault"></a><span data-ttu-id="7bd6f-103">Azure-tallennustilin ja avainsäilön luominen</span><span class="sxs-lookup"><span data-stu-id="7bd6f-103">Create an Azure storage account and a key vault</span></span>

[!include [banner](../includes/banner.md)]
[!include [banner](../includes/preview-banner.md)]


<span data-ttu-id="7bd6f-104">Sähköisen laskutuksen lisäosapalvelu ottaa vastuun kaikkien liiketoimintatietojen tallentamisesta yrityksen omistamiin Microsoft Azure -resursseihin.</span><span class="sxs-lookup"><span data-stu-id="7bd6f-104">The Electronic invoicing add-on service takes responsibility for storing all your business data in the Microsoft Azure resources that are owned by your company.</span></span> <span data-ttu-id="7bd6f-105">Sen varmistamiseksi, että palvelu toimii oikein ja että kaikki sähköisen laskutuksen lisäosaa varten tarvittavat ja sen luomat liiketoimintatiedot ovat vain lisäosan käytettävissä, on luotava kaksi keskeistä Azure-resurssia:</span><span class="sxs-lookup"><span data-stu-id="7bd6f-105">To ensure that the service works correctly, and that all the business data that is needed for and generated by the Electronic invoicing add-on is accessed only by the add-on, you must create two main Azure resources:</span></span>

- <span data-ttu-id="7bd6f-106">Azure-tallennustili (Blob-tallennus) sähköisten laskujen tallentamista varten</span><span class="sxs-lookup"><span data-stu-id="7bd6f-106">An Azure storage account (Blob storage) to store electronic invoices</span></span>
- <span data-ttu-id="7bd6f-107">Azure-avainsäilö, johon tallennetaan tallennustilin tallennusvarmenteet ja Uniform Resource Identifier (URI)</span><span class="sxs-lookup"><span data-stu-id="7bd6f-107">An Azure key vault to store certificates and the Uniform Resource Identifier (URI) of the storage account</span></span>

> [!NOTE]
> <span data-ttu-id="7bd6f-108">Erillinen avainsäilöresurssi ja asiakkaan Blob-tallennustila on määritettävä nimenomaisesti käytettäväksi sähköisen laskutuksen lisäosan kanssa.</span><span class="sxs-lookup"><span data-stu-id="7bd6f-108">A dedicated key vault resource and customer Blob storage must be allocated specifically for use with the Electronic invoicing add-on.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="7bd6f-109">Edellytykset</span><span class="sxs-lookup"><span data-stu-id="7bd6f-109">Prerequisites</span></span>

<span data-ttu-id="7bd6f-110">Ennen kuin voit suorittaa tämän ohjeaiheen vaiheet on varmistettava, että seuraavat tehtävät on suoritettu:</span><span class="sxs-lookup"><span data-stu-id="7bd6f-110">Before you can complete the steps in this topic, you must make sure that the following tasks have been completed:</span></span>

- <span data-ttu-id="7bd6f-111">Avainsäilöresurssin luominen Azuressa.</span><span class="sxs-lookup"><span data-stu-id="7bd6f-111">Create a key vault resource in Azure.</span></span> <span data-ttu-id="7bd6f-112">Lisätietoja: [Tietoja Azure Key Vaultista](https://docs.microsoft.com/azure/key-vault/general/overview).</span><span class="sxs-lookup"><span data-stu-id="7bd6f-112">For more information, see [About Azure Key Vault](https://docs.microsoft.com/azure/key-vault/general/overview).</span></span>
- <span data-ttu-id="7bd6f-113">Azure-tallennustilin (Blob-tallennustila) luominen.</span><span class="sxs-lookup"><span data-stu-id="7bd6f-113">Create an Azure storage account (Blob storage).</span></span> <span data-ttu-id="7bd6f-114">Lisätietoja: [Azure-tallennustilin ylläpito ](https://docs.microsoft.com/azure/storage/blobs/).</span><span class="sxs-lookup"><span data-stu-id="7bd6f-114">For more information, see [Maintaining Azure Storage Account](https://docs.microsoft.com/azure/storage/blobs/).</span></span>

## <a name="overview"></a><span data-ttu-id="7bd6f-115">Yleiskuvaus</span><span class="sxs-lookup"><span data-stu-id="7bd6f-115">Overview</span></span>

<span data-ttu-id="7bd6f-116">Tässä aiheessa suoritetaan kaksi päävaihetta:</span><span class="sxs-lookup"><span data-stu-id="7bd6f-116">In this topic, you will complete two main steps:</span></span>

- <span data-ttu-id="7bd6f-117">Azure-tallennustilin määrittäminen tallennustilin URI-tunnuksen saamista varten.</span><span class="sxs-lookup"><span data-stu-id="7bd6f-117">Set up the Azure storage account to get the storage account URI.</span></span>
- <span data-ttu-id="7bd6f-118">Avainsäilön määrittäminen tallennustilin URI-tunnuksen tallentamista varten.</span><span class="sxs-lookup"><span data-stu-id="7bd6f-118">Set up the key vault to store the storage account URI.</span></span>

## <a name="set-up-the-azure-storage-account-to-get-the-storage-account-uri"></a><span data-ttu-id="7bd6f-119">Azure-tallennustilin määrittäminen tallennustilin URI-tunnuksen saamista varten</span><span class="sxs-lookup"><span data-stu-id="7bd6f-119">Set up the Azure storage account to get the storage account URI</span></span>

1. <span data-ttu-id="7bd6f-120">Avaa tallennustili, jota aiot käyttää sähköisen laskutuksen lisäosan kanssa.</span><span class="sxs-lookup"><span data-stu-id="7bd6f-120">Open the storage account that you plan to use with the Electronic invoicing add-on.</span></span>
2. <span data-ttu-id="7bd6f-121">Siirry kohtaan **Blob-palvelu** \> **Säilöt** ja luo uusi säilö.</span><span class="sxs-lookup"><span data-stu-id="7bd6f-121">Go to **Blob service** \> **Containers**, and create a new container.</span></span>
3. <span data-ttu-id="7bd6f-122">Anna säilölle nimi ja määritä **Julkinen käyttöoikeustaso** -kentän arvoksi **Yksityinen (ei anonyymia käyttöä)**.</span><span class="sxs-lookup"><span data-stu-id="7bd6f-122">Enter a name for the container, and set the **Public access level** field to **Private (no anonymous access)**.</span></span>
4. <span data-ttu-id="7bd6f-123">Avaa säilö ja siirry kohtaan **Asetukset \> Käyttöoikeuskäytäntö**.</span><span class="sxs-lookup"><span data-stu-id="7bd6f-123">Open the container, and go to **Settings \> Access policy**.</span></span>
5. <span data-ttu-id="7bd6f-124">Valitse **Lisää käytäntö** lisätäksesi tallennetun käyttöoikeuskäytännön.</span><span class="sxs-lookup"><span data-stu-id="7bd6f-124">Select **Add policy** to add a stored access policy.</span></span>
6. <span data-ttu-id="7bd6f-125">Määritä kentät **Tunnus** ja **Oikeudet** tarpeen mukaan.</span><span class="sxs-lookup"><span data-stu-id="7bd6f-125">Set the **Identifier** and **Permissions** fields as appropriate.</span></span> <span data-ttu-id="7bd6f-126">**Oikeudet**-kentässä valitaan kaikki oikeudet.</span><span class="sxs-lookup"><span data-stu-id="7bd6f-126">In the **Permissions** field, you should select all permissions.</span></span>

    ![Blob-tallennustilan oikeuksien myöntäminen](media/e-Invoicing-services-create-azure-resources-grant-blob-permissions.png)

7. <span data-ttu-id="7bd6f-128">Määritä alkamis- ja päättymispäivät.</span><span class="sxs-lookup"><span data-stu-id="7bd6f-128">Enter the start and expiry dates.</span></span> <span data-ttu-id="7bd6f-129">Päättymispäivän on oltava tulevaisuudessa.</span><span class="sxs-lookup"><span data-stu-id="7bd6f-129">The expiry date should be in future.</span></span>
8. <span data-ttu-id="7bd6f-130">Tallenna käytäntö valitsemalla **OK** ja tallenna muutoksesi säilöön.</span><span class="sxs-lookup"><span data-stu-id="7bd6f-130">Select **OK** to save the policy, and then save your changes to the container.</span></span>
9. <span data-ttu-id="7bd6f-131">Palaa tallennustilille ja avaa **Tallennustilan hallinta (esikatselu)**.</span><span class="sxs-lookup"><span data-stu-id="7bd6f-131">Return to the storage account, and open **Storage Explorer (preview)**.</span></span>
10. <span data-ttu-id="7bd6f-132">Napsauta säilöä hiiren kakkospainikkeella ja valitse sitten **Hae jaetun käyttöoikeuden allekirjoitus**.</span><span class="sxs-lookup"><span data-stu-id="7bd6f-132">Right-click the container, and then select **Get Shared Access Signature**.</span></span>
11. <span data-ttu-id="7bd6f-133">Kopioi **Jaetun käyttöoikeuden allekirjoitus** -valintaikkunan arvo ja tallenna se **URI**-kenttään.</span><span class="sxs-lookup"><span data-stu-id="7bd6f-133">In the **Shared Access Signature** dialog box, copy and store the value in the **URI** field.</span></span> <span data-ttu-id="7bd6f-134">Tätä arvoa käytetään seuraavassa menettelyssä, ja sitä kutsutaan *jaetun käyttöoikeuden allekirjoituksen URI-tunnukseksi*.</span><span class="sxs-lookup"><span data-stu-id="7bd6f-134">This value will be used in the next procedure and will be referred to as the *shared access signature URI*.</span></span>

    ![URI-arvon valitseminen ja kopioiminen](media/e-Invoicing-services-create-azure-resources-select-and-copy-uri.png)

## <a name="set-up-the-key-vault-to-store-the-storage-account-uri"></a><span data-ttu-id="7bd6f-136">Avainsäilön määrittäminen tallennustilin URI-tunnuksen tallentamista varten</span><span class="sxs-lookup"><span data-stu-id="7bd6f-136">Set up the key vault to store the storage account URI</span></span>

1. <span data-ttu-id="7bd6f-137">Avaa avainsäilö, jota aiot käyttää sähköisen laskutuksen lisäosan kanssa.</span><span class="sxs-lookup"><span data-stu-id="7bd6f-137">Open the key vault that you intend to use with the Electronic invoicing add-on.</span></span>
2. <span data-ttu-id="7bd6f-138">Siirry kohtaan **Asetukset** \> **Salasanat** ja luo sitten uusi salasana valitsemalla **Luo/tuo**.</span><span class="sxs-lookup"><span data-stu-id="7bd6f-138">Go to **Settings** \> **Secrets**, and then select **Generate/Import** to create a new secret.</span></span>
3. <span data-ttu-id="7bd6f-139">Valitse **Luo salasana** -sivun **Lataa asetuksia** -kentässä **Manuaalinen**.</span><span class="sxs-lookup"><span data-stu-id="7bd6f-139">On the **Create a secret** page, in the **Upload options** field, select **Manual**.</span></span>
4. <span data-ttu-id="7bd6f-140">Anna salasanan nimi.</span><span class="sxs-lookup"><span data-stu-id="7bd6f-140">Enter the name of the secret.</span></span> <span data-ttu-id="7bd6f-141">Tätä nimeä käytetään palvelun määrittämiseen RCS:ssä (Regulatory Configuration Service) ja sitä kutsutaan *avainsäilön salasananimeksi*.</span><span class="sxs-lookup"><span data-stu-id="7bd6f-141">This name will be used during setup of the service in Regulatory Configuration Service (RCS) and will be referred to as the *key vault secret name*.</span></span>
5. <span data-ttu-id="7bd6f-142">Valitse **Arvo**-kentässä **Jaetun käyttöoikeuden allekirjoituksen URI-tunnus** ja sitten **Luo**.</span><span class="sxs-lookup"><span data-stu-id="7bd6f-142">In the **Value** field, select **Shared Access Signature URI**, and then select **Create**.</span></span>
6. <span data-ttu-id="7bd6f-143">Määritä käyttöoikeuskäytäntö, jolla sähköisen laskutuksen lisäosalle myönnetään asianmukainen suojattu käyttöoikeus luomaasi salasanaan.</span><span class="sxs-lookup"><span data-stu-id="7bd6f-143">Set up the access policy to grant the Electronic invoicing add-on the correct level of secure access to the secret you created.</span></span> <span data-ttu-id="7bd6f-144">Siirry kohtaan **Asetukset \> Käyttöoikeuskäytäntö** ja valitse **Lisää käyttöoikeuskäytäntö**.</span><span class="sxs-lookup"><span data-stu-id="7bd6f-144">Go to **Settings \> Access policy**, and select **Add Access Policy**.</span></span>
7. <span data-ttu-id="7bd6f-145">Määritä salasanaoikeudet toiminnoille **Hae** ja **Luetteloi**.</span><span class="sxs-lookup"><span data-stu-id="7bd6f-145">Set the secret permissions for the **Get** and **List** operations.</span></span>

    ![Palvelun käyttöoikeuksien myöntäminen](media/e-Invoicing-services-create-azure-resources-grant-service-access.png)

8. <span data-ttu-id="7bd6f-147">Määritä varmenneoikeudet toiminnoille **Hae** ja **Luetteloi**.</span><span class="sxs-lookup"><span data-stu-id="7bd6f-147">Set the certificate permissions for **Get** and **List** operations.</span></span>

    ![Varmenneoikeuksien myöntäminen](media/e-Invoicing-services-create-azure-resources-grant-certificate-permission.png)

9. <span data-ttu-id="7bd6f-149">Valitse **Objekti**-valintaikkunassa objekti lisäämällä **Sähköisen laskutuksen lisäosa**.</span><span class="sxs-lookup"><span data-stu-id="7bd6f-149">In the **Principal** dialog box, select the principal by adding **Electronic invoicing add-on**.</span></span>
10. <span data-ttu-id="7bd6f-150">Valitse **Lisää** ja sitten **Tallenna avainsäilön muutokset**.</span><span class="sxs-lookup"><span data-stu-id="7bd6f-150">Select **Add**, and then select **Save Key Vault changes**.</span></span>
11. <span data-ttu-id="7bd6f-151">Kopioi **Yhteenveto**-sivulla avainsäilön **DNS nimi** -arvo.</span><span class="sxs-lookup"><span data-stu-id="7bd6f-151">On the **Overview** page, copy the **DNS name** value for the key vault.</span></span> <span data-ttu-id="7bd6f-152">Tätä arvoa käytetään palvelun RCS:ssä määrittämiseen ja sitä kutsutaan *avainsäilön URI-tunnukseksi*.</span><span class="sxs-lookup"><span data-stu-id="7bd6f-152">This value will be used during setup of the service in RCS and will be referred as the *key vault URI*.</span></span>
