---
title: Ajoitusmoduulin suorituskyvyn parantaminen
description: Tässä ohjeaiheessa on tietoja ajoitusmoduulista ja sen suorituskyvyn parantamisesta.
author: ChristianRytt
manager: tfehr
ms.date: 09/03/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
ms.search.form: ''
audience: Application User
ms.reviewer: kamaybac
ms.search.scope: Core, Operations
ms.custom: 19311
ms.assetid: 5ffb1486-2e08-4cdc-bd34-b47ae795ef0f
ms.search.region: Global
ms.search.industry: ''
ms.author: kamaybac
ms.search.validFrom: 2020-09-03
ms.dyn365.ops.version: ''
ms.openlocfilehash: 1c1b940754021956998fe27ba16020d4b16aedf1
ms.sourcegitcommit: 49f3011b8a6d8cdd038e153d8cb3cf773be25ae4
ms.translationtype: HT
ms.contentlocale: fi-FI
ms.lasthandoff: 10/16/2020
ms.locfileid: "4015064"
---
# <a name="improve-scheduling-engine-performance"></a><span data-ttu-id="5e629-103">Ajoitusmoduulin suorituskyvyn parantaminen</span><span class="sxs-lookup"><span data-stu-id="5e629-103">Improve scheduling engine performance</span></span>

[!include [banner](../includes/banner.md)]

<span data-ttu-id="5e629-104">Resurssien ajoitusmoduulia käytetään suunniteltujen ja vapautettujen tuotantotilausten reittien aikatauluttamiseen.</span><span class="sxs-lookup"><span data-stu-id="5e629-104">The resource scheduling engine is used when scheduling routes for planned and released production orders.</span></span> <span data-ttu-id="5e629-105">Moduuli julkaistiin alun perin Dynamics AX 2012:n osana, ja sitä on parannettu useita kertoja julkaisun jälkeen.</span><span class="sxs-lookup"><span data-stu-id="5e629-105">The engine was originally released as part of Dynamics AX 2012 and has gone through several improvements since its release.</span></span>

<span data-ttu-id="5e629-106">[JSS (job shop scheduling) -ongelma](https://en.wikipedia.org/wiki/Job_shop_scheduling) on erittäin monimutkainen kombinatorinen ongelma, jossa ratkaisuaika kasvaa eksponentiaalisesti päätöksen muuttujien määrän mukaan.</span><span class="sxs-lookup"><span data-stu-id="5e629-106">The [job shop scheduling problem](https://en.wikipedia.org/wiki/Job_shop_scheduling) is an extremely complex combinatorial problem where solution time grows exponentially with the number of decision variables.</span></span> <span data-ttu-id="5e629-107">Asiakkaat määrittävät usein tuotantoreitit ja liittyvät tiedot siten, että tuloksena on aikataulutusongelma, jota ei ratkaista kohtuullisessa ajassa kaikkein uusimmillakaan laitteilla.</span><span class="sxs-lookup"><span data-stu-id="5e629-107">Oftentimes, customers set up production routes and related data in a way that results in a scheduling problem that can't be solved in reasonable time even on the most modern hardware.</span></span> <span data-ttu-id="5e629-108">Tässä ohjeaiheessa käsitellään ajoitusmoduulia ja tapaa, jolla tietyt määritykset voivat vaikuttaa suorituskykyyn.</span><span class="sxs-lookup"><span data-stu-id="5e629-108">This topic will help you understand the scheduling engine and how a specific setup can have influence on the performance.</span></span>

<span data-ttu-id="5e629-109">Aikatauluttamisen suorituskykyä parannettaessa yleisesti suositellaan yksinkertaistamaan ongelmaa, joka moduulin on ratkaistava.</span><span class="sxs-lookup"><span data-stu-id="5e629-109">When it comes to improving the performance of the scheduling, general guidelines recommend reducing the complexity of the problem the engine needs to solve.</span></span> <span data-ttu-id="5e629-110">Keskeisiä suorituskykyyn vaikuttavia tekijöitä ovat esimerkiksi seuraavat:</span><span class="sxs-lookup"><span data-stu-id="5e629-110">Some of the main factors that can affect performance include:</span></span>

- <span data-ttu-id="5e629-111">Reitit, joissa on useita työvaiheita</span><span class="sxs-lookup"><span data-stu-id="5e629-111">Routes with many operations</span></span>
- <span data-ttu-id="5e629-112">Reitit, joissa on samanaikaisia työvaiheita</span><span class="sxs-lookup"><span data-stu-id="5e629-112">Routes with parallel operations</span></span>
- <span data-ttu-id="5e629-113">Työvaiheet, joissa resurssien määrä on suurempi kuin yksi</span><span class="sxs-lookup"><span data-stu-id="5e629-113">Operations with quantity of resources higher than one</span></span>
- <span data-ttu-id="5e629-114">Työvaiheet, joissa on useita käytettäviä resursseja</span><span class="sxs-lookup"><span data-stu-id="5e629-114">Operations with many applicable resources</span></span>
- <span data-ttu-id="5e629-115">Kiinteiden linkkien käyttö</span><span class="sxs-lookup"><span data-stu-id="5e629-115">Use of hard links</span></span>
- <span data-ttu-id="5e629-116">Rajallisen kapasiteetin käyttö</span><span class="sxs-lookup"><span data-stu-id="5e629-116">Use of finite capacity</span></span>
- <span data-ttu-id="5e629-117">Käytettyjen kalenterien määrä</span><span class="sxs-lookup"><span data-stu-id="5e629-117">The number of different calendars used</span></span>
- <span data-ttu-id="5e629-118">Kalenterissa olevien ajankohtien päiväkohtainen määrä</span><span class="sxs-lookup"><span data-stu-id="5e629-118">The number of working time slots per day in the calendar</span></span>
- <span data-ttu-id="5e629-119">Reitin kokonaiskesto</span><span class="sxs-lookup"><span data-stu-id="5e629-119">Total duration of the route</span></span>
- <span data-ttu-id="5e629-120">Useiden ajoitusmoduulien suorittaminen samanaikaisesti</span><span class="sxs-lookup"><span data-stu-id="5e629-120">Running multiple scheduling engines in parallel</span></span>

## <a name="overview-of-basic-scheduling-flow"></a><span data-ttu-id="5e629-121">Ajoituksen perustyönkulun yleiskatsaus</span><span class="sxs-lookup"><span data-stu-id="5e629-121">Overview of basic scheduling flow</span></span>

<span data-ttu-id="5e629-122">Tietyn määrityksen vaikutusta suorituskykyyn selvitettäessä on tärkeää tietää ainakin jossain määrin, miten prosessi etenee sekä moduulissa että sitä ympäröivässä X++-koodissa.</span><span class="sxs-lookup"><span data-stu-id="5e629-122">To understand how a given setup can affect performance, it is important to understand something about how the process flows, both inside the engine and in the X++ code that surrounds it.</span></span>

<span data-ttu-id="5e629-123">Aikataulutuksen perusprosessissa on kolme päävaihetta:</span><span class="sxs-lookup"><span data-stu-id="5e629-123">The basic process of scheduling an order consists of three main steps:</span></span>

- <span data-ttu-id="5e629-124">**Tietojen lataaminen** – X++-tietomallit muunnetaan tässä vaiheessa moduulin sisäiseksi tietomalliksi töinä ja rajoituksina.</span><span class="sxs-lookup"><span data-stu-id="5e629-124">**Loading data** – Here, the X++ data models are transformed into the engine's internal data model in the form of jobs and constraints.</span></span>
- <span data-ttu-id="5e629-125">**Aikatauluttaminen** – Tämä vaihe aikataulutuksen päälähde, joka käsittelee annetun mallin ja rajoitteet sekä muodostaa tuloksen.</span><span class="sxs-lookup"><span data-stu-id="5e629-125">**Scheduling** – This is the main source for scheduling that processes the given model and constraints, and generates a result.</span></span> <span data-ttu-id="5e629-126">Moduuli pyytää tämän prosessin aikana tarvittaessa työaikaa koskevia tietoja ja aiemmin luotuja kapasiteetin varauksia X++-koodista.</span><span class="sxs-lookup"><span data-stu-id="5e629-126">During this process, the engine will request working time information and existing capacity reservations from X++ as needed.</span></span>
- <span data-ttu-id="5e629-127">**Tietojen tallennus** – X++-koodi käsittelee moduulin tuloksena olevat työn kapasiteetin varauksen ajankohdat, jolloin kapasiteetin varaukset tallennetaan sekä töiden/työvaiheen/tilauksen alkamis- ja päättymisajat päivitetään.</span><span class="sxs-lookup"><span data-stu-id="5e629-127">**Save data** – The engine result in the form of job capacity reservation slots is processed by X++ code to save capacity reservations and update the start and end times of the jobs/operation/order.</span></span>

## <a name="load-data-into-the-engine"></a><span data-ttu-id="5e629-128">Tietojen lataaminen moduuliin</span><span class="sxs-lookup"><span data-stu-id="5e629-128">Load data into the engine</span></span>

<span data-ttu-id="5e629-129">Ajoitusmoduulissa on Supply Chain Managementin tietokantaa abstraktimpi tietomalli, koska se on muodostettu yleisenä moduulina, joka voi käsitellä erilaisia tietolähteitä.</span><span class="sxs-lookup"><span data-stu-id="5e629-129">The scheduling engine has a more abstract data model than the Supply Chain Management database because it has been built as a generic engine that can handle different sources of data.</span></span> <span data-ttu-id="5e629-130">Reitin, toissijaisten työvaiheiden ja suoritusajan käsitteet on muunnettava yleiseksi työ- ja rajoitusmalliksi, jonka moduuli tuo näkyviin.</span><span class="sxs-lookup"><span data-stu-id="5e629-130">The concepts of route, secondary operations, and run time need to be "translated" into the generic job and constraint model that the engine exposes.</span></span> <span data-ttu-id="5e629-131">Mallin muodostamislogiikka sisältää merkittävän osan liiketoimintalogiikkaa ja se vaihtelee lähdetietojen mukaan.</span><span class="sxs-lookup"><span data-stu-id="5e629-131">The logic for building the model has a significant amount of business logic to it and is different depending on the source data.</span></span> <span data-ttu-id="5e629-132">Vastaava X++-luokka on `WrkCtrScheduler` ja siinä on johdetut luokat suunniteltuja tuotantotilauksia, vapautettuja tuotantotilauksia ja projektiennusteita varten.</span><span class="sxs-lookup"><span data-stu-id="5e629-132">The responsible X++ class is `WrkCtrScheduler` and it has derived classes for planned production orders, released production orders, and project forecasts.</span></span>

<span data-ttu-id="5e629-133">Käytetään esimerkkinä seuraavassa taulukossa ja kuvassa näkyvää reittiä, joka vaikuttaa olevan suhteellisen yksinkertainen.</span><span class="sxs-lookup"><span data-stu-id="5e629-133">As an example, consider a route shown in the following table and image, which seems relatively simple.</span></span>

| <span data-ttu-id="5e629-134">Työv.</span><span class="sxs-lookup"><span data-stu-id="5e629-134">Oper.</span></span> <span data-ttu-id="5e629-135">Nro</span><span class="sxs-lookup"><span data-stu-id="5e629-135">No.</span></span> | <span data-ttu-id="5e629-136">Prioriteetti</span><span class="sxs-lookup"><span data-stu-id="5e629-136">Priority</span></span> | <span data-ttu-id="5e629-137">Asetusaika</span><span class="sxs-lookup"><span data-stu-id="5e629-137">Setup time</span></span> | <span data-ttu-id="5e629-138">Ajoaika</span><span class="sxs-lookup"><span data-stu-id="5e629-138">Run time</span></span> | <span data-ttu-id="5e629-139">Jonotusaika jälkeen</span><span class="sxs-lookup"><span data-stu-id="5e629-139">Queue time after</span></span> | <span data-ttu-id="5e629-140">Resurssien määrä</span><span class="sxs-lookup"><span data-stu-id="5e629-140">Quantity of resources</span></span> | <span data-ttu-id="5e629-141">Seuraava</span><span class="sxs-lookup"><span data-stu-id="5e629-141">Next</span></span> |
| --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="5e629-142">10</span><span class="sxs-lookup"><span data-stu-id="5e629-142">10</span></span> | <span data-ttu-id="5e629-143">Ensisijainen</span><span class="sxs-lookup"><span data-stu-id="5e629-143">Primary</span></span> | <span data-ttu-id="5e629-144">1.00</span><span class="sxs-lookup"><span data-stu-id="5e629-144">1.00</span></span> | <span data-ttu-id="5e629-145">2.00</span><span class="sxs-lookup"><span data-stu-id="5e629-145">2.00</span></span> | | <span data-ttu-id="5e629-146">1</span><span class="sxs-lookup"><span data-stu-id="5e629-146">1</span></span> | <span data-ttu-id="5e629-147">20</span><span class="sxs-lookup"><span data-stu-id="5e629-147">20</span></span> |
| <span data-ttu-id="5e629-148">10</span><span class="sxs-lookup"><span data-stu-id="5e629-148">10</span></span> | <span data-ttu-id="5e629-149">Toissijainen&nbsp;1</span><span class="sxs-lookup"><span data-stu-id="5e629-149">Secondary&nbsp;1</span></span> | | | | <span data-ttu-id="5e629-150">1</span><span class="sxs-lookup"><span data-stu-id="5e629-150">1</span></span> | <span data-ttu-id="5e629-151">20</span><span class="sxs-lookup"><span data-stu-id="5e629-151">20</span></span> |
| <span data-ttu-id="5e629-152">20</span><span class="sxs-lookup"><span data-stu-id="5e629-152">20</span></span> | <span data-ttu-id="5e629-153">Ensisijainen</span><span class="sxs-lookup"><span data-stu-id="5e629-153">Primary</span></span> | | <span data-ttu-id="5e629-154">3.00</span><span class="sxs-lookup"><span data-stu-id="5e629-154">3.00</span></span> | <span data-ttu-id="5e629-155">1.00</span><span class="sxs-lookup"><span data-stu-id="5e629-155">1.00</span></span> | <span data-ttu-id="5e629-156">3</span><span class="sxs-lookup"><span data-stu-id="5e629-156">3</span></span> | <span data-ttu-id="5e629-157">0</span><span class="sxs-lookup"><span data-stu-id="5e629-157">0</span></span> |

<span data-ttu-id="5e629-158">![Reittikaavioesimerkki](media/scheduling-engine-route.png "Reittikaavioesimerkki")</span><span class="sxs-lookup"><span data-stu-id="5e629-158">![Example rout diagram](media/scheduling-engine-route.png "Example rout diagram")</span></span>

<span data-ttu-id="5e629-159">Kun tämä lähetetään moduuliin, se jakautuu kahdeksaksi työksi, kuten seuraavassa kuvassa. (Voit suurentaa kuvan valitsemalla sen.)</span><span class="sxs-lookup"><span data-stu-id="5e629-159">When sending this to the engine, it is split out into eight jobs, as shown in the following illustration (select the image to enlarge it).</span></span>

<span data-ttu-id="5e629-160">[![Ajoitusmoduulin työt](media/scheduling-engine-jobs.png "Ajoitusmoduulin työt")](media/scheduling-engine-jobs-large.png)</span><span class="sxs-lookup"><span data-stu-id="5e629-160">[![Scheduling engine jobs](media/scheduling-engine-jobs.png "Scheduling engine jobs")](media/scheduling-engine-jobs-large.png)</span></span>

<span data-ttu-id="5e629-161">Kahden työn välinen vakiolinkki on `FinishStart`. Tämä tarkoittaa sitä, että yhden työn päättymisajan on oltava ennen toisen työn alkamisaikaa.</span><span class="sxs-lookup"><span data-stu-id="5e629-161">The standard link between two jobs is `FinishStart`, meaning that the end time of one job must be before the start time of another job.</span></span> <span data-ttu-id="5e629-162">Koska määrityksen tekijän on oltava sama resurssi, joka tekee myöhemmin prosessin, niiden välillä on `OnSameResource`-rajoituksia.</span><span class="sxs-lookup"><span data-stu-id="5e629-162">Because the setup must be performed by the same resource that will later do the process, there are `OnSameResource` constraints between them.</span></span> <span data-ttu-id="5e629-163">Kohdan 10 ensisijaisen ja toissijaisen työvaiheen välillä on `StartStart`- ja `FinishFinish`-linkit. Tämä tarkoittaa sitä, että kummankin työn on alettava ja päätyttävä samanaikaisesti. `NotOnSameResource`-rajoitukset puolestaan estävät sen, että sama resurssi ei voi olla ensisijainen ja toissijainen.</span><span class="sxs-lookup"><span data-stu-id="5e629-163">Between the jobs for primary and secondary operation for 10, there are `StartStart` and `FinishFinish` links, which means that the jobs must both start and end at the same time, and there are `NotOnSameResource` constraints, which will prevent the same resource for primary and secondary.</span></span>

<span data-ttu-id="5e629-164">Työvaiheen 20 resurssien määräksi on määritetty 3, ja prosessityö on jaettuna siinä kolmeksi erilliseksi työksi, jossa kaikki työt on suoritettava täsmälleen samanaikaisesti.</span><span class="sxs-lookup"><span data-stu-id="5e629-164">For operation 20, where the quantity of resources has been set to 3, the process job has been split into three distinct jobs where all the jobs must run at the exact same time.</span></span>
<span data-ttu-id="5e629-165">Tässä tapauksessa reittiryhmä on määritetty olevaan varaamatta kapasiteettia jonolle aikojen jälkeen, minkä vuoksi jälkeen tulevassa jonossa on vain yksi työ.</span><span class="sxs-lookup"><span data-stu-id="5e629-165">In this case, the route group has been set up to not reserve capacity for queue after times, which is why there is only a single job for the queue after.</span></span>

<span data-ttu-id="5e629-166">Ajoitusmoduuli ymmärtää vain töiden käsitteen eikä tiedä, mitä työvaiheet ovat.</span><span class="sxs-lookup"><span data-stu-id="5e629-166">The scheduling engine only understands the concepts of jobs and has no notion of operations.</span></span> <span data-ttu-id="5e629-167">Tämän vuoksi työvaiheita aikataulutettaessa myös työvaiheet jaetaan töiksi, joita ei kuitenkaan säilytetä tietokannassa.</span><span class="sxs-lookup"><span data-stu-id="5e629-167">This means that when doing operation scheduling, the operations are also split into jobs, although these will not be persisted in the database.</span></span>

<span data-ttu-id="5e629-168">Jokaiselle työlle määritetään myös työn kapasiteettitarve (tarvittavien sekuntien määrä).</span><span class="sxs-lookup"><span data-stu-id="5e629-168">For each job, we will also define what the job capacity requirement is (the number of seconds required).</span></span> <span data-ttu-id="5e629-169">Resurssitarpeiden määritysten mukaan kullekin työlle voidaan lähettää myös luettelo kaikista mahdollisesti sopivista resursseista, joilla työ voitaisiin suorittaa, ja mikä on resurssitarve on kyseiselle resurssille.</span><span class="sxs-lookup"><span data-stu-id="5e629-169">Depending on how the resource requirements have been defined, we may also, for each job, send a list of all the potential applicable resources that the job could run on and what the capacity requirement is for that specific resource.</span></span> <span data-ttu-id="5e629-170">Vaikka luettelo sopivista resursseista lähetetään mallia muodostettaessa, moduulin on silti varmistettava, että resurssimääritys on voimassa koko työn keston ajan.</span><span class="sxs-lookup"><span data-stu-id="5e629-170">Even though the list of applicable resources is sent when building the model, the engine will still need to ensure that the resource assignment is actually valid for the entire job duration.</span></span>

## <a name="scheduling-engine-internals"></a><span data-ttu-id="5e629-171">Moduulin sisäisten toimintojen aikatauluttaminen</span><span class="sxs-lookup"><span data-stu-id="5e629-171">Scheduling engine internals</span></span>

### <a name="scheduling-engine-interface"></a><span data-ttu-id="5e629-172">Moduuliliittymän aikatauluttaminen</span><span class="sxs-lookup"><span data-stu-id="5e629-172">Scheduling engine interface</span></span>

<span data-ttu-id="5e629-173">Moduulin sisäisestä toiminnasta saa parhaan käsityksen tarkastelemalla ulkoisesti näkyvissä olevia toimintoja.</span><span class="sxs-lookup"><span data-stu-id="5e629-173">To get an idea of how the engine works internally, it is best to look at the functionality it exposes externally.</span></span> <span data-ttu-id="5e629-174">X++-koodissa tärkein liittymä `WrkCtrSchedulerEngineInterface`.</span><span class="sxs-lookup"><span data-stu-id="5e629-174">In X++, the main interface is `WrkCtrSchedulerEngineInterface`.</span></span> <span data-ttu-id="5e629-175">Sen menetelmät käsitellään seuraavissa alikohdissa.</span><span class="sxs-lookup"><span data-stu-id="5e629-175">It has the methods described in the following subsections.</span></span>

#### <a name="general-engine"></a><span data-ttu-id="5e629-176">Yleinen moduuli</span><span class="sxs-lookup"><span data-stu-id="5e629-176">General engine</span></span>

| <span data-ttu-id="5e629-177">**Tapa**</span><span class="sxs-lookup"><span data-stu-id="5e629-177">**Method**</span></span> | <span data-ttu-id="5e629-178">**Tarkoitus**</span><span class="sxs-lookup"><span data-stu-id="5e629-178">**Purpose**</span></span> |
| --- | --- |
| `run` | <span data-ttu-id="5e629-179">Aikatauluttaa kaikki ladatut työt ja palauttaa virhekoodin.</span><span class="sxs-lookup"><span data-stu-id="5e629-179">Schedules all loaded jobs and returns the error code.</span></span> |
| `getJobSchedulingSequenceResult` | <span data-ttu-id="5e629-180">Hakee aikataulutuksen tuloksen ja ensimmäisen virhetyön tietyn työ määrittämälle jaksolle.</span><span class="sxs-lookup"><span data-stu-id="5e629-180">Gets the scheduling result and the first error job for the sequence identified by a specific job.</span></span> |
| `validateJobCapacityReservations` | <span data-ttu-id="5e629-181">Vahvistaa kaikkien moduulin tallentamien töiden kapasiteetin varaukset.</span><span class="sxs-lookup"><span data-stu-id="5e629-181">Validates the capacity reservations for all the jobs stored by the engine.</span></span> |
| `setReservationsTimeStamp` | <span data-ttu-id="5e629-182">Lähettää aikaleiman moduuliin, joka on määritetty kaikissa moduulin välimuistissa ajoitettujen töiden uusissa kapasiteetin varauksissa.</span><span class="sxs-lookup"><span data-stu-id="5e629-182">Sends a timestamp to the engine set on all new capacity reservations for the scheduled jobs in the cache of the engine.</span></span> |
| `addPropertyToGroupAggregation` | <span data-ttu-id="5e629-183">Lisää ominaisuuden etuliitteen ominaisuusjoukkoon, jota käytetään, kun kapasiteettia koostetaan.</span><span class="sxs-lookup"><span data-stu-id="5e629-183">Adds a property prefix to the set of properties used when capacity is aggregated.</span></span> |
| `addResource` | <span data-ttu-id="5e629-184">Lisää resurssin ajoitusmoduulin resurssipooliin.</span><span class="sxs-lookup"><span data-stu-id="5e629-184">Adds a resource to the scheduling engine resource pool.</span></span> |
| `addResourceGroup` | <span data-ttu-id="5e629-185">Lisää resurssiryhmän ajoitusmoduulin resurssiryhmäpooliin.</span><span class="sxs-lookup"><span data-stu-id="5e629-185">Adds a resource group to the scheduling engine resource group pool.</span></span> |
| `addResourceGroupMembership` | <span data-ttu-id="5e629-186">Lisää resurssin jäsenenä resurssiryhmään.</span><span class="sxs-lookup"><span data-stu-id="5e629-186">Adds a resource as a member to a resource group.</span></span> |
| `addOptimizationGoal` | <span data-ttu-id="5e629-187">Lisää aikataulutuksen optimointitavoitteen (keston tai prioriteetin).</span><span class="sxs-lookup"><span data-stu-id="5e629-187">Adds a scheduling optimization goal (duration or priority).</span></span> |

#### <a name="individual-jobs"></a><span data-ttu-id="5e629-188">Yksittäiset työt</span><span class="sxs-lookup"><span data-stu-id="5e629-188">Individual jobs</span></span>

| <span data-ttu-id="5e629-189">**Tapa**</span><span class="sxs-lookup"><span data-stu-id="5e629-189">**Method**</span></span> | <span data-ttu-id="5e629-190">**Tarkoitus**</span><span class="sxs-lookup"><span data-stu-id="5e629-190">**Purpose**</span></span> |
| --- | --- |
| `addJobInfo` | <span data-ttu-id="5e629-191">Lisää työtietotietueen, joka ilmoittaa moduulille ajoitettavasta työstä.</span><span class="sxs-lookup"><span data-stu-id="5e629-191">Adds a job information record that informs the engine about a job that should be scheduled.</span></span> |
| `addConstraintJobEndsAt` | <span data-ttu-id="5e629-192">Lisää rajoituksen, jonka mukaan työn on päätyttävä määritettynä päivänä ja aikana.</span><span class="sxs-lookup"><span data-stu-id="5e629-192">Adds a constraint that a job should end at a specified date and time.</span></span> |
| `addConstraintJobStartsAt` | <span data-ttu-id="5e629-193">Lisää rajoituksen, jonka mukaan työn on alettava määritettynä päivänä ja aikana.</span><span class="sxs-lookup"><span data-stu-id="5e629-193">Adds a constraint that a job should start at a specified date and time.</span></span> |
| `addConstraintMaxJobDays` | <span data-ttu-id="5e629-194">Määrittää rajoituksen, jonka mukaan työ voi kestää enintään määritetyn määrän päiviä.</span><span class="sxs-lookup"><span data-stu-id="5e629-194">Defines the constraint that a job can span over a specified maximal number of days.</span></span> |
| `addConstraintResourceRequirement` | <span data-ttu-id="5e629-195">Lisää rajoituksen, jonka mukaan työ aikataulutettava tietyssä resurssissa.</span><span class="sxs-lookup"><span data-stu-id="5e629-195">Adds the constraint that the job must be scheduled on a specific resource.</span></span> |
| `addJobBindPriority` | <span data-ttu-id="5e629-196">Lisää työn sidonnan prioriteetin (työ, rajoitustaso) parille.</span><span class="sxs-lookup"><span data-stu-id="5e629-196">Adds a job bind priority for a (job, constraint level) pair.</span></span> <span data-ttu-id="5e629-197">Mitä korkeampi prioriteetin arvo on, sitä aiemmin työn muuttujat sidotaan.</span><span class="sxs-lookup"><span data-stu-id="5e629-197">A higher priority value means the job variables will be bound earlier.</span></span> <span data-ttu-id="5e629-198">Työ käsitellään ennen töitä, joiden prioriteetin arvo samassa jaksossa on alhaisempi.</span><span class="sxs-lookup"><span data-stu-id="5e629-198">The job will be processed before jobs with lower priority value in the same sequence.</span></span> |
| `addJobCapacity` | <span data-ttu-id="5e629-199">Lisää kapasiteetin kuormituksen työlle (kuten pakollisen työn suorituspalvelun) riippumatta siitä, missä resurssissa työ suoritetaan.</span><span class="sxs-lookup"><span data-stu-id="5e629-199">Adds capacity load information for a job (like the required job runtime) independent on which resource the job runs on.</span></span> |
| `addJobResourceCapacity` | <span data-ttu-id="5e629-200">Lisää resurssin resurssijoukkoon, jolla voidaan suorittaa työ, ja ilmaisee kyseisen resurssin suorittamiseen tarvittavan kapasiteetin.</span><span class="sxs-lookup"><span data-stu-id="5e629-200">Adds a resource to the set of resources that may be used to perform a job, and states the capacity required when running on that resource.</span></span> |
| `addJobGoal` | <span data-ttu-id="5e629-201">Lisää työn tavoitetyypit tietylle rajoitustasolle (varhaisin päättymisaika tai myöhäisin alkamisaika).</span><span class="sxs-lookup"><span data-stu-id="5e629-201">Adds job goal information for a specific constraint level (earliest end time or latest start time).</span></span> |
| `addJobResourcePriority` | <span data-ttu-id="5e629-202">Lisää prioriteetin, jota käytetään, kun työ aikataulutetaan resurssille.</span><span class="sxs-lookup"><span data-stu-id="5e629-202">Adds the priority to use when a job is scheduled on a resource.</span></span> |
| `addJobResourceRuntime` | <span data-ttu-id="5e629-203">Määrittää työn ajan, joka on riippuvainen resurssista, johon työ aikataulutetaan.</span><span class="sxs-lookup"><span data-stu-id="5e629-203">Specifies a job time that is dependent of the resource the job will be scheduled on.</span></span> |
| `addJobRuntime` | <span data-ttu-id="5e629-204">Määrittää työn ajan, joka ei ole riippuvainen resurssista, johon työ aikataulutetaan.</span><span class="sxs-lookup"><span data-stu-id="5e629-204">Specifies a job time that is independent of the resource on which the job will be scheduled.</span></span> |
| `scheduleJobOnResourceGroup` | <span data-ttu-id="5e629-205">Merkitsee työn aikataulutettavaksi resurssiryhmätasolla.</span><span class="sxs-lookup"><span data-stu-id="5e629-205">Marks a job for scheduling on the resource group level.</span></span> |
| `setJobResourcePreemptionAllowed` | <span data-ttu-id="5e629-206">Määrittää, onko työn etuosto sallittu resurssin työlle (jos moduuli saa aikatauluttaa työn epäyhtenäiset kapasiteettipaikat).</span><span class="sxs-lookup"><span data-stu-id="5e629-206">Sets whether preemption is allowed for a job on a resource (if engine is allowed to schedule the job in noncontiguous capacity slots).</span></span> |
| `setRequiredNumberOfResources` | <span data-ttu-id="5e629-207">Määrittää työn ajoittamiseen tarvittavien resurssien määrän (vain työvaiheiden ajoituksessa).</span><span class="sxs-lookup"><span data-stu-id="5e629-207">Sets the number of resources required to schedule a job (only for operations scheduling).</span></span> |

#### <a name="constraints-between-jobs"></a><span data-ttu-id="5e629-208">Töiden väliset rajoitukset</span><span class="sxs-lookup"><span data-stu-id="5e629-208">Constraints between jobs</span></span>

| <span data-ttu-id="5e629-209">**Tapa**</span><span class="sxs-lookup"><span data-stu-id="5e629-209">**Method**</span></span> | <span data-ttu-id="5e629-210">**Tarkoitus**</span><span class="sxs-lookup"><span data-stu-id="5e629-210">**Purpose**</span></span> |
| --- | --- |
| `addJobLink` | <span data-ttu-id="5e629-211">Lisää linkin (kuten finish\>start) kahden työn välille.</span><span class="sxs-lookup"><span data-stu-id="5e629-211">Adds a link (such as finish\>start) between two jobs.</span></span> |
| `addConstraintEndsDelayed` | <span data-ttu-id="5e629-212">Määrittää rajoituksen, jonka mukaan työ ei voi päättyä, ennen kuin toiset työt päättyvät. Sisältää myös viiveajan.</span><span class="sxs-lookup"><span data-stu-id="5e629-212">Defines the constraint that a job cannot end before another jobs end plus some delay time.</span></span> |
| `addConstraintJobListWorkingTimeIntersect` | <span data-ttu-id="5e629-213">Lisää rajoituksen, jonka mukaan töille varattujen kapasiteettipaikkojen on oltava töiden käyttämien kahden resurssin työaikojen leikkauskohdassa.</span><span class="sxs-lookup"><span data-stu-id="5e629-213">Adds a constraint that the capacity slots reserved for the jobs must be on the intersecting working times for the two resources used by the jobs.</span></span> |
| `addConstraintJobOverlap` | <span data-ttu-id="5e629-214">Lisää rajoituksen, joka määrittää, miten työt jaksotetaan, kun annettua nimikkeen määrää voidaan siirtää kahden resurssin välillä silloin, kun ensimmäisten resurssin käsittelyä ei ole käsitelty. Tällä tavoin toinen resurssi voi aloittaa käsittelyn.</span><span class="sxs-lookup"><span data-stu-id="5e629-214">Add a constraint that defines how jobs are sequenced when a given quantity of an item can be moved between two resources while the first resource is still not finished processing, so that the second resource can start processing.</span></span> |
| `addConstraintNotOnSameResource` | <span data-ttu-id="5e629-215">Lisää rajoituksen, jonka mukaan kahta työtä ei saa aikatauluttaa samalle resurssille.</span><span class="sxs-lookup"><span data-stu-id="5e629-215">Adds a constraint that two jobs should not be scheduled on the same resource.</span></span> |
| `addConstraintOnSameResource` | <span data-ttu-id="5e629-216">Lisää rajoituksen, jonka mukaan kahden työn on käytettävä samaa resurssia.</span><span class="sxs-lookup"><span data-stu-id="5e629-216">Adds a constraint that two jobs must be using the same resource.</span></span> |
| `addJobSameReservations` | <span data-ttu-id="5e629-217">Lisää rajoituksen, jonka mukaan työn kapasiteetin varauksen on oltava samassa ajankohdassa kuin ensisijainen työ.</span><span class="sxs-lookup"><span data-stu-id="5e629-217">Adds a constraint that a job must end up having capacity reservations for the same time slots as the primary job.</span></span> |
| `setPrimaryParallelJob` | <span data-ttu-id="5e629-218">Lisää tietoja siitä, mikä työ on ensisijainen työ samanaikaisten töiden joukossa.</span><span class="sxs-lookup"><span data-stu-id="5e629-218">Adds information about what job is the primary job in a set of parallel jobs.</span></span> |

### <a name="solver"></a><span data-ttu-id="5e629-219">Selvitys</span><span class="sxs-lookup"><span data-stu-id="5e629-219">Solver</span></span>

<span data-ttu-id="5e629-220">Moduuli itsessään on käytännössä erikoistunut rajoitusten selvitystoiminto, johon on lisätty mukautettua heuristiikkaa.</span><span class="sxs-lookup"><span data-stu-id="5e629-220">The engine itself is essentially a specialized constraint solver with custom heuristics added.</span></span> <span data-ttu-id="5e629-221">Selvitystoiminto perustuu kahteen pääelementtiin: muuttujiin ja rajoituksiin.</span><span class="sxs-lookup"><span data-stu-id="5e629-221">The solver is based on two main elements: variables and constraints.</span></span>

#### <a name="variable"></a><span data-ttu-id="5e629-222">Muuttuva</span><span class="sxs-lookup"><span data-stu-id="5e629-222">Variable</span></span>

<span data-ttu-id="5e629-223">Muuttuja vastaa mahdollisten arvojen toimialuetta.</span><span class="sxs-lookup"><span data-stu-id="5e629-223">A variable represents a domain of possible values.</span></span> <span data-ttu-id="5e629-224">Ajoitusmoduulissa on kahdentyyppisiä muuttujia:</span><span class="sxs-lookup"><span data-stu-id="5e629-224">Scheduling engine has two types of variables:</span></span>

- <span data-ttu-id="5e629-225">**Päivämäärä- ja aikamuuttuja** – Sisältää kaikkien päivämäärien ja kellonaikojen toimialueen. Toimialuetta voidaan rajoittaa siirtämällä muuttujan kellonajan ala- ja ylärajaa lähemmäksi toisiaan.</span><span class="sxs-lookup"><span data-stu-id="5e629-225">**DateTime variable** - Has a domain of all dates and times, and the domain can be restricted by moving the lower and upper bound for the time of the variable closer to each other.</span></span>
- <span data-ttu-id="5e629-226">**Resurssimuuttuja** – Sisältää käytettävien resurssien toimialueen. Toimialuetta voidaan rajoittaa poistamalla resursseja luettelosta.</span><span class="sxs-lookup"><span data-stu-id="5e629-226">**Resource variable** - Has a domain of applicable resources, and the domain can be restricted by eliminating resources from the list.</span></span>

#### <a name="constraint"></a><span data-ttu-id="5e629-227">Rajoitus</span><span class="sxs-lookup"><span data-stu-id="5e629-227">Constraint</span></span>

<span data-ttu-id="5e629-228">Rajoitus rajoittaa muuttujien toimialueita. Samalla se on kuitenkin riippuvainen muuttujista, joten se aktivoituu, kun muuttujat muuttuvat.</span><span class="sxs-lookup"><span data-stu-id="5e629-228">A constraint acts on variables by restricting their domains, but it also depends on variables so it gets activated when variables change.</span></span> <span data-ttu-id="5e629-229">Rajoituksen levittämisprosessi tapahtuu, kun rajoitus suorittaa päätoimintoaan ja raportoi takaisin päälogiikkaan, jos se onnistuu.</span><span class="sxs-lookup"><span data-stu-id="5e629-229">The process of "constraint propagation" is when a constraint performs its main function and reports back to the main logic if successful.</span></span>

<span data-ttu-id="5e629-230">Muuttujaa pidetään sidottuna, kun sitä ei voi enää rajoittaa. Päivämäärä- ja aikamuuttujan osalta tämä tarkoittaa, että sidonta on sama ylhäällä ja alhaalla, ja resurssimuuttujan osalta se tarkoittaa, että sillä on vain yksi käytettävä resurssi.</span><span class="sxs-lookup"><span data-stu-id="5e629-230">A variable is considered bound when it can't be restricted further, which for DateTime variable means that upper and lower bound is the same, and for the Resource variable that it has only a single applicable resource.</span></span> <span data-ttu-id="5e629-231">Kun kaikki muuttujat sidotaan, ratkaisu on löytynyt.</span><span class="sxs-lookup"><span data-stu-id="5e629-231">When all variables are bound, a solution is found.</span></span>

### <a name="constraint-levels"></a><span data-ttu-id="5e629-232">Rajoitustasot</span><span class="sxs-lookup"><span data-stu-id="5e629-232">Constraint levels</span></span>

<span data-ttu-id="5e629-233">Kun aikatauluttaminen suoritetaan materiaalitarpeiden suunnittelun (MRP) vaiheessa, tilaukset aikataulutetaan tarvepäivästä taaksepäin.</span><span class="sxs-lookup"><span data-stu-id="5e629-233">When scheduling is executed as part of the material requirements planning (MRP) coverage phase, the orders will be scheduled backward from requirement date.</span></span> <span data-ttu-id="5e629-234">Jos kuluvana päivänä tai myöhemmin alkavaa ja ennen tarvepäivää päättyvää aikataulua ei löydy, aikataulutuksen suunta muuttuu eteenpäin kuluvasta päivästä.</span><span class="sxs-lookup"><span data-stu-id="5e629-234">However, if it is not possible to find a schedule that starts today or later and ends before the requirement date, then the scheduling direction will change to forward from today.</span></span>

<span data-ttu-id="5e629-235">Tämä pääliiketoimintasääntö käsitellään järjestelmällä rajoitukset tasoihin.</span><span class="sxs-lookup"><span data-stu-id="5e629-235">This main business rule is handled by organizing the constraints in levels.</span></span> <span data-ttu-id="5e629-236">Jos ratkaisua ei löydy, kun rajoituksia käytetään korkeimmalla tasolla, kaikki kyseisen tason rajoitukset jätetään pois ja alempaa tasoa kokeillaan.</span><span class="sxs-lookup"><span data-stu-id="5e629-236">If no solution is found when using the constraints on the highest level, then the constraints on that level are all dropped, and the lower level is tried.</span></span> <span data-ttu-id="5e629-237">Käytännössä tämä tarkoittaa, että taaksepäin suuntautuvassa aikataulutuksessa mallin tasolla 1 on myöhäisimmän aloitusajan työn tavoitteet annetulla suurimmalla päättymisaikarajoituksella (tarvepäivä) ja tasolla 0 on aikaisimman päättymisajan työn tavoitteet annetulla kuluvan päivän pienimmällä aloitusaikarajoituksella.</span><span class="sxs-lookup"><span data-stu-id="5e629-237">In praxis, this means that for backward scheduling the model will contain a level 1 with job goals of latest start time given a maximum end time constraint (the requirement date), and a level 0 with job goals of earliest end time and given a minimum start time constraint of today.</span></span>

### <a name="algorithm"></a><span data-ttu-id="5e629-238">Algoritmi</span><span class="sxs-lookup"><span data-stu-id="5e629-238">Algorithm</span></span>

<span data-ttu-id="5e629-239">Moduulin algoritmin päävaiheet:</span><span class="sxs-lookup"><span data-stu-id="5e629-239">The main steps of the engine algorithm are:</span></span>

1. <span data-ttu-id="5e629-240">Erikseen ratkaistavien jaksojen (työketjujen) etsiminen.</span><span class="sxs-lookup"><span data-stu-id="5e629-240">Find sequences (job chains) which can be solved separately.</span></span>
1. <span data-ttu-id="5e629-241">Yritetään etsiä jaksolle ensin ratkaisu korkeimmalla rajoitustasolla.</span><span class="sxs-lookup"><span data-stu-id="5e629-241">Try to find an initial solution for the sequence for the highest constraint level.</span></span>
    1. <span data-ttu-id="5e629-242">Töiden lajittelu jaksossa työn tavoitteen ja prioriteettien perusteella siten, että aloitustyö löydetään.</span><span class="sxs-lookup"><span data-stu-id="5e629-242">Sort the jobs in the sequence based on job goal and priorities, such that a start job can be found.</span></span>
    1. <span data-ttu-id="5e629-243">Työt toistetaan seuraavassa järjestyksessä:</span><span class="sxs-lookup"><span data-stu-id="5e629-243">Loop the jobs in the following sequence:</span></span>
        1. <span data-ttu-id="5e629-244">Kaikkien levitettävien rajoitusten etsiminen ja levittämisen suorittaminen.</span><span class="sxs-lookup"><span data-stu-id="5e629-244">Find all constraints that need to be propagated and run propagation.</span></span>
        1. <span data-ttu-id="5e629-245">Jos kaikki työn muuttujat on sidottu, kyseisen työn ratkaisu on löydetty.</span><span class="sxs-lookup"><span data-stu-id="5e629-245">If all variables for the job have been bound, then a solution for that job has been found.</span></span>
        1. <span data-ttu-id="5e629-246">Jos yhtä muuttujista ei voitu sitoa rajoituksia rikkomatta, muuttujan sidonta perutaan, toimialueella kokeillaan toista (resurssimuuttujan) arvoa ja rajoituksen levittäminen suoritetaan uudelleen.</span><span class="sxs-lookup"><span data-stu-id="5e629-246">If one of the variables could not be bound without violating the constraints, then roll back the variable binding, try a different value in the domain (for resource variable), and rerun the constraint propagation.</span></span>
1. <span data-ttu-id="5e629-247">Jos ratkaisua ei löydy, kaikki nykyisen rajoitustason rajoitukset poistetaan, rajoitustasoa alennetaan (jos alempia tasoja on käytettävissä) ja ratkaisuhaku suoritetaan uudelleen uudella rajoitusjoukolla.</span><span class="sxs-lookup"><span data-stu-id="5e629-247">If no solution was found, then all constraints on the current constraint level is removed, the constraint level lowered (if any lower levels are available) and solution search retried with the new set of constraint.</span></span>
1. <span data-ttu-id="5e629-248">Jos sopivaa ratkaisua ei löytynyt, optimointivaihe käynnistetään. Se yrittää löytää paremman ratkaisun siihen saakka, että optimointi aikakatkaistaan, tai kaikki resurssiyhdistelmät on kokeiltu.</span><span class="sxs-lookup"><span data-stu-id="5e629-248">If a feasible solution was found, then the optimization phase is started, which will try to find a better solution until the optimization timeout is reached or all resource combinations have been exhausted.</span></span>

<span data-ttu-id="5e629-249">Ratkaisun selvitystoiminto ei ole tietoinen aikataulutusalgoritmin yksityiskohdista.</span><span class="sxs-lookup"><span data-stu-id="5e629-249">The constraint solver is not aware of the specifics of the scheduling algorithm.</span></span> <span data-ttu-id="5e629-250">Ratkaisevaa onkin erilaisten rajoitusten määritelmät ja niiden yhdistelmä.</span><span class="sxs-lookup"><span data-stu-id="5e629-250">It is in the definition and combination of the various constraints that the "magic" happens.</span></span>

### <a name="determining-working-times"></a><span data-ttu-id="5e629-251">Työaikojen määrittäminen</span><span class="sxs-lookup"><span data-stu-id="5e629-251">Determining working times</span></span>

<span data-ttu-id="5e629-252">Suuri osa moduulin (sisäisistä) rajoituksista hallitsee resurssin työaikaa ja kapasiteettia.</span><span class="sxs-lookup"><span data-stu-id="5e629-252">A large part of the (internal) constraints in the engine controls the working time and capacity of a resource.</span></span> <span data-ttu-id="5e629-253">Tehtävänä on siis käydä läpi resurssin työajan ajankohdat tietystä vaiheesta tiettyyn suuntaan ja etsiä riittävän pitkää aikaväliä, joihin kapasiteettia (aikaa) tarvitsevat työt sopivat.</span><span class="sxs-lookup"><span data-stu-id="5e629-253">Essentially, the task is to traverse the working time slots for a resource from a given point in a given direction, and find a long enough interval in which the jobs required capacity (time) can fit.</span></span>

<span data-ttu-id="5e629-254">Sitä varten moduulin on tiedettävä resurssin työajat.</span><span class="sxs-lookup"><span data-stu-id="5e629-254">To do this, the engine needs to know the working times of a resource.</span></span> <span data-ttu-id="5e629-255">Päämallin tiedoista poiketen työajoissa käytetään *tarveohjattua latausta* eli ne ladataan moduuliin, kun niitä tarvitaan.</span><span class="sxs-lookup"><span data-stu-id="5e629-255">Opposite to the main model data, the working times are *lazy loaded* , meaning that they are loaded into the engine as needed.</span></span> <span data-ttu-id="5e629-256">Näin toimitaan siksi, että Supply Chain Managementissa kalenterissa on usein työaikoja hyvin pitkille jaksoille ja yleensä kalentereita on useita, joten valmiiksi ladattavia tietoja olisi paljon.</span><span class="sxs-lookup"><span data-stu-id="5e629-256">The reason for this approach is that there are often working times in Supply Chain Management for a calendar for a very long period and typically many calendars exist so the data would be quite large to pre-load.</span></span>

<span data-ttu-id="5e629-257">Moduuli pyytää kalenteritietoja paloina kutsumalla X++-luokkamenetelmän `WrkCtrSchedulingInteropDataProvider.getWorkingTimes`.</span><span class="sxs-lookup"><span data-stu-id="5e629-257">Calendar information is requested by the engine in chunks, by invoking the X++ class method `WrkCtrSchedulingInteropDataProvider.getWorkingTimes`.</span></span> <span data-ttu-id="5e629-258">Pyyntö koskee tietyn kalenteritunnuksen tiettyä aikaväliä.</span><span class="sxs-lookup"><span data-stu-id="5e629-258">The request is for a specific calendar ID in a specific time interval.</span></span> <span data-ttu-id="5e629-259">Sen mukaan, mikä on palvelimen välimuistin tila Supply Chain Managementissa, kukin näistä pyynnöistä voi päätyä useisiin tietokantakutsuihin, mikä vie paljon aikaa (suhteessa pelkkään laskenta-aikaan).</span><span class="sxs-lookup"><span data-stu-id="5e629-259">Depending on the state of the server cache in Supply Chain Management, each of these requests could end up in several database calls, which takes a long time (relative to the pure computational time).</span></span> <span data-ttu-id="5e629-260">Jos kalenterissa on lisäksi erittäin tarkkoja työaikamääritelmiä ja useita päiväkohtaisia työaikavälejä, myös tämä pidentää latautumisaikaa.</span><span class="sxs-lookup"><span data-stu-id="5e629-260">Also, if the calendar contains very elaborate working time definitions with many working time intervals per day, this adds to the time the loading takes.</span></span>

<span data-ttu-id="5e629-261">Kun työaikatietoja ladataan ajoitusmoduuliin, se säilyttää tietyn kalenterin sisäisessä välimuistissa. Tämä tarkoittaa sitä, että jos jotkin muut työt tai resurssit käyttävät samaa kalenteria, seuraavat haut voidaan tehdä nopeasti muistista.</span><span class="sxs-lookup"><span data-stu-id="5e629-261">When the working time data is loaded in the scheduling engine, this is retained in its internal cache for the specific calendar, meaning that if any other jobs or resources are using the same calendar then the next lookups can be performed quickly from memory.</span></span> <span data-ttu-id="5e629-262">Yksi yleinen syy huonolle suorituskyvylle on se, että kullekin resurssille käytetään erillistä kalenteritunnusta, jolloin kullekin kalenterille on pyydettävä tiedot, vaikka kalenterien sisältö olisi sama.</span><span class="sxs-lookup"><span data-stu-id="5e629-262">One common cause of bad performance is if a separate calendar ID is used for each resource, because data will then need to be requested for each calendar, even though the content of the calendars might be the same.</span></span>

### <a name="finite-capacity"></a><span data-ttu-id="5e629-263">Rajallinen kapasiteetti</span><span class="sxs-lookup"><span data-stu-id="5e629-263">Finite capacity</span></span>

<span data-ttu-id="5e629-264">Rajallista kapasiteettia käytettäessä kalenterin työajan ajankohdat jaetaan ja niitä vähennetään aiemmin luotujen kapasiteetin varausten perusteella.</span><span class="sxs-lookup"><span data-stu-id="5e629-264">When using finite capacity, the working time slots from the calendar are split and reduced based on the existing capacity reservations.</span></span> <span data-ttu-id="5e629-265">Vaikka nämä varaukset noudetaan myös samalla `WrkCtrSchedulingInteropDataProvider`-luokalla kuin kalenterit, niissä käytetään menetelmää `getCapacityReservations`.</span><span class="sxs-lookup"><span data-stu-id="5e629-265">These reservations are also fetched through the same `WrkCtrSchedulingInteropDataProvider` class as the calendars, but instead use the method `getCapacityReservations`.</span></span> <span data-ttu-id="5e629-266">Jos aikataulutus tehdään pääsuunnittelun aikana, tietyn pääsuunnitelman varaukset otetaan huomioon ja, jos **Pääsuunnittelun parametrit** -sivulla on niin määritetty, myös vahvistettujen tuotantotilausten varaukset sisällytetään.</span><span class="sxs-lookup"><span data-stu-id="5e629-266">When scheduling during master planning, the reservations for the specific master plan are considered and if enabled on the **Master planning parameters** page, the reservations from firmed production orders are also included.</span></span> <span data-ttu-id="5e629-267">Vastaavasti myös tuotantotilausta aikataulutettaessa on mahdollista sisällyttää varauksia aiemmin luoduista suunnitelluista tilauksista, vaikka se ei olekaan yhtä yleistä kuin toisin päin.</span><span class="sxs-lookup"><span data-stu-id="5e629-267">Similarly, when scheduling a production order, it is also an option to include reservations from existing planned orders, although this is not as common as the other way around.</span></span>

<span data-ttu-id="5e629-268">Rajallisen kapasiteetin käyttäminen hidastaa aikatauluttamista monesta syystä:</span><span class="sxs-lookup"><span data-stu-id="5e629-268">Using finite capacity will cause scheduling to take longer due to several reasons:</span></span>

- <span data-ttu-id="5e629-269">Kapasiteettitietojen noutaminen tietokannasta on hidasta ja kapasiteettitietojen palvelinpuolen välimuistitallennus ei ole yleensä yhtä tehokasta, sillä niitä ei jaeta resurssien kesken toisin kuin kalenterit, jotka yleensä jaetaan.</span><span class="sxs-lookup"><span data-stu-id="5e629-269">Fetching the capacity information from database is a slow operation and the server-side caching of capacity information is typically not as good as for working times because they are not shared among resources like calendars typically are.</span></span>
- <span data-ttu-id="5e629-270">Läpikäytävien työajan ajankohtien määrä kasvaa jakojen vuoksi, ja pitkiä ajanjaksoja on yleensä tutkittava, ennen kuin ratkaisu löytyy.</span><span class="sxs-lookup"><span data-stu-id="5e629-270">The number of working time slots to traverse increases due to the splits, and slots for a longer time period must typically be investigated before a solution can be found.</span></span>
- <span data-ttu-id="5e629-271">Kun aikataulutus on valmis, ristiriitaiset varaukset on tarkistettava. (Lisätietoja on kohdassa Useiden ajoitusmoduulien suorittaminen samanaikaisesti.)</span><span class="sxs-lookup"><span data-stu-id="5e629-271">After the scheduling is complete, a check for conflicting reservations must be performed (see the "Running scheduling engines in parallel" section for details).</span></span>

### <a name="examining-the-resource-combinations"></a><span data-ttu-id="5e629-272">Resurssiyhdistelmien tutkiminen</span><span class="sxs-lookup"><span data-stu-id="5e629-272">Examining the resource combinations</span></span>

<span data-ttu-id="5e629-273">Jos työjakso sisältää vain `FinishStart`-vakiolinkkejä eli se muodostaa yksinkertaisen ketjun ilman haaroja, optimaalinen tulos (yksittäisestä tilauksesta katsottuna, ei tilausten välillä) saavutetaan etsimällä paras ratkaisu ensimmäiselle työlle ja siirtymällä sitten etsimään parasta ratkaisua seuraavalle työlle.</span><span class="sxs-lookup"><span data-stu-id="5e629-273">If the job sequence only contains the standard `FinishStart` links, meaning it forms a simple chain without any branches, an optimal result (seen from the single order, not across orders) can be achieved by finding the best solution for the first job and then moving on to find the best solution for the next job.</span></span> <span data-ttu-id="5e629-274">Työn paras ratkaisu tarkoittaa sellaisen resurssin etsimistä, jolla saadaan työn tavoitetta lähinnä oleva työn aloitus- ja päättymispäivä (mikä tarkoittaa eteenpäin aikatauluttamisessa mahdollisimman varhaisen työn päättymispäivän hakemista) noudattaen silti samalla rajoituksia.</span><span class="sxs-lookup"><span data-stu-id="5e629-274">The best solution for a job means finding the resource that can get the from and to date of the job closest to the job goal (in forward scheduling this means getting the end date of the job as early as possible) while still respecting the constraints.</span></span>

<span data-ttu-id="5e629-275">Samanaikaisissa töissä ratkaisun etsiminen voi edellyttää eri resurssiyhdistelmien tutkimista.</span><span class="sxs-lookup"><span data-stu-id="5e629-275">When there are parallel jobs, finding a solution may involve examining different combinations of resources.</span></span> <span data-ttu-id="5e629-276">Mahdollisten resurssiyhdistelmien määrä saadaan yhdistettyjen rinnakkaisten töiden käytettävien resurssien määrästä.</span><span class="sxs-lookup"><span data-stu-id="5e629-276">The number of possible resource combinations is the product of the number of applicable resources for the connected parallel jobs.</span></span> <span data-ttu-id="5e629-277">Etenkin aikataulutettaessa tilausta taaksepäin tarvepäivästä voi kestää jonkin aikaa, ennen kuin logiikka tiedostaa, ettei millään ongelman ratkaisulla saada samanaikaisia töitä sopimaan ennen kuluvaa päivää. Niinpä sen on tarkistettava kaikki yhdistelmät, koska saattaa löytyä joitakin tehokkaita resursseja tai eri kalenteri, jolla voidaan saada tulos.</span><span class="sxs-lookup"><span data-stu-id="5e629-277">Especially when scheduling an order backwards from a requirement date, it can take quite a while for the logic to realize that there is no solution to the problem that will make the parallel jobs fit before today's date, as it will need to check all the combinations because there could be some resources that had a higher efficiency or a different calendar that might give a result.</span></span> <span data-ttu-id="5e629-278">Niinpä jos aikakatkaisurajaa ei ole määritetty, logiikkaa suoritetaan pitkään, ennen kuin suunta vaihdetaan eteenpäin.</span><span class="sxs-lookup"><span data-stu-id="5e629-278">This means that if no timeout limit has been set it will run for a long time before changing the direction to forward.</span></span>

<span data-ttu-id="5e629-279">Tämä kombinatorinen logiikka myös tarkoittaa, että käytettävien lisäresurssien lisääminen voi hidastaa moduulin toimintaa.</span><span class="sxs-lookup"><span data-stu-id="5e629-279">This combinatorial logic also means that adding more applicable resources may make the engine run slower.</span></span> <span data-ttu-id="5e629-280">Jos suorituskykyongelmia esiintyy, kun samanaikaisia työvaiheita ja aikataulutusta suoritetaan rajoittamattomalla kapasiteetilla, ongelmat voidaan korjata osittain tekemällä reitin suunnitteluohjelmalla päätös käytettävästä resurssista ja delegoimalla resurssi sitten suoraan työvaiheeseen (sillä moduuli päätyy useimmissa tapauksissa poimimaan saman resurssin, joten lopputulos on sama).</span><span class="sxs-lookup"><span data-stu-id="5e629-280">If performance problems occur when having parallel operations and scheduling with infinite capacity, it can partly be fixed by having the route designer take a decision on which resource should be used and then assign the resource directly on the operation (because the engine in most cases will always end up picking the same resource, so the end result will be the same).</span></span>

### <a name="hard-links"></a><span data-ttu-id="5e629-281">Kiinteät linkit</span><span class="sxs-lookup"><span data-stu-id="5e629-281">Hard links</span></span>

<span data-ttu-id="5e629-282">Kun kahden työn välinen linkkityyppi määritetään kiinteäksi, yhden työn lopettamisen ja seuraavan työn aloittamisen välillä ei ole lainkaan aikaväliä.</span><span class="sxs-lookup"><span data-stu-id="5e629-282">Setting the link type between two jobs to hard, ensures that there is no time gap between the finish of one job and the start of the next one.</span></span> <span data-ttu-id="5e629-283">Tämä voi olla erittäin kätevää skenaarioissa, kuten silloin kun metallia kuumennetaan yhdessä työssä ja sitten prosessoidaan seuraavassa työssä, sillä metallin ei haluta viilenevän vaiheiden välissä.</span><span class="sxs-lookup"><span data-stu-id="5e629-283">This can be very useful in scenarios like when metal is heated in one job and then processed in the next job, where it is not desirable to have the metal cool down in between.</span></span>

<span data-ttu-id="5e629-284">Jos reitti muodostaa vakiomuotoista symbolista linkkiä ja eteenpäin aikatauluttamista käytettäessä yksinkertaisen ketjun ilman haaroja, tulos saadaan etsimällä ensimmäisen työn ratkaisu, joka vastaa omia rajoituksia ja siirtymällä sitten ketjussa edellisen työn päättymisajasta seuraavaan työhön.</span><span class="sxs-lookup"><span data-stu-id="5e629-284">With standard soft links and forward scheduling, if the route forms a simple chain without any branches, a result can be achieved by finding a solution for the first job that satisfies its own constraints and then moving on through the chain propagating the end time from the previous job to the next job.</span></span> <span data-ttu-id="5e629-285">Jos nykyinen työ ei löydä kapasiteettia, sen aloitusaika siirretään eteenpäin välittämättä siitä, että edelliset työt voivat luoda aukkoja töiden väliin.</span><span class="sxs-lookup"><span data-stu-id="5e629-285">If the current job can't find any capacity, the start time for it will be moved out further, without any consequence for the previous jobs potentially creating gaps between the jobs.</span></span> <span data-ttu-id="5e629-286">Jos samassa skenaariossa käytetään kuitenkin kiinteitä linkkejä (etenkin yhdessä rajallisen kapasiteetin kanssa), ketjussa myöhemmin tuleva työ ei löydä kapasiteettia, jolloin kaikkia aiemmin aikataulutettuja töitä on kuljetettava mukana ja siten aikataulutettava uudelleen useita tapoja.</span><span class="sxs-lookup"><span data-stu-id="5e629-286">However with hard links (especially in connection with finite capacity) for the same scenario, the fact that one job later in the chain cannot find capacity, will mean that all previous scheduled jobs will have to be "dragged" along one by one and thereby rescheduled a number of times.</span></span> <span data-ttu-id="5e629-287">Etenkin skenaarioissa, joissa useissa resursseissa on suuri kuormitus, kiinteät linkit voivat aiheuttaa ketjureaktion, jossa kaikki työt vaikuttavat toisiinsa ja suoritettavien iteraatioiden määrään, ennen kuin tulos vakiintuu toimivaksi aikatauluksi.</span><span class="sxs-lookup"><span data-stu-id="5e629-287">Especially in scenarios with high load for multiple resources, the hard links can cause a chain reaction where the jobs will affect each other and a number of iterations will have to be performed before the result stabilizes into a feasible schedule.</span></span>

## <a name="running-scheduling-engines-in-parallel"></a><span data-ttu-id="5e629-288">Ajoitusmoduulien suorittaminen samanaikaisesti</span><span class="sxs-lookup"><span data-stu-id="5e629-288">Running scheduling engines in parallel</span></span>

<span data-ttu-id="5e629-289">Jos aikataulutus suoritetaan osana pääsuunnittelua, jossa käytetään apuosia, jokainen pääsuunnittelun apuosaketju voi poimia myös tuotantotilauksen aikataulutustehtäviä.</span><span class="sxs-lookup"><span data-stu-id="5e629-289">When performing scheduling as part of a master planning run where helpers are used, each of the master planning helper threads can also pick up production order scheduling tasks.</span></span> <span data-ttu-id="5e629-290">Tämän vuoksi samanaikaisesti voidaan suorittaa useita ajoitusmoduuleja.</span><span class="sxs-lookup"><span data-stu-id="5e629-290">This means that multiple scheduling engines can be running at the same time.</span></span> <span data-ttu-id="5e629-291">Vaikka monisäikeisyydestä on yleensä merkittäviä suorituskykyetuja, aikataulutuksen yhteydessä siinä tiettyjä toiminnallisia haittoja.</span><span class="sxs-lookup"><span data-stu-id="5e629-291">While multithreading in general is a highly significant performance benefit, there are also some functional downsides when it comes to scheduling.</span></span>

<span data-ttu-id="5e629-292">Tarvesuunnittelussa kaikki tietyn tuoterakennetason tuotantotilaukset aikataulutetaan tarvepäiväjaksossa, joten tilaukset, joilla on aikaisin tarvepäivä, on aikataulutettava ensimmäisenä. Niinpä ne myös todennäköisimmin saavat käytettävissä olevan resurssin kapasiteetin.</span><span class="sxs-lookup"><span data-stu-id="5e629-292">In MRP, all production orders for a given bill of materials (BOM) level are scheduled in requirement date sequence, meaning that those orders with the earliest requirement date should be scheduled first and thereby have the highest chance of getting the available resource capacity.</span></span> <span data-ttu-id="5e629-293">Jos useat moduulit kuitenkin tekevät poimintoja aikatauluttamattomien tilausten luettelosta, järjestys ei ole enää varma, sillä tilaukset voivat valmistua eri aikaan.</span><span class="sxs-lookup"><span data-stu-id="5e629-293">However, with multiple engines picking from the list of unscheduled orders the sequence is no longer ensured, as one might complete faster than the other.</span></span>

<span data-ttu-id="5e629-294">Jos aikataulutukseen käytetään lisäksi rajallista kapasiteettia ja useat moduuliesiintymät yrittävät aikatauluttaa tilauksia, jotka mahdollisesti käyttävät samoja resursseja samalla aikavälillä, seurauksena voi olla kilpailutilanne.</span><span class="sxs-lookup"><span data-stu-id="5e629-294">Also, when scheduling using finite capacity and when multiple engine instances are trying to schedule orders that are potentially using the same resources at the same time interval, a race condition can occur.</span></span> <span data-ttu-id="5e629-295">Kyseisten kilpailutilanteiden määrä kirjataan **Aikatauluristiriidat** -kenttään pääsuunnitelmien historiasivulla.</span><span class="sxs-lookup"><span data-stu-id="5e629-295">The number of such race conditions is recorded in the **Scheduling conflicts** field on the master plans history page.</span></span> <span data-ttu-id="5e629-296">Ristiriitojen ratkaisulla on seuraava logiikka:</span><span class="sxs-lookup"><span data-stu-id="5e629-296">The conflict resolution logic is as follows:</span></span>

- <span data-ttu-id="5e629-297">Ajoita tilaus (lukitsematta) ja hae kapasiteetin varaukset.</span><span class="sxs-lookup"><span data-stu-id="5e629-297">Schedule an order (lock-free) and get capacity reservations.</span></span>
- <span data-ttu-id="5e629-298">Tee lukitus.</span><span class="sxs-lookup"><span data-stu-id="5e629-298">Take the lock.</span></span>
- <span data-ttu-id="5e629-299">Tarkista, onko aikataulutetuilla resursseilla uusia kapasiteetin varauksia.</span><span class="sxs-lookup"><span data-stu-id="5e629-299">Check if newer capacity reservations exist for the scheduled resources in the timespan.</span></span>
  - <span data-ttu-id="5e629-300">Jos ei, kirjoita kapasiteetti ja avaa lukitus.</span><span class="sxs-lookup"><span data-stu-id="5e629-300">If no, write the capacity and release the lock.</span></span>
  - <span data-ttu-id="5e629-301">Jos kyllä, vapauta lukitus ja aikatauluta tilaus uudelleen alusta alkaen.</span><span class="sxs-lookup"><span data-stu-id="5e629-301">If yes, release the lock and reschedule the order from the beginning.</span></span>

<span data-ttu-id="5e629-302">Niinpä kun useita moduuliesiintymiä aikataulutetaan, tulos ei ole täysin deterministinen, koska tulos määräytyy sen mukaan, mikä on kunkin säikeen ajoitus.</span><span class="sxs-lookup"><span data-stu-id="5e629-302">So, when scheduling with multiple engine instances, the result is not fully deterministic because it will depend on the exact timing of each of the threads.</span></span>

## <a name="operation-scheduling-performance"></a><span data-ttu-id="5e629-303">Työvaiheen aikataulutuksen suorituskyky</span><span class="sxs-lookup"><span data-stu-id="5e629-303">Operation scheduling performance</span></span>

<span data-ttu-id="5e629-304">Vaikka työvaiheen aikataulutusta kutsutaan myös kapasiteetin raakasuunnitteluksi, moduulin kannalta sen ratkaiseminen voi olla hankalaa rajallista kapasiteettia käytettäessä, sillä toimivuuden määrittämiseen tarvitaan enemmän tietoja.</span><span class="sxs-lookup"><span data-stu-id="5e629-304">Even though operation scheduling is also known as rough-cut capacity planning, seen from an engine standpoint, it can be a harder problem to solve if finite capacity is used, as more data is needed to determine feasibility.</span></span>

<span data-ttu-id="5e629-305">Resurssiryhmän kapasiteetti määrittää, mitkä resurssit ja kuinka monta resurssia on resurssiryhmän jäseninä.</span><span class="sxs-lookup"><span data-stu-id="5e629-305">The capacity of a resource group depends on which and how many resources are members of the resource group.</span></span> <span data-ttu-id="5e629-306">Itse resurssiryhmällä ei ole lainkaan kapasiteettia; sillä on kapasiteettia vain silloin, kun resurssit ovat ryhmän jäseniä.</span><span class="sxs-lookup"><span data-stu-id="5e629-306">A resource group in itself does not have any capacity&mdash;only when resources are a member of the group will it have capacity.</span></span> <span data-ttu-id="5e629-307">Koska resurssiryhmän jäsenyys voi vaihdella ajan mittaan, kapasiteetti on laskettava päivittäin.</span><span class="sxs-lookup"><span data-stu-id="5e629-307">Because the resource group membership can vary over time, capacity must be evaluated per day.</span></span>

<span data-ttu-id="5e629-308">Työvaiheiden aikatauluttamisessa resurssiryhmän kalenteria käytetään määrittämään kunkin työvaiheen aloitus- ja päättymisaika.</span><span class="sxs-lookup"><span data-stu-id="5e629-308">In operations scheduling, the resource group's calendar is used to determine the start and end times for each operation.</span></span> <span data-ttu-id="5e629-309">Tämän vuoksi resurssiryhmän kalenteri rajoittaa sitä, kuinka paljon aikaa yhdelle työvaiheelle voidaan aikatauluttaa yhtenä päivänä yhdessä resurssiryhmässä.</span><span class="sxs-lookup"><span data-stu-id="5e629-309">This means that the resource group's calendar places a limit on how much time can be operations scheduled for one operation on one day in one resource group.</span></span> <span data-ttu-id="5e629-310">Toisin kuin tiettyjen resurssien kalenterissa kalenterin tehokkuustiedot ohitetaan resurssiryhmän osalta, sillä siinä ilmoitetaan vain aukioloajat eikä varsinaista kapasiteettia.</span><span class="sxs-lookup"><span data-stu-id="5e629-310">Opposite the calendar for the specific resources, the efficiency data of the calendar is ignored for the resource group as it simply denotes opening hours and not actual capacity.</span></span>

<span data-ttu-id="5e629-311">Jos esimerkiksi resurssiryhmän työaika tiettynä päivänä on 8.00–16.00, yksi työvaihe ei voi kuormittaa resurssiryhmää enemmän kuin mahtuu 8 tuntiin riippumatta siitä, kuinka paljon kapasiteettia resurssiryhmällä yhteensä on kyseisenä päivänä.</span><span class="sxs-lookup"><span data-stu-id="5e629-311">For example, if the working time for a resource group on one specific date is from 8:00 to 16:00, one operation can't put more load on the resource group than what can be fit into 8 hours, no matter how much capacity that the resource group has available in total on that day.</span></span> <span data-ttu-id="5e629-312">Käytettävissä oleva kapasiteetti voi kuitenkin rajoittaa kuormitusta entisestään.</span><span class="sxs-lookup"><span data-stu-id="5e629-312">The available capacity can however limit the load further.</span></span>

<span data-ttu-id="5e629-313">Kaikkien resurssiryhmään kuuluvien resurssien työn aikataulutuksen kuormitus tiettynä päivänä otetaan huomioon, kun resurssiryhmän käytettävissä olevaa kapasiteettia lasketaan kyseiselle päivälle.</span><span class="sxs-lookup"><span data-stu-id="5e629-313">The load from job scheduling on all the resources included in the resource group on a given day is considered when the available capacity for the resource group on the same day is calculated.</span></span> <span data-ttu-id="5e629-314">Laskenta tehdään seuraavasti kunkin päivän osalta:</span><span class="sxs-lookup"><span data-stu-id="5e629-314">For each date, the calculation is:</span></span>

<span data-ttu-id="5e629-315">*Käytettävissä oleva resurssiryhmän kapasiteetti = ryhmän resurssien kapasiteetti resurssien kalentereiden perusteella &ndash; ryhmän resursseille aikataulutettu työmäärä &ndash; toimintojen ryhmän resursseille aikataulutettu määrä &ndash; toimintojen resurssiryhmälle aikataulutettu määrä*</span><span class="sxs-lookup"><span data-stu-id="5e629-315">*Available resource group capacity = Capacity for resources in the group based on their calendar &ndash; Job scheduled load on the resources in the group &ndash; Operations scheduled load on the resources in the group &ndash; Operations scheduled load on the resource group*</span></span>

<span data-ttu-id="5e629-316">Resurssitarpeet voidaan määrittää reittityövaiheen **Resurssitarpeet** -välilehdessä käyttämällä joko tiettyä resurssia (jolloin työvaihe aikataulutetaan kyseisellä resurssilla) resurssiryhmässä tai resurssityypissä tai vähintään yhteä ominaisuutta, taitoa, kurssia tai sertifikaattia.</span><span class="sxs-lookup"><span data-stu-id="5e629-316">On the **Resource requirements** tab on the route operation, the resource requirements can be specified using either a specific resource (in which case the operation will be scheduled using that resource), for a resource group, for a resource type, or for one or more capabilities, skill, course, or certificate.</span></span> <span data-ttu-id="5e629-317">Vaikka kaikkien näiden vaihtoehtojen käyttäminen tuo valtavasti joustavuutta reittisuunnitteluun, se myös monimutkaistaa moduulin aikatauluttamista, sillä kapasiteetti on otettava huomioon ominaisuuskohtaisesti. (Ominaisuus on abstrakti nimi, jolla moduuli viittaa esimerkiksi toimintoon tai taitoihin.)</span><span class="sxs-lookup"><span data-stu-id="5e629-317">While using all of these options gives a great flexibility on the route design, it also complicates the scheduling for the engine as the capacity must be accounted for per "property" (the abstract name used in the engine for capability, skills, and so on).</span></span>

<span data-ttu-id="5e629-318">Ominaisuus resurssiryhmän kapasiteetti on kaikkien niiden resurssiryhmän resurssien kapasiteetin summa, joilla on kyseinen ominaisuus.</span><span class="sxs-lookup"><span data-stu-id="5e629-318">The resource group's capacity for a capability is the sum of the capacity for all resources in the resource group that has the capability in question.</span></span> <span data-ttu-id="5e629-319">Jos ryhmän resurssilla on ominaisuus, se otetaan huomioon riippumatta siitä, mikä kapasiteettitaso tarvitaan.</span><span class="sxs-lookup"><span data-stu-id="5e629-319">If a resource in the group has a capability, it will be considered no matter what level of the capacity is required.</span></span>

<span data-ttu-id="5e629-320">Työvaiheiden aikataulutuksessa resurssiryhmän tietyn ominaisuuden käytettävissä olevaa kapasiteettia vähennetään, kun siihen on ladattu työvaihe, joka edellyttää kyseistä ominaisuutta.</span><span class="sxs-lookup"><span data-stu-id="5e629-320">In operations scheduling, the available capacity for a certain capability for a resource group will be reduced when it is loaded with an operation that requires the capability in question.</span></span> <span data-ttu-id="5e629-321">Jos työvaiheeseen tarvitaan useita ominaisuuksia, kapasiteettia vähennetään kaikissa tarvittavissa ominaisuuksissa.</span><span class="sxs-lookup"><span data-stu-id="5e629-321">If the operation requires more than one capability, the capacity will be reduced for all required capabilities.</span></span>

<span data-ttu-id="5e629-322">Kunkin päivän osalta tarvitaan seuraava laskenta:</span><span class="sxs-lookup"><span data-stu-id="5e629-322">For each date, the required calculation is:</span></span>

<span data-ttu-id="5e629-323">*Ominaisuuden käytettävissä oleva kapasiteetti = ominaisuuden kapasiteetti &ndash; työn aikataulutettu määrä resurssiryhmään sisältyvälle resurssille, jolla on tietty ominaisuus &ndash; toimintojen aikataulutettu määrä resurssiryhmään sisältyvälle resurssille, jolla on tietty ominaisuus &ndash; toimintojen aikataulutettu kuorma resurssiryhmälle, joka edellyttää tiettyä ominaisuutta*</span><span class="sxs-lookup"><span data-stu-id="5e629-323">*Available capacity for a capability = Capacity for the capability &ndash; Job scheduled load on the resources with the specific capability, included in the resource group &ndash; Operations scheduled load on the resources with the specific capability, included in the resource group &ndash; Operations scheduled load on the resource group itself that require the specific capability*</span></span>

<span data-ttu-id="5e629-324">Niinpä jos tiettyä resurssia on kuormitettu, kuormitus on otetaan huomioon resurssiryhmän ominaisuuskohtaisessa käytettävissä olevan kapasiteetin laskennassa, koska tietyn resurssin kuormitus vähentää resurssiryhmän kapasiteetin osuutta ominaisuudessa riippumatta siitä, koskeeko tietyn resurssin kuormitus kyseistä ominaisuutta.</span><span class="sxs-lookup"><span data-stu-id="5e629-324">This means that if there is load on a specific resource, the load is considered in the calculation of the resource group's available capacity per capability, because the load on a specific resource reduces its contribution to the resource group's capacity for a capability no matter if the load on the specific resource is for that specific capability.</span></span> <span data-ttu-id="5e629-325">Jos kuormitus on resurssiryhmätasolla, se otetaan huomioon resurssiryhmän käytettävissä olevan ominaisuuskohtaisen kapasiteetin laskennassa vain, jos kuormitus koskee työvaihetta, joka edellyttää tiettyä ominaisuutta.</span><span class="sxs-lookup"><span data-stu-id="5e629-325">If there is load on the resource group level, it is considered in the calculation of the resource group's available capacity per capability only if the load is from an operation that requires the specific capability.</span></span>

<span data-ttu-id="5e629-326">Edellä oleva logiikka on monimutkaista, koska sama koskee jokaista ominaisuustyyppiä, joten työvaiheiden aikatauluttaminen rajallista kapasiteettia käyttäen edellyttää, että tietoja ladataan merkittävä määrä.</span><span class="sxs-lookup"><span data-stu-id="5e629-326">The above logic is complicated, as this is the same for each type of "property" so using operations scheduling with finite capacity requires a significant amount of data to be loaded.</span></span>

## <a name="viewing-scheduling-engine-input-and-output"></a><span data-ttu-id="5e629-327">Ajoitusmoduulin syötteen ja tuloksen näyttäminen</span><span class="sxs-lookup"><span data-stu-id="5e629-327">Viewing scheduling engine input and output</span></span>

<span data-ttu-id="5e629-328">Saat lisätietoja aikataulutusprosessin syötteistä ja tuloksesta ottamalla lokiin kirjaamisen käyttöön valitsemalla **Organisaation hallinto \> Asetukset \> Aikataulutus \> Aikataulutuksen jäljityscockpit**.</span><span class="sxs-lookup"><span data-stu-id="5e629-328">To get specific details of the input and output of the scheduling process,  enable logging by going to **Organization administration \> Setup \> Scheduling \> Scheduling tracing cockpit**.</span></span>

<span data-ttu-id="5e629-329">Valitse tällä sivulla ensin **Ota lokiin kirjaus käyttöön** toimintoruudussa.</span><span class="sxs-lookup"><span data-stu-id="5e629-329">On this page, first select **Enable logging** on the Action Pane.</span></span> <span data-ttu-id="5e629-330">Suorita sitten tuotantotilauksen aikatauluttaminen.</span><span class="sxs-lookup"><span data-stu-id="5e629-330">Then run the scheduling for the production order.</span></span> <span data-ttu-id="5e629-331">Kun se on valmis palaa **Aikataulutuksen jäljityscockpit** -sivulle ja valitse **Poista lokiin kirjaus käytöstä** toimintoruudussa.</span><span class="sxs-lookup"><span data-stu-id="5e629-331">When complete, return to the **Scheduling tracing cockpit** page and select **Disable logging** on the Action Pane.</span></span> <span data-ttu-id="5e629-332">Päivitä sivu, jonka jälkeen uusi rivi näkyy ruudukossa.</span><span class="sxs-lookup"><span data-stu-id="5e629-332">Refresh the page and a new line will appear in the grid.</span></span> <span data-ttu-id="5e629-333">Valitse ensin uusi rivi ja valitse sitten toimintoruudussa **Lataa**.</span><span class="sxs-lookup"><span data-stu-id="5e629-333">Select the new line and select **Download** on the Action Pane.</span></span> <span data-ttu-id="5e629-334">Saat tällä tavoin pakatun .zip-kansion, jossa on seuraavat tiedostot:</span><span class="sxs-lookup"><span data-stu-id="5e629-334">This will give you a .zip compressed folder containing the following files:</span></span>

- <span data-ttu-id="5e629-335">**Log.txt** – Tämä lokitiedosto sisältää vaiheet, jotka moduuli suorittaa.</span><span class="sxs-lookup"><span data-stu-id="5e629-335">**Log.txt** - This is the log file that describes the steps that the engine goes through.</span></span> <span data-ttu-id="5e629-336">Se on erittäin tarkka ja voi tuntua sekavalta. Kun sitä käytetään reittiasetusten kokeilujen osana suorituskykyongelmia ratkaisemista, ensimmäisenä kannattaa katsoa ensimmäisen ja viimeisen rivin välistä aikaeroa, sillä näin saadaan selville tarkasti aika, jonka ajoitustoiminto on käyttänyt.</span><span class="sxs-lookup"><span data-stu-id="5e629-336">It is very elaborate and can be a bit overwhelming, but when used as part of experimenting with the route setup to resolve performance problems the first thing to look for is the difference in time between the first and the last line, as this will give you the exact time the scheduler has spent.</span></span>
- <span data-ttu-id="5e629-337">**XmlModel.xml** – Tämä tiedosto sisältää X++-koodilla muodostetun mallin ja johon moduulin toiminta perustuu.</span><span class="sxs-lookup"><span data-stu-id="5e629-337">**XmlModel.xml** - This contains the model that is built in X++ and that the engine operates on.</span></span> <span data-ttu-id="5e629-338">Tiedostossa käytetty `JobId` vastaa työt (`ReqRouteJob` tai `ProdRouteJob`) sisältävää lähdetaulukon `RecId`-ominaisuuden.</span><span class="sxs-lookup"><span data-stu-id="5e629-338">The `JobId` used in the file correlates to the `RecId` from the source table containing the jobs (`ReqRouteJob` or `ProdRouteJob`).</span></span> <span data-ttu-id="5e629-339">Tässä tiedostossa katsotaan yleensä, että `ConstraintJobStartsAt`- ja `ConstraintJobEndsAt`-ominaisuuksissa annetut päivämäärät ovat odotusten mukaiset, että `JobGoal`-ominaisuus on määritetty oikein ja että työt liittyvät toisiinsa `JobLink`-rajoitusten kautta.</span><span class="sxs-lookup"><span data-stu-id="5e629-339">The typical thing to look for in this file is that the dates given in `ConstraintJobStartsAt` and `ConstraintJobEndsAt` are as expected, that the `JobGoal` property is set correctly, and that the jobs are related to each other through the `JobLink` constraints.</span></span>
- <span data-ttu-id="5e629-340">**XmlSlots.xml** – Tämä tiedosto sisältää kaikki moduulin pyytämät työajat ja kapasiteetin varaukset.</span><span class="sxs-lookup"><span data-stu-id="5e629-340">**XmlSlots.xml** - This contains all the working times and capacity reservations that the engine has requested.</span></span> <span data-ttu-id="5e629-341">Moduuli pyytää kalenterin työajat ja varaukset vain niinä aikajaksoina, jolloin se yrittää sijoittaa töitä (ja lisäpuskurin), joten jos tiedostossa on kaukana tulevaisuudessa olevia aikoja, se voi olla osoitus määrityksissä olevasta ongelmasta.</span><span class="sxs-lookup"><span data-stu-id="5e629-341">The calendar working times and reservations will only be requested by the engine for the time periods where it tries to place the jobs (and an extra buffer), so if the file contains times very far in the future, it might be an indication of a problem with the setup.</span></span> <span data-ttu-id="5e629-342">`ResourceProperty`-solmut näytetään jokaiselle resurssille, joihin resurssiryhmä ja sen ominaisuudet on liitetty sekä niiden kaudet.</span><span class="sxs-lookup"><span data-stu-id="5e629-342">The `ResourceProperty` nodes will show for each resource which resource group and capabilities it is associated with for which periods.</span></span>
- <span data-ttu-id="5e629-343">**Result.xml** – Tämä tiedosto sisältää aikataulutusajon tuloksen.</span><span class="sxs-lookup"><span data-stu-id="5e629-343">**Result.xml** - This contains the result of the scheduling run.</span></span>

<span data-ttu-id="5e629-344">Huomaa, että jäljitystoiminto voi vaikuttaa merkittävästi suorituskykyyn, joten käytä sitä vain tiettyjen tilausten aikatauluttamisen tutkimiseen harkitusti.</span><span class="sxs-lookup"><span data-stu-id="5e629-344">Note that the tracing functionality can add significant performance overhead, so only use it for investigating scheduling of specific orders in a controlled manner.</span></span> <span data-ttu-id="5e629-345">Jos se on otettu käyttöön pääsuunnitteluajon aikana, se saavuttaa nopeasti kokorajan ja pysähtyy.</span><span class="sxs-lookup"><span data-stu-id="5e629-345">If it is turned on during a master planning run it will quickly reach its size limit and stop.</span></span>

## <a name="troubleshooting-performance"></a><span data-ttu-id="5e629-346">Suorituskyvyn vianmääritys</span><span class="sxs-lookup"><span data-stu-id="5e629-346">Troubleshooting performance</span></span>

<span data-ttu-id="5e629-347">Kuten edellisissä osissa on selitetty, ajoitusmoduulin määrittämisessä käytössä on joitakin heikkouksia, mikä voi johtaa suorituskykyongelmiin.</span><span class="sxs-lookup"><span data-stu-id="5e629-347">As can be understood from all of the previous sections, there are some pitfalls when it comes to the setup and usage of the scheduling engine, which can lead to performance problems.</span></span> <span data-ttu-id="5e629-348">Näiden ongelmien vianmäärityksen apuna voi käyttää seuraavaa tarkistusluetteloa.</span><span class="sxs-lookup"><span data-stu-id="5e629-348">The following check list can be used for troubleshooting such issues.</span></span> <span data-ttu-id="5e629-349">On tärkeää ottaa huomioon kaikki mainitut kohdat, sillä usein juuri useiden seikkojen yhdistelmää aiheuttaa ongelmia.</span><span class="sxs-lookup"><span data-stu-id="5e629-349">It is important to look at all the points as it is most often a combination of multiple factors that leads to problems.</span></span>

### <a name="performing-scheduling-as-part-of-mrp-when-it-is-not-needed"></a><span data-ttu-id="5e629-350">Aikataulutuksen suorittaminen tarvesuunnittelun osana, kun se ei ole välttämätöntä</span><span class="sxs-lookup"><span data-stu-id="5e629-350">Performing scheduling as part of MRP when it is not needed</span></span>

<span data-ttu-id="5e629-351">Vaikka reittejä käytetään tuotannon hallinnassa esimerkiksi kustannuslaskennassa ja raportoinnissa, niitä ei kuitenkaan ehkä tarvitse ottaa huomioon tarvesuunnittelun aikana.</span><span class="sxs-lookup"><span data-stu-id="5e629-351">Even though routes are used for the production control purposes such as costing and reporting, it might not be necessary to consider them during MRP.</span></span> <span data-ttu-id="5e629-352">Joissakin tapauksissa suunnitteluun riittää, että käytössä on nimikkeelle määritetty tuotannon vakioläpimenoaika.</span><span class="sxs-lookup"><span data-stu-id="5e629-352">In some cases, having a standard production lead time specified for the item will be sufficient for planning.</span></span> <span data-ttu-id="5e629-353">Poista reitin aikatauluttaminen käytöstä määrittämällä kapasiteetin aikarajaksi nolla.</span><span class="sxs-lookup"><span data-stu-id="5e629-353">To turn off route scheduling, set the capacity time fence to zero.</span></span> <span data-ttu-id="5e629-354">Jos aikataulutus on tehtävä, kapasiteetin aikaraja on määritettävä huolellisesti, koska reittejä ei ehkä tarvitse ottaa huomioon tarvesuunnittelun koko laajuuden aikarajoissa.</span><span class="sxs-lookup"><span data-stu-id="5e629-354">If scheduling should be done, then the capacity time fence must be carefully set because it might not be necessary to consider routes for the full extent of the MRP's coverage time fence.</span></span>

<span data-ttu-id="5e629-355">Huomaa, että jos tilausta ei aikatauluteta tarvesuunnittelun aikana, se on siinä tapauksessa aikataulutettava, kun suunniteltu tilaus vahvistetaan.</span><span class="sxs-lookup"><span data-stu-id="5e629-355">Note that if the order is not scheduled during MRP, then it will instead need to be scheduled when the planned order is firmed.</span></span> <span data-ttu-id="5e629-356">Tämän vuoksi vahvistusprosessi kestää kauemmin, joten tarvesuunnittelun aikana saatu suorituskykyhyöty voidaan menettää vahvistuksen aikana sen mukaan, kuinka monta ehdotettua suunniteltua tilausta vahvistetaan.</span><span class="sxs-lookup"><span data-stu-id="5e629-356">This means that the firming process will take longer, so depending on how many of the suggested planned orders get firmed the performance gain during MRP might be lost at firming.</span></span>

### <a name="route-with-unnecessary-operations"></a><span data-ttu-id="5e629-357">Reitti, jossa on tarpeettomia työvaiheita</span><span class="sxs-lookup"><span data-stu-id="5e629-357">Route with unnecessary operations</span></span>

<span data-ttu-id="5e629-358">Reittiä suunniteltaessa on kiusaus yrittää mallintaa todellisuutta täsmällisesti ja ottaa huomioon kaikki tuotannon vaiheet.</span><span class="sxs-lookup"><span data-stu-id="5e629-358">When designing the route, it is tempting to try to model the real world exactly with all the steps the production goes through.</span></span> <span data-ttu-id="5e629-359">Vaikka tämä voi olla hyödyllistä joissain tapauksissa, se heikentää suorituskykyä, sillä moduulin käsittelemä malli suurenee (sekä töiden että rajoitusten osalta) ja SQL-lausekkeita suoritetaan enemmän töiden ja kapasiteetin varausten lisäämisen ja päivittämisen vuoksi.</span><span class="sxs-lookup"><span data-stu-id="5e629-359">While this can be useful in some cases, it is not good for the performance as the model the engine needs to work on gets larger (both in terms of jobs and constraints) and more SQL statements will be executed for insertion and update of the jobs and capacity reservations.</span></span> <span data-ttu-id="5e629-360">Vaikutuksia on myöhemmin, sillä töiden edistymisestä on jossain vaiheessa raportoitava. Tätä tosin voidaan helpottaa automaattisilla julkaisuilla.</span><span class="sxs-lookup"><span data-stu-id="5e629-360">Also, there is the downstream effect of having to eventually report progress on the jobs, which can be mitigated with automatic postings.</span></span> <span data-ttu-id="5e629-361">Jos tietoja ei käytetä mihinkään, syntyy turhaa kuormitusta.</span><span class="sxs-lookup"><span data-stu-id="5e629-361">If the data is not used for anything, it creates unnecessary load.</span></span>

<span data-ttu-id="5e629-362">Tämän vuoksi kannattaakin luoda vain työvaiheet, joita ehdottomasti tarvitaan aikataulutukseen (mikä on tyypillisesti pullonkaularesurssit) ja/tai kustannuslaskentaan.</span><span class="sxs-lookup"><span data-stu-id="5e629-362">We recommend that you only create operations that are strictly needed for scheduling (which will typically be the bottleneck resources) and/or costing purposes.</span></span> <span data-ttu-id="5e629-363">Vaihtoehtoisesti pienet, erilliset työvaiheet voi ryhmitellä yksi suureksi työvaiheeksi, joka vastaa suurempaa prosessin osaa.</span><span class="sxs-lookup"><span data-stu-id="5e629-363">Alternatively you should group many smaller distinct operations into one larger operation that represents a greater part of the process.</span></span>

### <a name="many-applicable-resources-for-an-operation"></a><span data-ttu-id="5e629-364">Työvaiheessa useita käytettäviä resursseja</span><span class="sxs-lookup"><span data-stu-id="5e629-364">Many applicable resources for an operation</span></span>

<span data-ttu-id="5e629-365">Työvaiheen käytettävien resurssien määrä määritetään työvaihesuhteessa määritettyjen resurssitarpeiden perusteella.</span><span class="sxs-lookup"><span data-stu-id="5e629-365">The number of applicable resources for an operation is determined by the resource requirements set on the operation relation.</span></span> <span data-ttu-id="5e629-366">Tarve voi koskea joko tiettyä (yksittäistä) resurssia tai se voi perustua resurssin resurssiryhmän jäsenyyteen tai ominaisuuteen.</span><span class="sxs-lookup"><span data-stu-id="5e629-366">The requirement can either be for a specific (individual) resource or it can be based on the resource's membership of a resource group or capability.</span></span>

<span data-ttu-id="5e629-367">Jos aikataulutuksessa ei käytetä rajallista kapasiteettia ja kaikilla käytettävillä resursseilla on sama kalenteri ja tehokkuus, ajoitusmoduuli päätyy poimimaan työvaiheeseen aina saman resurssin mutta vasta sen jälkeen, kun se on kokeillut kaikki käytettäviä resursseja, koska se on halunnut tarkistaa, onko jokin resursseista parempi kuin jokin toinen.</span><span class="sxs-lookup"><span data-stu-id="5e629-367">If scheduling is not done using finite capacity and all the applicable resources have the same calendar and efficiency, then the scheduling engine will always end up picking the same resource for an operation, but only after trying all the applicable resources to check if there is one that is "better" than the others.</span></span> <span data-ttu-id="5e629-368">Tässä tapauksessa aikataulutuksen kuormitusta voidaan vähentää merkittävästi määrittämällä aina vain tietyn resurssin työvaiheeseen reitin suunnittelun aikana.</span><span class="sxs-lookup"><span data-stu-id="5e629-368">In this case, the load of the scheduling can be greatly reduced simply by always assigning a specific resource to the operation at the route design time.</span></span>

### <a name="route-with-parallel-operations"></a><span data-ttu-id="5e629-369">Reitti, joissa on samanaikaisia työvaiheita</span><span class="sxs-lookup"><span data-stu-id="5e629-369">Route with parallel operations</span></span>

<span data-ttu-id="5e629-370">Vaikka samanaikaiset työvaiheet (ensisijainen/toissijainen) ovat tehokas työkalu mallintaa skenaarioita, joissa esimerkiksi konetta ja koneen käyttäjää tarvitaan suorittamaan tietty tehtävä, ne myös aiheuttavat paljon suorituskykyongelmia.</span><span class="sxs-lookup"><span data-stu-id="5e629-370">While parallel operations (primary/secondary) are a powerful tool to model scenarios like when a machine and an operator are both needed to perform a specific task, it is also the source of many performance issues.</span></span> <span data-ttu-id="5e629-371">Jos tietyn yksittäisen resurssin tarve on määritetty sekä ensisijaiselle että toissijaiselle työvaiheelle, se ei yleensä ole ongelma.</span><span class="sxs-lookup"><span data-stu-id="5e629-371">If a requirement for a specific individual resource is assigned to both the primary and secondary operation, it is typically not a problem.</span></span> <span data-ttu-id="5e629-372">Mutta jos kummallekin työvaiheelle on monia mahdollisia resursseja, aikataulutuksen laskennallisen monimutkaisuus lisääntyy merkittävästi.</span><span class="sxs-lookup"><span data-stu-id="5e629-372">But if there are many possible resources for each of the operations, then it adds significant computational complexity to the scheduling.</span></span>

<span data-ttu-id="5e629-373">Samanaikaisten työvaiheiden tilalla voi käyttää joko parien mallintamista virtuaalisina resursseina (jotka sitten ilmaisevat ryhmän, joka on aina yhdessä työvaiheessa) tai toisen työvaiheen jättämistä mallintamatta, jos se ei ilmaise pullonkaulaa.</span><span class="sxs-lookup"><span data-stu-id="5e629-373">An alternative to using parallel operations is either to model the pairs as "virtual" resources (which will then represent the team that always goes together for the operation) or to simply not model one of the operations if it doesn't represent a bottleneck.</span></span>

### <a name="route-with-quantity-of-resources-higher-than-1"></a><span data-ttu-id="5e629-374">Reitti, joissa resurssien määrä on suurempi kuin 1</span><span class="sxs-lookup"><span data-stu-id="5e629-374">Route with quantity of resources higher than 1</span></span>

<span data-ttu-id="5e629-375">Jos työvaiheeseen tarvittavien resurssien määrä on määritetty suurempi kuin yksi, tulos on käytännössä sama kuin käytettäessä ensisijaisia/toissijaisia työvaiheita, koska moduuliin lähetetään useita samanaikaisia töitä.</span><span class="sxs-lookup"><span data-stu-id="5e629-375">If setting the quantity of resources needed for an operation higher than one, then it results effectively the same as using primary/secondary operations because multiple parallel jobs are sent to the engine.</span></span> <span data-ttu-id="5e629-376">Tässä tapauksessa ei kuitenkaan ole mahdollisuutta käyttää tietyn resurssin määrityksiä, koska määrän ollessa suurempi kuin yksi työvaiheessa on oltava käytettävissä useampi kuin yksi resurssi.</span><span class="sxs-lookup"><span data-stu-id="5e629-376">However, for this case there is not an option of using specific resource assignments, because a quantity higher than one requires that more than one resource is applicable for the operation.</span></span>

### <a name="excessive-use-of-finite-capacity"></a><span data-ttu-id="5e629-377">Liiallinen rajallisen kapasiteetin käyttö</span><span class="sxs-lookup"><span data-stu-id="5e629-377">Excessive use of finite capacity</span></span>

<span data-ttu-id="5e629-378">Rajallisen kapasiteetin käyttö edellyttää, että moottori lataa kapasiteettitiedot tietokannasta ja on ylimääräistä laskentakapasiteettia, koska ratkaisun on löytäminen on vaikeampaa etenkin ympäristöissä, joissa resurssit varataan lähelle enimmäiskapasiteettia.</span><span class="sxs-lookup"><span data-stu-id="5e629-378">Use of finite capacity requires the engine to load the capacity information from a database and can have a computational overhead because it will be harder to find a solution especially in environments where the resources are booked close to their maximum capacity.</span></span> <span data-ttu-id="5e629-379">Tämän vuoksi onkin tärkeää arvioida huolellisesti, onko resurssin todellakin käytettävä rajallista kapasiteetti vai voidaanko ne ylivarata.</span><span class="sxs-lookup"><span data-stu-id="5e629-379">As a result, it is important to carefully evaluate if a resource really needs to use finite capacity or they can be overbooked.</span></span> <span data-ttu-id="5e629-380">Koska rajallisen kapasiteetin resurssien kesken voi olla eroja siitä, kuinka tärkeää on, ettei niitä ylivarata, resurssissa kannattaa käyttää pullonkaula-asetusta yhdessä suunnitelman erillisen Kapasiteetin aikaraja pullonkaularesursseille -arvon kanssa.</span><span class="sxs-lookup"><span data-stu-id="5e629-380">Because there might be a difference among finite capacity resources in how important they are not to overbook, we recommend using the bottleneck option on a resource in combination with a separate value on the plan in "Capacity time fence for bottleneck resources".</span></span> <span data-ttu-id="5e629-381">Pullonkaulan käyttäminen voi mahdollistaa sen, että yleistä rajallisen kapasiteetin aikarajaa voidaan alentaa.</span><span class="sxs-lookup"><span data-stu-id="5e629-381">Using the bottleneck concept can enable that the general finite capacity time fence can be lowered.</span></span>

### <a name="setting-hard-links"></a><span data-ttu-id="5e629-382">Kiinteiden linkkien määrittäminen</span><span class="sxs-lookup"><span data-stu-id="5e629-382">Setting hard links</span></span>

<span data-ttu-id="5e629-383">Reitin vakiolinkkityyppi on *symbolinen* , jolloin yhden työvaiheen valmistumisajan ja seuraavan alkamisajan välillä voi olla aikaväli.</span><span class="sxs-lookup"><span data-stu-id="5e629-383">The standard link type of the route is *soft* , which means that a time gap is allowed between the finishing time of one operation and the start of the next.</span></span> <span data-ttu-id="5e629-384">Valitettavasti tämän salliminen aiheuttaa sen, että jos yhdelle työvaiheelle ei ole käytettävissä materiaaleja tai kapasiteettia erittäin pitkään aikaan, tuotanto voi joutua odottamaan pitkäänkin, mikä puolestaan voi lisätä keskeneräisiä töitä.</span><span class="sxs-lookup"><span data-stu-id="5e629-384">Allowing this can have the unfortunate effect that, if materials or capacity are not available for one of the operations for a very long time, the production could be idle for quite a while, meaning a possible increase of work in progress.</span></span> <span data-ttu-id="5e629-385">Kiinteitä linkkejä käytettäessä näin ei tapahdu, sillä päättymisen ja alkamisen on vastattava toisiaan täydellisesti.</span><span class="sxs-lookup"><span data-stu-id="5e629-385">This will not happen with hard links because the finish and start must align perfectly.</span></span> <span data-ttu-id="5e629-386">Kiinteiden linkkien määrittäminen kuitenkin hankaloittaa aikataulutusongelmaa entisestään, koska työajan ja kapasiteetin leikkaukset on laskettava työvaiheiden kahdelle resurssille.</span><span class="sxs-lookup"><span data-stu-id="5e629-386">But setting hard links makes the scheduling problem more difficult because working time and capacity intersections must be calculated for the two resources of the operations.</span></span> <span data-ttu-id="5e629-387">Jos mukana on myös samanaikaisia työvaiheita, laskennallinen aika lisääntyy merkittävästi.</span><span class="sxs-lookup"><span data-stu-id="5e629-387">If there are also parallel operations involved, this adds significant computational time.</span></span> <span data-ttu-id="5e629-388">Jos kahden työvaiheen resursseilla on eri kalenterit, joilla ei ole lainkaan päällekkäisyyksiä, ongelmaa ei voida ratkaista.</span><span class="sxs-lookup"><span data-stu-id="5e629-388">If the resources of the two operations have different calendars that don't overlap at all, the problem is unsolvable.</span></span>

<span data-ttu-id="5e629-389">Kiinteitä linkkejä kannattaakin käyttää vain silloin, kun ne ovat ehdottoman välttämättömiä, minkä lisäksi on pohdittava huolellisesti tarvitaanko niitä reitin jokaisessa työvaiheessa.</span><span class="sxs-lookup"><span data-stu-id="5e629-389">We recommend using hard links only when strictly necessary, and carefully consider if it is necessary for each operation of the route.</span></span>

<span data-ttu-id="5e629-390">Keskeneräisten töiden määrää voi vähentää kiinteitä linkkejä käyttämättä aikatauluttamalla tilauksen kahdesti siten, että jälkimmäisellä kerralla käytetään päinvastaista suuntaa.</span><span class="sxs-lookup"><span data-stu-id="5e629-390">To reduce the work in progress without applying hard links, a trick is to schedule the order twice with changing to the opposite direction for the second pass.</span></span> <span data-ttu-id="5e629-391">Jos ensimmäinen aikataulutus tehtiin taaksepäin toimituspäivästä, toinen on sitten tehtävä eteenpäin aikataulutetusta alkamispäivästä.</span><span class="sxs-lookup"><span data-stu-id="5e629-391">If the first schedule was done backwards from delivery date, then the second should be done forward from the scheduled start date.</span></span> <span data-ttu-id="5e629-392">Tällä tavoin työt tiivistetään mahdollisimman hyvin, jolloin keskeneräisen työ minimoidaan.</span><span class="sxs-lookup"><span data-stu-id="5e629-392">This will result in the jobs being compressed as much as possible so that the work in progress is minimized.</span></span>

### <a name="separate-calendar-for-each-resource"></a><span data-ttu-id="5e629-393">Jokaisella resurssilla erillinen kalenteri</span><span class="sxs-lookup"><span data-stu-id="5e629-393">Separate calendar for each resource</span></span>

<span data-ttu-id="5e629-394">Yksi tärkeimmistä ajoitusmoduulin tietolähteistä on kalenterin tiedot, joiden lataaminen tietokannasta voi olla kallista.</span><span class="sxs-lookup"><span data-stu-id="5e629-394">One of the main sources of data for the scheduling engine is calendar information, which can be expensive to load from the database.</span></span> <span data-ttu-id="5e629-395">Koska kalenterit luodaan mallien pohjalta, kullekin resurssille on kiusaus luoda oma kalenteri, jonka tietoja sitten säädetään, jos resurssilla on käyttökatkos tai muita ongelmia.</span><span class="sxs-lookup"><span data-stu-id="5e629-395">Because calendars are generated based on templates, it would be tempting to generate a calendar for each resource and then adjust the information in this calendar when the resource has downtime and other issues.</span></span> <span data-ttu-id="5e629-396">Jos näin toimitaan moduulien mahdollisuus tallentaa kalenterin tiedot välimuistiin rajoittuu huomattavasti, sillä moduulin olisi pyydettävä uudet tiedot kullekin resurssille, mikä voi olla merkittävä suorituskykyongelmien aiheuttaja.</span><span class="sxs-lookup"><span data-stu-id="5e629-396">However, doing this will severely limit the engines ability to cache the calendar data as it would need to request new data for each resource and can be a large source of performance problems.</span></span> <span data-ttu-id="5e629-397">Kalentereita kannattaa sen sijaan käyttää mahdollisimman paljon uudelleen resurssien kesken ja hallita sitten käyttökatkosmuutoksia määrittämällä jaksolle eri kalenteritunnus.</span><span class="sxs-lookup"><span data-stu-id="5e629-397">Instead, we recommend that you reuse the calendars as much as possible between the resources, and then control downtime changes by assigning a different calendar ID for a period.</span></span>

### <a name="high-number-of-working-time-slots-per-calendar-day"></a><span data-ttu-id="5e629-398">Kalenteri suuri työn ajankohtien päiväkohtainen määrä</span><span class="sxs-lookup"><span data-stu-id="5e629-398">High number of working time slots per calendar day</span></span>

<span data-ttu-id="5e629-399">Koska moduuli etsii kapasiteettia tarkastelemalla ajankohtia yksi kerrallaan, kalenterin päiväkohtaisten ajankohtien määrä kannattaa minimoida.</span><span class="sxs-lookup"><span data-stu-id="5e629-399">Because the engine works by examining time slots one-by-one for capacity, it is beneficial to minimize the number of time slots per calendar day.</span></span> <span data-ttu-id="5e629-400">Se voidaan tehdä esimerkiksi miettimällä, onko tärkeää, että aikataulussa näkyy työntekijöiden viiden minuutin tauko kerran tunnissa.</span><span class="sxs-lookup"><span data-stu-id="5e629-400">This could be done, for example, by considering whether it's important for the resulting schedule to reflect that workers have a 5-minute break every hour.</span></span>

### <a name="large-or-none-scheduling-timeouts"></a><span data-ttu-id="5e629-401">Aikataulutuksen pitkät (tai puuttuvat) aikakatkaisut</span><span class="sxs-lookup"><span data-stu-id="5e629-401">Large (or none) scheduling timeouts</span></span>

<span data-ttu-id="5e629-402">Ajoitusmoduulin suorituskyky voidaan optimoida käyttämällä **Ajoitusparametrit** -sivulla olevia parametreja.</span><span class="sxs-lookup"><span data-stu-id="5e629-402">Scheduling engine performance can be optimized using parameters found on the **Scheduling parameters** page.</span></span> <span data-ttu-id="5e629-403">**Aikataulutuksen aikakatkaisu käytössä** - ja **Aikataulutuksen optimoinnin aikakatkaisu käytössä** -asetuksena on aina oltava **Kyllä**.</span><span class="sxs-lookup"><span data-stu-id="5e629-403">The **Scheduling timeout enabled** and **Scheduling optimization timeout enabled** settings should always be set to **Yes**.</span></span> <span data-ttu-id="5e629-404">Jos asetuksena on **Ei** , aikataulutus voi periaatteessa jatkua vaikka kuinka kauan, jos luotu reitti ei ole käyttökelpoinen ja siinä on paljon vaihtoehtoja.</span><span class="sxs-lookup"><span data-stu-id="5e629-404">If set to **No** , the scheduling can potentially run infinitely if an unfeasible route with many options has been created.</span></span>

<span data-ttu-id="5e629-405">**Sarjakohtainen enimmäisajoitusaika** -asetuksen arvo määrittää, kuinka monta sekuntia voidaan enintään yrittää löytää ratkaisu yhdelle jaksolle (useimmissa tapauksissa jakso vastaa yhtä tilausta).</span><span class="sxs-lookup"><span data-stu-id="5e629-405">The value for **Maximum scheduling time per sequence** controls how many seconds can, at most, be spent trying to find a solution for a single sequence (in most cases a sequence corresponds to a single order).</span></span> <span data-ttu-id="5e629-406">Tässä käytettävä arvo määräytyy ennen kaikkea reitin monimutkaisuuden ja asetusten, rajallinen kapasiteetti, mukaan. Yleensä enintään 30 sekuntia on hyvä lähtökohta.</span><span class="sxs-lookup"><span data-stu-id="5e629-406">The value to use here highly depends on the complexity of the route and settings like finite capacity, ut a maximum of about 30 seconds is a good starting point.</span></span>

<span data-ttu-id="5e629-407">**Optimointiyritysten aikakatkaisu** -asetuksen arvo määrittää, kuinka monta sekuntia enintään etsitään ratkaisua, joka on parempi kuin alun perin löydetty ratkaisu.</span><span class="sxs-lookup"><span data-stu-id="5e629-407">The value for **Optimization attempts timeout** controls how many seconds can at most be used to find a better solution than the one originally found.</span></span> <span data-ttu-id="5e629-408">Tämä vaikuttaa vain reitteihin, joissa käytetään samanaikaisia työvaiheita, sillä on välttämätöntä, että erilaisia yhdistelmiä testataan.</span><span class="sxs-lookup"><span data-stu-id="5e629-408">This will only influence routes that are using parallel operations as these make it necessary to test different combinations.</span></span>

> [!NOTE]
> <span data-ttu-id="5e629-409">Aikakatkaisuille määritettyjä arvoja voidaan käyttää sekä vapautettujen tuotantotilausten aikatauluttamiseen että suunniteltujen tilausten aikatauluttamiseen tarvesuunnittelun osana.</span><span class="sxs-lookup"><span data-stu-id="5e629-409">The values set for the timeouts will be applied both for scheduling of released production orders and of planned orders as part of MRP.</span></span> <span data-ttu-id="5e629-410">Jos asetuksella on erittäin suuri arvo, tarvesuunnittelun suoritusaika voi tämän vuoksi pidentyä merkittävästi, kun suoritetaan suunnitelma, jossa on monia suunniteltuja tuotantotilauksia:</span><span class="sxs-lookup"><span data-stu-id="5e629-410">As a result, setting very high values could significantly add to the run time of MRP when running for a plan with many planned production orders.</span></span>
