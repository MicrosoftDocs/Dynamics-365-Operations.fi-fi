---
title: Varastonhallinnan käytettävissä olevien merkintöjen tyhjennystyö
description: Tässä aiheessa kuvataan käytettävissä olevien tapahtumien tyhjennystyö, joka auttaa parantamaan järjestelmän suorituskykyä tunnistamalla ja poistamalla aiheeseen liittyviä, mutta tarpeettomia tietueita.
author: perlynne
ms.date: 04/23/2020
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: SysOperationTemplateForm
audience: Application User
ms.reviewer: kamaybac
ms.search.region: Global
ms.author: perlynne
ms.search.validFrom: 2020-04-03
ms.dyn365.ops.version: Release 10.0.12
ms.openlocfilehash: 4dd3bb9dc580e715b6945da1f94cf27e601c549e
ms.sourcegitcommit: 0e8db169c3f90bd750826af76709ef5d621fd377
ms.translationtype: HT
ms.contentlocale: fi-FI
ms.lasthandoff: 04/01/2021
ms.locfileid: "5808723"
---
# <a name="warehouse-management-on-hand-entries-cleanup-job"></a><span data-ttu-id="d7199-103">Varastonhallinnan käytettävissä olevien merkintöjen tyhjennystyö</span><span class="sxs-lookup"><span data-stu-id="d7199-103">Warehouse management on-hand entries cleanup job</span></span>

<span data-ttu-id="d7199-104">Käytettävissä olevan varaston laskennassa käytettävien kyselyiden suorituskyky vaikuttaa siihen, kuinka monta tietuetta taulukoissa on mukana.</span><span class="sxs-lookup"><span data-stu-id="d7199-104">The performance of queries that are used to calculate on-hand inventory is affected by the number of records in the tables that are involved.</span></span> <span data-ttu-id="d7199-105">Yksi tapa parantaa suorituskykyä on vähentää niiden tietojen määrää, joita tietokannan on harkittava.</span><span class="sxs-lookup"><span data-stu-id="d7199-105">One way to help improve the performance is to reduce the number of records that the database must consider.</span></span>

<span data-ttu-id="d7199-106">Tässä aiheessa kuvataan käytettävissä olevien tapahtumien tyhjennystyö, joka poistaa tarpeettomat tietueet InventSum- ja WHSInventReserve-tauluista.</span><span class="sxs-lookup"><span data-stu-id="d7199-106">This topic describes the on-hand entries cleanup job, which deletes unneeded records in the InventSum and WHSInventReserve tables.</span></span> <span data-ttu-id="d7199-107">Näissä taulukoissa on tietoja nimikkeistä, jotka on otettu käyttöön varastonhallinnan käsittelyä varten.</span><span class="sxs-lookup"><span data-stu-id="d7199-107">These tables store on-hand information for items that are enabled for warehouse management processing.</span></span> <span data-ttu-id="d7199-108">(Näitä nimikkeitä kutsutaan WHS-nimikkeiksi.) Näiden tietojen poistaminen voi merkittävästi parantaa käytettävissä olevien laskelmien suorituskykyä.</span><span class="sxs-lookup"><span data-stu-id="d7199-108">(These items are referred to as WHS items.) Deletion of these records can significantly improve the performance of on-hand calculations.</span></span>

## <a name="what-the-cleanup-job-does"></a><span data-ttu-id="d7199-109">Mitä puhdistustyö tekee</span><span class="sxs-lookup"><span data-stu-id="d7199-109">What the cleanup job does</span></span>

<span data-ttu-id="d7199-110">Käytettävissä olevien tapahtumien tyhjennystyö poistaa kaikki WHSInventReserve- ja InventSum-taulujen tietueet, joissa kentän arvot ovat *0* (nolla).</span><span class="sxs-lookup"><span data-stu-id="d7199-110">The on-hand entries cleanup job deletes any records in the WHSInventReserve and InventSum tables where all the field values are *0* (zero).</span></span> <span data-ttu-id="d7199-111">Nämä tiedot voidaan poistaa, koska ne eivät vaikuta käytettävissä oleviin tietoihin.</span><span class="sxs-lookup"><span data-stu-id="d7199-111">These records can be deleted because they don't contribute to the on-hand information.</span></span> <span data-ttu-id="d7199-112">Työtehtävä poistaa vain ne tiedot, jotka ovat **Sijainti**-tason alapuolella.</span><span class="sxs-lookup"><span data-stu-id="d7199-112">The job deletes only records that are below the **Location** level.</span></span>

<span data-ttu-id="d7199-113">Jos negatiivinen fyysinen varasto on sallittu, tyhjennystyö ei ehkä voi poistaa kaikkia asiaankuuluvia merkintöjä.</span><span class="sxs-lookup"><span data-stu-id="d7199-113">If negative physical inventory is allowed, the cleanup job might not be able to delete all the relevant entries.</span></span> <span data-ttu-id="d7199-114">Tämän rajoituksen syy on se, että työn on sallittava tietty tilanne, jossa rekisterikilvessä on useita sarjanumeroita ja jokin näistä sarjanumeroista on muuttunut negatiiviseksi.</span><span class="sxs-lookup"><span data-stu-id="d7199-114">The reason for this limitation is that the job must allow for a special scenario where a license plate has multiple serial numbers, and one of those serial numbers has become negative.</span></span> <span data-ttu-id="d7199-115">Esimerkiksi järjestelmä on nolla, joka on käytettävissä rekisterikilven tasolla, kun rekisterikilvessä on +1 kpl sarjanumero 1:tä ja –1 kpl sarjanumero 2:ta.</span><span class="sxs-lookup"><span data-stu-id="d7199-115">For example, the system will have zero on hand at the license plate level when a license plate has +1 pcs of serial number 1 and –1 pcs of serial number 2.</span></span> <span data-ttu-id="d7199-116">Tässä erityisessä skenaariossa työ tekee leveää ensimmäistä poistoa, jossa se yrittää poistaa ensin alemmasta tasosta.</span><span class="sxs-lookup"><span data-stu-id="d7199-116">For this special scenario, the job does a breadth-first deletion, where it tries to delete from lower levels first.</span></span>

## <a name="schedule-and-configure-the-cleanup-job"></a><span data-ttu-id="d7199-117">Tyhjennystyön ajoittaminen ja määrittäminen</span><span class="sxs-lookup"><span data-stu-id="d7199-117">Schedule and configure the cleanup job</span></span>

<span data-ttu-id="d7199-118">Käytettävissä olevien tapahtumien tyhjennystyö on saatavilla kohdassa **Varastonhallinta \> Kausittaiset tehtävät \> Siivous \> Varastonhallinnan varastosaldon tapahtumat**.</span><span class="sxs-lookup"><span data-stu-id="d7199-118">The on-hand entries cleanup job is available at **Inventory management \> Periodic tasks \> Clean up \> Warehouse management on-hand entries cleanup**.</span></span> <span data-ttu-id="d7199-119">Käytä vakiotyöasetuksia, kun haluat hallita työn suorituksen laajuutta ja aikataulua.</span><span class="sxs-lookup"><span data-stu-id="d7199-119">Use the standard job settings to control the scope and schedule for running the job.</span></span> <span data-ttu-id="d7199-120">Lisäksi käytössä on seuraavat asetukset:</span><span class="sxs-lookup"><span data-stu-id="d7199-120">In addition, the following settings are provided:</span></span>

- <span data-ttu-id="d7199-121">**Poista, jos tätä ei ole päivitetty näin moneen päivään** – Anna vähimmäispäivien määrä, jonka työn tulisi odottaa, ennen kuin se poistaa käytettävissä olevan tapahtuman, joka on laskenut nollaan määrään.</span><span class="sxs-lookup"><span data-stu-id="d7199-121">**Delete if not updated for this many days** – Enter the minimum number of days that the job should wait before it deletes an on-hand entry that has dropped to zero quantity.</span></span> <span data-ttu-id="d7199-122">Tämän asetuksen avulla voit vähentää edelleen käytössä olevien merkintöjen poistoriskiä.</span><span class="sxs-lookup"><span data-stu-id="d7199-122">Use this setting to help reduce the risk of deleting on-hand entries that are still being used.</span></span> <span data-ttu-id="d7199-123">Jos haluat, että tyhjennys tapahtuu mahdollisimman pian, kirjoita joko *0* (nolla) tai jätä kenttä tyhjäksi.</span><span class="sxs-lookup"><span data-stu-id="d7199-123">If you want cleanup to occur as soon as possible, either enter *0* (zero) or leave the field blank.</span></span>
- <span data-ttu-id="d7199-124">**Enimmäissuoritusaika (tuntia)** – Määritä tyhjennystyön enimmäissuoritusaika tunteina.</span><span class="sxs-lookup"><span data-stu-id="d7199-124">**Maximum execution time (hours)** – Enter the maximum execution time of the cleanup job, in hours.</span></span> <span data-ttu-id="d7199-125">Jos työ ei valmistunut ennen tämän ajan umpeutumista, se tallentaa tähän mennessä suoritetun työn ja sulkee sen.</span><span class="sxs-lookup"><span data-stu-id="d7199-125">If the job isn't completed before this time passes, it will save the work that it has completed so far and then close itself.</span></span> <span data-ttu-id="d7199-126">Tämä ominaisuus on erityisen tärkeä toteutuksille, joilla on suuri varastokäyttö.</span><span class="sxs-lookup"><span data-stu-id="d7199-126">This capability is especially relevant for implementations that have high inventory use.</span></span> <span data-ttu-id="d7199-127">Näissä tapauksissa voit ajoittaa työn suoritettavaksi silloin, kun järjestelmän kuormitus on mahdollisimman kevyt.</span><span class="sxs-lookup"><span data-stu-id="d7199-127">In these cases, you should schedule the job to run at times when the system load is as light as possible.</span></span> <span data-ttu-id="d7199-128">Jos haluat, että erätyö jatkuu, kunnes se on suoritettu loppuun, kirjoita joko *0* (nolla) tai jätä kenttä tyhjäksi.</span><span class="sxs-lookup"><span data-stu-id="d7199-128">If you want the batch job to continue to run until it's completed, either enter *0* (zero) or leave the field blank.</span></span> <span data-ttu-id="d7199-129">Tämä asetus on käytettävissä vain, jos järjestelmään liittyvä toiminto on [otettu käyttöön järjestelmässäsi](#max-execution-time).</span><span class="sxs-lookup"><span data-stu-id="d7199-129">This setting is available only if the related feature has been [turned on in your system](#max-execution-time).</span></span>

<span data-ttu-id="d7199-130">Vaikka voit suorittaa työn tavallisten aukioloaikojen aikana, on suositeltavaa suorittaa työ työajan ulkopuolella.</span><span class="sxs-lookup"><span data-stu-id="d7199-130">Although you can run the job during regular business hours, we recommend that you run it outside working hours.</span></span> <span data-ttu-id="d7199-131">Näin voit estää ristiriitoja, joita voi ilmetä, jos käyttäjä käyttää myös siivottua tietuetta.</span><span class="sxs-lookup"><span data-stu-id="d7199-131">In this way, you help prevent conflicts that can occur if a user is working with a record that is also being cleaned up.</span></span>

<span data-ttu-id="d7199-132">Jos työ yrittää poistaa nimikkeen tietueen samalla, kun toinen käyttäjä käyttää tietuetta, tyhjennystyön tai käyttäjän kohdalla ilmenee lukkiutumisen virhe.</span><span class="sxs-lookup"><span data-stu-id="d7199-132">If the job tries to delete a record for an item while that record is being used by another user, a deadlock error occurs for either the cleanup job or the user.</span></span>

<span data-ttu-id="d7199-133">Kun työ suoritetaan, sen toteutuskoko on 100.</span><span class="sxs-lookup"><span data-stu-id="d7199-133">When the job runs, it has a commit size of 100.</span></span> <span data-ttu-id="d7199-134">Toisin sanoen, se yrittää sitoutua kerran jokaista 100:a poistoa kohti.</span><span class="sxs-lookup"><span data-stu-id="d7199-134">In other words, it will try to commit one time for every 100 deletions.</span></span> <span data-ttu-id="d7199-135">Koska joitakin poistoja on määritetty, saattaa kuitenkin olla tilanteita, joissa samassa tapahtumassa voidaan poistaa yli 100 tietuetta.</span><span class="sxs-lookup"><span data-stu-id="d7199-135">However, because some deletions are set-based, there might be scenarios where more than 100 records can be deleted in the same transaction.</span></span> <span data-ttu-id="d7199-136">Tämän vuoksi lukitusestoja voi joskus ilmetä.</span><span class="sxs-lookup"><span data-stu-id="d7199-136">Therefore, lock escalations can still sometimes occur.</span></span>

## <a name="possible-user-impact"></a><span data-ttu-id="d7199-137">Mahdollinen käyttäjän vaikutus</span><span class="sxs-lookup"><span data-stu-id="d7199-137">Possible user impact</span></span>

<span data-ttu-id="d7199-138">Käyttäjät saattavat vaikuttaa, jos käytettävissä olevien tapahtumien tyhjennystyö poistaa kaikki tietyn tason tietueet (kuten rekisterikilven tason).</span><span class="sxs-lookup"><span data-stu-id="d7199-138">Users might be affected if the on-hand entries cleanup job deletes all the records for a given level (such as the license plate level).</span></span> <span data-ttu-id="d7199-139">Tässä tapauksessa toiminto, jonka mukaan varasto oli aiemmin käytettävissä rekisterikilvessä, ei ehkä toimi odotetulla tavalla, koska tarvittavat käytettävissä olevat tiedot eivät ole enää saatavilla.</span><span class="sxs-lookup"><span data-stu-id="d7199-139">In this case, the functionality for seeing that inventory was previously available on-hand at a license plate might not work as expected because the relevant on-hand entries are no longer available.</span></span> <span data-ttu-id="d7199-140">Näin voi tapahtua esimerkiksi seuraavissa tilanteissa:</span><span class="sxs-lookup"><span data-stu-id="d7199-140">This can, for example, be experienced in the following situations:</span></span>

- <span data-ttu-id="d7199-141">Kun käyttäjä poistaa **Varastoluettelo**-kohdassa ehdon **Määrä \<\> 0** valinnan tai valitsee ehdon **Suljetut tapahtumat** **Dimensionäyttö**-asetuksia.</span><span class="sxs-lookup"><span data-stu-id="d7199-141">On the **On-hand list**, when the user deselects the condition **Quantity \<\> 0** or selects the condition **Closed transactions** in the **Dimensions display** settings.</span></span>
- <span data-ttu-id="d7199-142">Kun käyttäjä määrittää menneiden kausien **Varastotilanne/varastodimensio** -raportissa **Alkupäivämäärä**-parametrin.</span><span class="sxs-lookup"><span data-stu-id="d7199-142">In a **Physical inventory by inventory dimension** report for past periods, when the user sets the **As of date** parameter.</span></span>

<span data-ttu-id="d7199-143">Puhdistustyö kuitenkin parantaa suorituskykyä, minkä pitäisi korvata nämä pienet toimintojen heikennykset.</span><span class="sxs-lookup"><span data-stu-id="d7199-143">However, the performance improvement that the cleanup job provides should make up for these small losses in functionality.</span></span>

## <a name="make-the-maximum-execution-time-setting-available"></a><a name="max-execution-time"></a><span data-ttu-id="d7199-144">Parhaan suoritusajan määrittäminen käyttöön</span><span class="sxs-lookup"><span data-stu-id="d7199-144">Make the Maximum execution time setting available</span></span>

<span data-ttu-id="d7199-145">Oletusarvoisesti **Paras suoritusaika** asetus ei ole käytettävissä.</span><span class="sxs-lookup"><span data-stu-id="d7199-145">By default, the **Maximum execution time** setting isn't available.</span></span> <span data-ttu-id="d7199-146">Jos haluat käyttää sitä, sinun on otettava käyttöön [ominaisuuksien hallinta](../../fin-ops-core/fin-ops/get-started/feature-management/feature-management-overview.md) ottaaksesi käyttöön liittyvä ominaisuus järjestelmässäsi.</span><span class="sxs-lookup"><span data-stu-id="d7199-146">If you want to use it, you must use [feature management](../../fin-ops-core/fin-ops/get-started/feature-management/feature-management-overview.md) to turn on the related feature in your system.</span></span> <span data-ttu-id="d7199-147">**Ominaisuuksien hallinta** -työtilassa ominaisuus on luetteloitu seuraavalla tavalla:</span><span class="sxs-lookup"><span data-stu-id="d7199-147">In the **Feature management** workspace, the feature is listed in the following way:</span></span>

- <span data-ttu-id="d7199-148">**Moduuli:** *Varastonhallinta*</span><span class="sxs-lookup"><span data-stu-id="d7199-148">**Module:** *Warehouse management*</span></span>
- <span data-ttu-id="d7199-149">**Ominaisuuden nimi:** *Varastonhallinnan käytettävissä olevien merkintöjen tyhjennystyöajan maksimisuoritusaika*</span><span class="sxs-lookup"><span data-stu-id="d7199-149">**Feature name:** *Maximum execution time for the warehouse management on-hand entries cleanup job*</span></span>


[!INCLUDE[footer-include](../../includes/footer-banner.md)]