---
title: "Määritä tietojen tuonti SharePointista"
description: "Tässä ohjeaiheessa käsitellään tietojen tuominen Microsoft SharePointista."
author: NickSelin
manager: AnnBe
ms.date: 05/21/2018
ms.topic: article
ms.prod: 
ms.service: dynamics-ax-platform
ms.technology: 
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.search.scope: Core, Operations
ms.custom: 220314
ms.assetid: 2685df16-5ec8-4fd7-9495-c0f653e82567
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2018-04-01
ms.dyn365.ops.version: Release 8.0
ms.translationtype: HT
ms.sourcegitcommit: 2fc887668171175d436b9eb281a35c1c9d089591
ms.openlocfilehash: 4285db9c71208bce45d64933e692a25ef3f46b26
ms.contentlocale: fi-fi
ms.lasthandoff: 08/08/2018

---
# <a name="configure-data-import-from-sharepoint"></a><span data-ttu-id="4adb8-103">Määritä tietojen tuonti SharePointista</span><span class="sxs-lookup"><span data-stu-id="4adb8-103">Configure data import from SharePoint</span></span>

[!include[banner](../includes/banner.md)]

<span data-ttu-id="4adb8-104">Tietojen tuominen saapuvasta tiedostosta käyttämällä sähköisen raportoinnin (ER) kehystä: on määritettävä ER-muoto, joka tukee tuontia, ja sitten suorittaa mallin määritys **Kohteeseen**-tyypille, joka käyttää kyseistä muotoa tietolähteenä.</span><span class="sxs-lookup"><span data-stu-id="4adb8-104">To import data from an incoming file by using the Electronic reporting (ER) framework, you must configure an ER format that supports the import and then run a model mapping of the **To destination** type that uses that format as a data source.</span></span> <span data-ttu-id="4adb8-105">Tietojen tuomiseksi siirry tiedostoon, jonka haluat tuoda.</span><span class="sxs-lookup"><span data-stu-id="4adb8-105">To import data, you must navigate to the file that you want to import.</span></span> <span data-ttu-id="4adb8-106">Käyttäjä voi valita manuaalisesti saapuvan tiedoston.</span><span class="sxs-lookup"><span data-stu-id="4adb8-106">The incoming file can be manually selected by user.</span></span> <span data-ttu-id="4adb8-107">Uuden sähköisen raportoinnin ominaisuuden kanssa, joka tukee tietojen tuomista Microsoft SharePointista, tämä prosessi voidaan määrittää automaattiseksi.</span><span class="sxs-lookup"><span data-stu-id="4adb8-107">With the new ER capability to support importing data from Microsoft SharePoint, this process can be configured as the unattended one.</span></span> <span data-ttu-id="4adb8-108">Voit käyttää ER-määrityksiä suorittaaksesi tietojen tuonnin tiedostoista, jotka on tallennettu Microsoft SharePoint -kansioihin.</span><span class="sxs-lookup"><span data-stu-id="4adb8-108">You can use ER configurations to perform data import from files that are stored in Microsoft SharePoint folders.</span></span> <span data-ttu-id="4adb8-109">Tässä ohjeaiheessa kerrotaan, miten voit siimeistellä tuonnin SharePointista Microsoft Dynamics 365 for Finance and Operationsiin.</span><span class="sxs-lookup"><span data-stu-id="4adb8-109">This topic explains how to complete the import from SharePoint to Microsoft Dynamics 365 for Finance and Operations.</span></span> <span data-ttu-id="4adb8-110">Esimerkissä käytetään toimittajatapahtumia liiketoimintatietoina.</span><span class="sxs-lookup"><span data-stu-id="4adb8-110">The examples use vendor transactions as business data.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="4adb8-111">Edellytykset</span><span class="sxs-lookup"><span data-stu-id="4adb8-111">Prerequisites</span></span>
<span data-ttu-id="4adb8-112">Tämän aiheen esimerkkien suorittaminen edellyttää seuraavia käyttöoikeuksia:</span><span class="sxs-lookup"><span data-stu-id="4adb8-112">To complete the examples in this topic, you must have the following access:</span></span>

- <span data-ttu-id="4adb8-113">Finance and Operations -käyttöoikeudet seuraaville rooleille:</span><span class="sxs-lookup"><span data-stu-id="4adb8-113">Access to Finance and Operations for one of the following roles:</span></span>

    - <span data-ttu-id="4adb8-114">Sähköisen raportoinnin kehittäjä</span><span class="sxs-lookup"><span data-stu-id="4adb8-114">Electronic reporting developer</span></span>
    - <span data-ttu-id="4adb8-115">Sähköisen raportoinnin toiminnallinen konsultti</span><span class="sxs-lookup"><span data-stu-id="4adb8-115">Electronic reporting functional consultant</span></span>
    - <span data-ttu-id="4adb8-116">Järjestelmänvalvoja</span><span class="sxs-lookup"><span data-stu-id="4adb8-116">System administrator</span></span>

- <span data-ttu-id="4adb8-117">Finance and Operations -käyttöön määritetyn Microsoft SharePoint Server -ilmentymän käyttöoikeudet</span><span class="sxs-lookup"><span data-stu-id="4adb8-117">Access to the instance of Microsoft SharePoint Server that is configured for use with Finance and Operations</span></span>
- <span data-ttu-id="4adb8-118">Sähköisen raportoinnin (ER) muoto ja mallin määritykset 1099-maksuille</span><span class="sxs-lookup"><span data-stu-id="4adb8-118">ER format and model configurations for 1099 payments</span></span>

### <a name="create-required-er-configurations"></a><span data-ttu-id="4adb8-119">Luo tarvittavat ER-konfiguraatiot</span><span class="sxs-lookup"><span data-stu-id="4adb8-119">Create required ER configurations</span></span>
<span data-ttu-id="4adb8-120">Toista **ER -tuo tiedot Microsoft Excel -tiedostosta** -tehtävoppaat, jotka ovat osa, **7.5.4.3 Acquire/Develop IT service/solution components (10677)** -liiketoimintaprosessia.</span><span class="sxs-lookup"><span data-stu-id="4adb8-120">Play the **ER Import data from a Microsoft Excel file** task guides, which are part of the **7.5.4.3 Acquire/Develop IT service/solution components (10677)** business process.</span></span> <span data-ttu-id="4adb8-121">Näissä tehtäväoppaissa selitetään ER-konfiguraatioiden suunnittelu ja käyttö, jotta voit vuorovaikutteisesti tuoda  toimittajatapahtumia ulkoisista Microsoft Excel -tiedostoista.</span><span class="sxs-lookup"><span data-stu-id="4adb8-121">These task guides walk you through the process of designing and using ER configurations to interactively import vendor transactions from external Microsoft Excel files.</span></span> <span data-ttu-id="4adb8-122">Lisätietoja on kohdassa [Saapuvien asiakirjojen jäsennys Microsoft Excelissä](parse-incoming-documents-excel.md).</span><span class="sxs-lookup"><span data-stu-id="4adb8-122">For more information, see [Parse incoming documents in Microsoft Excel](parse-incoming-documents-excel.md).</span></span> <span data-ttu-id="4adb8-123">Lopulta sinulla on:</span><span class="sxs-lookup"><span data-stu-id="4adb8-123">Fianlly, you will have:</span></span>

- <span data-ttu-id="4adb8-124">ER-konfiguroinnit:</span><span class="sxs-lookup"><span data-stu-id="4adb8-124">ER configurations:</span></span>

    - <span data-ttu-id="4adb8-125">ER-mallikonfiguraatio, **1099-maksumalli**</span><span class="sxs-lookup"><span data-stu-id="4adb8-125">ER model configuration, **1099 Payments model**</span></span>
    - <span data-ttu-id="4adb8-126">ER-muotokonfiguraatio **Muoto toimittajatapahtumien tuomiseksi Excelistä**</span><span class="sxs-lookup"><span data-stu-id="4adb8-126">ER format configuration, **Format for importing vendors' transactions from Excel**</span></span>

<span data-ttu-id="4adb8-127">[![ER-määritykset tietojen tuomiseksi SharePointista](./media/GERImportFromSharePoint-01-Configurations.PNG)](./media/GERImportFromSharePoint-01-Configurations.PNG)</span><span class="sxs-lookup"><span data-stu-id="4adb8-127">[![ER configurations for importing data from SharePoint](./media/GERImportFromSharePoint-01-Configurations.PNG)](./media/GERImportFromSharePoint-01-Configurations.PNG)</span></span>

- <span data-ttu-id="4adb8-128">Näyte saapuvasta tiedostosta tietojen tuontia varten:</span><span class="sxs-lookup"><span data-stu-id="4adb8-128">Sample of the incoming file for data import:</span></span>

    - <span data-ttu-id="4adb8-129">Excel-tiedosto **1099import-data.xlsx**, joka sisältää toimittajatapahtumat, ja joka pitäisi tuoda Finance and Operationsiin</span><span class="sxs-lookup"><span data-stu-id="4adb8-129">Excel file **1099import-data.xlsx**, with vendor transactions that should be imported into Finance and Operations</span></span>

<span data-ttu-id="4adb8-130">[![Microsoft Excel -mallitiedosto SharePointista tuontia varten](./media/GERImportFromSharePoint-02-Excel.PNG)](./media/GERImportFromSharePoint-02-Excel.PNG)</span><span class="sxs-lookup"><span data-stu-id="4adb8-130">[![Sample Microsoft Excel file for importing from SharePoint](./media/GERImportFromSharePoint-02-Excel.PNG)](./media/GERImportFromSharePoint-02-Excel.PNG)</span></span>

> [!NOTE]
> <span data-ttu-id="4adb8-131">Toimittajatapahtumien tuonnin muoto valitaan oletusmallimääritykseksi.</span><span class="sxs-lookup"><span data-stu-id="4adb8-131">The format for importing vendor transactions is selected as the default model mapping.</span></span> <span data-ttu-id="4adb8-132">Siksi, jos suoritat **1099-maksumallin** mallin määrityksen ja tämä mallin määritys on **Kohteeseen**-tyyppiä, mallin määritys suorittaa tätä muotoa, tuodakseen tietoja ulkoisista tiedostoista.</span><span class="sxs-lookup"><span data-stu-id="4adb8-132">Therefore, if you run a model mapping of the **1099 Payments model**, and that model mapping is of the **To destination** type, the model mapping runs this format to import data from external files.</span></span> <span data-ttu-id="4adb8-133">Sitten se käyttää näitä tietoja sovellustaulujen päivittämiseen.</span><span class="sxs-lookup"><span data-stu-id="4adb8-133">It then uses that data to update application tables.</span></span>

## <a name="configure-document-management-parameters"></a><span data-ttu-id="4adb8-134">Tiedostonhallintaparametrien konfigurointi</span><span class="sxs-lookup"><span data-stu-id="4adb8-134">Configure Document management parameters</span></span>
1. <span data-ttu-id="4adb8-135">Konfiguroi **Tiedostonhallintaparametrit**-sivulla SharePoint Server -ilmentymän käyttöoikeudet, joita käytetään yrityksessä, johon olet tällä hetkellä kirjautunut.</span><span class="sxs-lookup"><span data-stu-id="4adb8-135">On the **Document management parameters** page, configure access to the SharePoint Server instance that will be used by the company that you're currently signed in to.</span></span> <span data-ttu-id="4adb8-136">Tässä esimerkissä yritys on USMF.</span><span class="sxs-lookup"><span data-stu-id="4adb8-136">In this example, the company is USMF.</span></span>
2. <span data-ttu-id="4adb8-137">Testaa yhteys varmistaaksesi, että sinulle myönnetty SharePoint Server -ilmentymän käyttöoikeudet.</span><span class="sxs-lookup"><span data-stu-id="4adb8-137">Test the connection to the SharePoint Server instance to make sure that you've been granted access.</span></span>

<span data-ttu-id="4adb8-138">[![Tiedostonhallinnan asetukset – SharePoint Server](./media/GERImportFromSharePoint-03-SharePointSetup.png)](./media/GERImportFromSharePoint-03-SharePointSetup.png)</span><span class="sxs-lookup"><span data-stu-id="4adb8-138">[![Document management setting – SharePoint server](./media/GERImportFromSharePoint-03-SharePointSetup.png)](./media/GERImportFromSharePoint-03-SharePointSetup.png)</span></span>

3. <span data-ttu-id="4adb8-139">Avaa määritetty SharePoint-sivusto ja luo seuraavat kansiot, joihin saapuvat tiedostot voidaan tallentaa:</span><span class="sxs-lookup"><span data-stu-id="4adb8-139">Open the configured SharePoint site, and create the following folders where the incoming files can be stored:</span></span>

    - <span data-ttu-id="4adb8-140">Tiedostojen tuonnin lähde (ensisijainen)</span><span class="sxs-lookup"><span data-stu-id="4adb8-140">Files import source (main)</span></span>
    - <span data-ttu-id="4adb8-141">Tiedostojen tuonnin lähde (vaihtoehtoinen)</span><span class="sxs-lookup"><span data-stu-id="4adb8-141">Files import source (alternative)</span></span>

<span data-ttu-id="4adb8-142">[![Tiedostonhallinnan asetukset – SharePoint Server](./media/GERImportFromSharePoint-04-SharePointFolder1.png)](./media/GERImportFromSharePoint-04-SharePointFolder1.png)</span><span class="sxs-lookup"><span data-stu-id="4adb8-142">[![Document management setting – SharePoint server](./media/GERImportFromSharePoint-04-SharePointFolder1.png)](./media/GERImportFromSharePoint-04-SharePointFolder1.png)</span></span>

<span data-ttu-id="4adb8-143">[![Tiedostonhallinnan asetukset – SharePoint Server](./media/GERImportFromSharePoint-05-SharePointFolder2.png)](./media/GERImportFromSharePoint-05-SharePointFolder2.png)</span><span class="sxs-lookup"><span data-stu-id="4adb8-143">[![Document management setting – SharePoint server](./media/GERImportFromSharePoint-05-SharePointFolder2.png)](./media/GERImportFromSharePoint-05-SharePointFolder2.png)</span></span>

4. <span data-ttu-id="4adb8-144">Voit luoda Finance and Operationsin **Tiedostotyypit**-sivulla seuraavat tiedostotyypit, joita käytetään juuri luomiisi SharePoint-kansioihin kirjauduttaessa.</span><span class="sxs-lookup"><span data-stu-id="4adb8-144">In Finance and Operations, on the **Document types** page, create the following document types that will be used to access the SharePoint folders that you just created:</span></span>

    - <span data-ttu-id="4adb8-145">SP – ensisijainen</span><span class="sxs-lookup"><span data-stu-id="4adb8-145">SP Main</span></span>
    - <span data-ttu-id="4adb8-146">SP – vaihtoehtoinen</span><span class="sxs-lookup"><span data-stu-id="4adb8-146">SP Alternative</span></span>

5. <span data-ttu-id="4adb8-147">Luotuja asiakirjatyyppejä varten, **Ryhmä**-kenttään valitse **Tiedosto** ja **Sijainti**-kenttään valitse **SharePoint**.</span><span class="sxs-lookup"><span data-stu-id="4adb8-147">For created document types, in the **Group** field, enter **File** and in the **Location** field, enter **SharePoint**.</span></span> <span data-ttu-id="4adb8-148">Kirjoita sitten SharePoint-kansion osoite:</span><span class="sxs-lookup"><span data-stu-id="4adb8-148">Then enter the address of the SharePoint folder:</span></span>

    - <span data-ttu-id="4adb8-149">**SP – ensisijainen** -tiedostotyypille: tiedostojen tuonnin lähde (ensisijainen)</span><span class="sxs-lookup"><span data-stu-id="4adb8-149">For the **SP Main** document type: Files import source (main)</span></span>
    - <span data-ttu-id="4adb8-150">**SP – vaihtoehtoinen** -tiedostotyypille: tiedostojen tuonnin lähde (vaihtoehtoinen)</span><span class="sxs-lookup"><span data-stu-id="4adb8-150">For the **SP Alternative** document type: Files import source (alternative)</span></span>

<span data-ttu-id="4adb8-151">[![SharePoint-asetus – uusi asiakirjatyyppi](./media/GERImportFromSharePoint-06-SharePointDocumentTypesSetup.png)](./media/GERImportFromSharePoint-06-SharePointDocumentTypesSetup.png)</span><span class="sxs-lookup"><span data-stu-id="4adb8-151">[![SharePoint setting – new document type](./media/GERImportFromSharePoint-06-SharePointDocumentTypesSetup.png)](./media/GERImportFromSharePoint-06-SharePointDocumentTypesSetup.png)</span></span>

## <a name="configure-er-sources-for-the-er-format"></a><span data-ttu-id="4adb8-152">Määritä ER-muodon ER-lähteet</span><span class="sxs-lookup"><span data-stu-id="4adb8-152">Configure ER sources for the ER format</span></span>
1. <span data-ttu-id="4adb8-153">Valitse **Organisaation hallinto**  >  **Sähköinen raportointi**  >  **Sähköisen raportoinnin lähde**.</span><span class="sxs-lookup"><span data-stu-id="4adb8-153">Click **Organization administration** > **Electronic reporting** > **Electronic reporting source**.</span></span>
2. <span data-ttu-id="4adb8-154">Määritä **Sähköisen raportoinnin lähde** -sivulla tietojen tuonin lähdetiedostot käyttämällä määritettyä ER-muotoa.</span><span class="sxs-lookup"><span data-stu-id="4adb8-154">On the **Electronic reporting source** page, configure the source files for data import by using the configured ER format.</span></span>
3. <span data-ttu-id="4adb8-155">Määritä tiedostonimen peite, jotta tuotaisiin vain tiedostot, joiden pääte on .xlsx.</span><span class="sxs-lookup"><span data-stu-id="4adb8-155">Define a file name mask, so that only files with the .xlsx extension are imported.</span></span> <span data-ttu-id="4adb8-156">Tiedostonimen peite on valinnainen, ja sitä käytetään vain, jos se on määritetty.</span><span class="sxs-lookup"><span data-stu-id="4adb8-156">The file name mask is optional and is used only when it has been defined.</span></span> <span data-ttu-id="4adb8-157">Kullekin ER-muodolle voi määrittää vain yhden peitteen.</span><span class="sxs-lookup"><span data-stu-id="4adb8-157">You can define only one mask for each ER format.</span></span>
4. <span data-ttu-id="4adb8-158">Valitse molemmat aiemmin luomistasi SharePoint-kansioista.</span><span class="sxs-lookup"><span data-stu-id="4adb8-158">Select both SharePoint folders that you created earlier.</span></span>

<span data-ttu-id="4adb8-159">[![ER-tiedostojen lähdeasetukset](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)</span><span class="sxs-lookup"><span data-stu-id="4adb8-159">[![ER files source setting](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)</span></span>

> [!NOTE]
><span data-ttu-id="4adb8-160">Sähköisen raportoinnin *lähde* määritetään kullekin sovelluksen yritykselle erikseen.</span><span class="sxs-lookup"><span data-stu-id="4adb8-160">The ER *source* is defined for each application company individually.</span></span> <span data-ttu-id="4adb8-161">Sen sijaan sähköisen raportoinnin *konfiguraatiot* ovat yhteisiä kaikille yrityksille.</span><span class="sxs-lookup"><span data-stu-id="4adb8-161">By contrast, ER *configurations* are shared across companies.</span></span>

> [!NOTE]
> <span data-ttu-id="4adb8-162">Kun poistat sähköisen raportoinnin muodon ER-lähdeasetukset, kaikki liittyvät tiedostotilat (ks. alla) poistetaan myös.</span><span class="sxs-lookup"><span data-stu-id="4adb8-162">When you delete an ER source setting for an ER format, all connected file states (see below) are also deleted.</span></span>

## <a name="review-the-files-states-for-the-er-format"></a><span data-ttu-id="4adb8-163">Tarkista ER-muodon tiedostotilat</span><span class="sxs-lookup"><span data-stu-id="4adb8-163">Review the files states for the ER format</span></span>
1. <span data-ttu-id="4adb8-164">Valitse **Sähköisen raportoinnin lähde** -sivulla **Tiedostojen tilat lähteitä varten** tarkistaaksesi määritettyjen tiedostolähteiden sisällön nykyiselle ER-muodolle.</span><span class="sxs-lookup"><span data-stu-id="4adb8-164">On the **Electronic reporting source** page, select **File states for the sources** to review the content of the configured file sources for the current ER format.</span></span>
2. <span data-ttu-id="4adb8-165">Takista **Tiedostot**-osassa tiedostojen luettelo.</span><span class="sxs-lookup"><span data-stu-id="4adb8-165">In the **Files** section, review the list of files.</span></span> <span data-ttu-id="4adb8-166">Luettelo sisältää:</span><span class="sxs-lookup"><span data-stu-id="4adb8-166">This list presents the following:</span></span>

    - <span data-ttu-id="4adb8-167">Soveltuvat lähdetiedostot tiedostonimen peitteen perusteella (jos tiedostonimen peite on määritetty), jotka ovat valmiita tietojen tuontia varten.</span><span class="sxs-lookup"><span data-stu-id="4adb8-167">Source files that are applicable, based on the file name mask (if a file name mask is defined), and that are ready for data import.</span></span> <span data-ttu-id="4adb8-168">Näiden tiedostojen **Tuontimuodon lähteiden lokit** -osa on tyhjä.</span><span class="sxs-lookup"><span data-stu-id="4adb8-168">For these files, the **Sources log for the import format** section is blank.</span></span>
    - <span data-ttu-id="4adb8-169">Aiemmin tuodut tiedostot.</span><span class="sxs-lookup"><span data-stu-id="4adb8-169">Previously imported files.</span></span> <span data-ttu-id="4adb8-170">Voit tarkistaa kaikkien näiden tiedostojen **Tuontimuodon lähteiden lokit** -osassa kyseisen tiedoston tuonnin historiatiedot.</span><span class="sxs-lookup"><span data-stu-id="4adb8-170">For each of these files, in the **Sources log for the import format** section, you can review the history of import of this file.</span></span>

<span data-ttu-id="4adb8-171">Voit myös avata **Tiedostojen tilat lähteitä varten** -sivun valitsemalla **Organisaation hallinto** \> **Sähköinen raportointi** \> **Tiedostojen tilat lähteitä varten**.</span><span class="sxs-lookup"><span data-stu-id="4adb8-171">You can also open the **File states for the sources** page by selecting **Organization administration** \> **Electronic reporting** \> **File states for the sources**.</span></span> <span data-ttu-id="4adb8-172">Tässä tapauksessa sivulla on tietoja tiedostolähteista kaikille ER-muodoille, joille on määritetty tiedostolähteet yrityksessä, johon olet parhaillaan kirjautuneena.</span><span class="sxs-lookup"><span data-stu-id="4adb8-172">In this case, the page provides information about file sources for all ER formats that file sources have been configured for in the company that you're currently signed in to.</span></span>

## <a name="import-data-from-excel-files-that-are-in-a-sharepoint-folder"></a><span data-ttu-id="4adb8-173">Tietojen tuominen Excel-tiedostoista, jotka ovat SharePoint-kansiossa</span><span class="sxs-lookup"><span data-stu-id="4adb8-173">Import data from Excel files that are in a SharePoint folder</span></span>
1. <span data-ttu-id="4adb8-174">Lataa SharePointissa Microsoft Excel -tiedosto **1099import-data.xlsx**, joka sisältää toimittajatapahtumat, SharePointin **Tiedostojen tuonnin lähde (ensisijainen)** -kansioon, jonka loit aikaisemmin.</span><span class="sxs-lookup"><span data-stu-id="4adb8-174">In SharePoint, upload the Microsoft Excel file **1099import-data.xlsx** that contains vendor transactions to the **Files import source (main)** SharePoint folder that you created earlier.</span></span>

<span data-ttu-id="4adb8-175">[![SharePoint-sisältö – Microsoft Excel -tiedosto tuontia varten](./media/GERImportFromSharePoint-08-UploadFile.png)](./media/GERImportFromSharePoint-08-UploadFile.png)</span><span class="sxs-lookup"><span data-stu-id="4adb8-175">[![SharePoint content – Microsoft Excel file for importing](./media/GERImportFromSharePoint-08-UploadFile.png)](./media/GERImportFromSharePoint-08-UploadFile.png)</span></span>

2. <span data-ttu-id="4adb8-176">Valitse Finance and Operationsin **Tiedostojen tilat lähteitä varten** -sivulla **Päivitä** päivittäksesi sivun.</span><span class="sxs-lookup"><span data-stu-id="4adb8-176">In Finance and Operations, on the **File states for the sources** page, select **Refresh** to refresh the page.</span></span> <span data-ttu-id="4adb8-177">Huomaa, että Excel-tiedosto, joka on ladattu SharePointiin, oli tässä muodossa tilassa **Valmis**.</span><span class="sxs-lookup"><span data-stu-id="4adb8-177">Note that the Excel file that was uploaded to SharePoint appeared in this form with the status **Ready**.</span></span> <span data-ttu-id="4adb8-178">Tällä hetkellä tuetaan seuraavia tiloja:</span><span class="sxs-lookup"><span data-stu-id="4adb8-178">The following statuses are currently supported:</span></span>

    - <span data-ttu-id="4adb8-179">**Valmis** - määritetty automaattisesti kullekin uudelle tiedostolle SharePoint-kansiossa.</span><span class="sxs-lookup"><span data-stu-id="4adb8-179">**Ready** - Assigned automatically for each new file in a SharePoint folder.</span></span> <span data-ttu-id="4adb8-180">Tämä tila tarkoittaa, että tiedosto on tuontivalmis.</span><span class="sxs-lookup"><span data-stu-id="4adb8-180">This status means that the file is ready for import.</span></span>
    - <span data-ttu-id="4adb8-181">**Tuodaan** - ER-raportin automaattisesti määrittämä, kun tuontiprosessi on lukinnut tiedoston estääkseen muita prosesseja käyttämästä sitä (jos useita on käynnissä yhtä aikaa).</span><span class="sxs-lookup"><span data-stu-id="4adb8-181">**Importing** - Assigned automatically by an ER report when the file will be locked by the import process to prevent its usage by other processes (if many of them are running simultaneously).</span></span>
    - <span data-ttu-id="4adb8-182">**Tuotu** - ER-raportin automaattisesti määrittämä, kun tiedoston tuominen on onnistunut ja valmis.</span><span class="sxs-lookup"><span data-stu-id="4adb8-182">**Imported** - Assigned automatically by an ER report when the file import is successfully completed.</span></span> <span data-ttu-id="4adb8-183">Tämä tila tarkoittaa, että tuotu tiedosto on poistettu määritetystä tiedostolähteestä (SharePoint-kansiosta).</span><span class="sxs-lookup"><span data-stu-id="4adb8-183">This status means that the imported file has been deleted from the configured files source (SharePoint folder).</span></span>
    - <span data-ttu-id="4adb8-184">**Epäonnistui** - ER-raportin automaattisesti määrittämä, kun tiedoston tuominen on valmis, mutta tapahtui virheitä tai poikkeuksia.</span><span class="sxs-lookup"><span data-stu-id="4adb8-184">**Failed** - Assigned automatically by an ER report when the file import completed with errors or exceptions.</span></span>
    - <span data-ttu-id="4adb8-185">**Pidossa** - käyttäjä määrittää manuaalisesti tässä lomakkeessa.</span><span class="sxs-lookup"><span data-stu-id="4adb8-185">**On hold** - Assigned manually by user on this form.</span></span> <span data-ttu-id="4adb8-186">Tämä tila tarkoittaa, että tiedostoa ei tuoda nyt.</span><span class="sxs-lookup"><span data-stu-id="4adb8-186">This status means that the file will not be imported for now.</span></span> <span data-ttu-id="4adb8-187">Tätä tilaa voidaan käyttää lykkäämään joidenkin tiedostojen tuontia.</span><span class="sxs-lookup"><span data-stu-id="4adb8-187">This status can be used to postpone the import of some files.</span></span>

<span data-ttu-id="4adb8-188">[![ER – tiedostotilojen sivu valituille lähteille](./media/GERImportFromSharePoint-09-FileStatesForm.png)](./media/GERImportFromSharePoint-09-FileStatesForm.png)</span><span class="sxs-lookup"><span data-stu-id="4adb8-188">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-09-FileStatesForm.png)](./media/GERImportFromSharePoint-09-FileStatesForm.png)</span></span>

## <a name="import-data-from-sharepoint-files"></a><span data-ttu-id="4adb8-189">Tietojen tuominen SharePoint-tiedostoista</span><span class="sxs-lookup"><span data-stu-id="4adb8-189">Import data from SharePoint files</span></span>
1. <span data-ttu-id="4adb8-190">Avaa Er-konfiguraatiopuu, valitse **1099-maksumalli** ja laajenna ER-mallin komponenttiluettelo.</span><span class="sxs-lookup"><span data-stu-id="4adb8-190">Open the ER configurations tree, select the **1099 Payment model**, and expand the list of ER model components.</span></span>
2. <span data-ttu-id="4adb8-191">Valitse mallin määrityksen nimi avataksesi valitun ER-mallin konfiguraation mallimääritykset.</span><span class="sxs-lookup"><span data-stu-id="4adb8-191">Select the name of the model mapping to open the list of model mappings of the selected ER model configuration.</span></span>

<span data-ttu-id="4adb8-192">[![ER – tiedostotilojen sivu valituille lähteille](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="4adb8-192">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)</span></span>

3. <span data-ttu-id="4adb8-193">Valitse **Suorita** suorittaaksesi valitun mallimäärityksen.</span><span class="sxs-lookup"><span data-stu-id="4adb8-193">Select **Run** to run the selected model mapping.</span></span> <span data-ttu-id="4adb8-194">Koska määritit ER-muodon tiedostolähteet, voit muuttaa asetusta **Tiedoston lähde** tarpeen mukaan.</span><span class="sxs-lookup"><span data-stu-id="4adb8-194">Because you configured file sources for the ER format, you can change the setting of the **File source** option as you require.</span></span> <span data-ttu-id="4adb8-195">Jos pidät tämän asetuksen arvon, .xslx-tiedostot tuodaan määritetyistä lähteistä (SharePoint-kansiot tässä esimerkissä).</span><span class="sxs-lookup"><span data-stu-id="4adb8-195">If you keep the setting of this option, the .xslx files are imported from the configured sources (the SharePoint folders, in this example).</span></span>

    <span data-ttu-id="4adb8-196">Tässä esimerkissä tuodaan vain yksi tiedosto.</span><span class="sxs-lookup"><span data-stu-id="4adb8-196">In this example, you're importing only one file.</span></span> <span data-ttu-id="4adb8-197">Jos tiedostoja on useita, ne valitaan tuontiin siinä järjestyksessä, jossa ne lisättiin SharePoint-kansioon.</span><span class="sxs-lookup"><span data-stu-id="4adb8-197">However, if there are multiple files, they are selected for importing in the order in which they were added to the SharePoint folder.</span></span> <span data-ttu-id="4adb8-198">Kukin ER-muodon suoritus tuo yhden valitun tiedoston.</span><span class="sxs-lookup"><span data-stu-id="4adb8-198">Every run of an ER format imports a single selected file.</span></span>

<span data-ttu-id="4adb8-199">[![Suorita ER-mallimääritys](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="4adb8-199">[![Run ER model mapping](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)</span></span>

4. <span data-ttu-id="4adb8-200">Mallin määritys voidaan suorittaa automaattisesti erätilassa.</span><span class="sxs-lookup"><span data-stu-id="4adb8-200">The model mapping can run unattended in batch mode.</span></span> <span data-ttu-id="4adb8-201">Tässä tapauksessa aina, kun eräkäsittely suorittaa tämän ER-muodon, tuodaan yksi tiedosto määritetyistä tiedostolähteistä.</span><span class="sxs-lookup"><span data-stu-id="4adb8-201">In this case, every time that a batch runs this ER format, a single file is imported from the configured file sources.</span></span> <span data-ttu-id="4adb8-202">Seuraavan koodin avulla voit toteuttaa tämän eräajon suorittamisen.</span><span class="sxs-lookup"><span data-stu-id="4adb8-202">Use the following code to implement this batch run.</span></span>

    ```
    ERObjectsFactory::createMappingDestinationRunByImportFormatMappingId().run()
    ```

    <span data-ttu-id="4adb8-203">Kun tiedosto on onnistuneesti tuotu SharePoint-kansiosta, se poistetaan kyseisestä kansiosta.</span><span class="sxs-lookup"><span data-stu-id="4adb8-203">When a file is successfully imported from the SharePoint folder, it's deleted from that folder.</span></span>

5. <span data-ttu-id="4adb8-204">Syötä tositteen tunnus, kuten **V-00001**, ja valitse sitten **OK**.</span><span class="sxs-lookup"><span data-stu-id="4adb8-204">Enter the voucher ID, such as **V-00001**, and then select **OK**.</span></span>

<span data-ttu-id="4adb8-205">[![Suorita ER-mallimääritys](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)</span><span class="sxs-lookup"><span data-stu-id="4adb8-205">[![Run ER model mapping](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)</span></span>

6. <span data-ttu-id="4adb8-206">Valitse **Tiedostojen tilat lähteitä varten** -sivulla **Päivitä** päivittäksesi sivun.</span><span class="sxs-lookup"><span data-stu-id="4adb8-206">On the **File states for the sources** page, select **Refresh** to refresh the page.</span></span>

<span data-ttu-id="4adb8-207">[![ER – tiedostotilojen sivu valituille lähteille](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)</span><span class="sxs-lookup"><span data-stu-id="4adb8-207">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)</span></span>

7. <span data-ttu-id="4adb8-208">Takista **Tiedostot**-osassa tiedostojen luettelo.</span><span class="sxs-lookup"><span data-stu-id="4adb8-208">In the **Files** section, review the list of files.</span></span> <span data-ttu-id="4adb8-209">**Tuontimuodon lähteiden lokit** -osa sisältää Excel-tiedostojen tuomisen historian.</span><span class="sxs-lookup"><span data-stu-id="4adb8-209">The **Sources log for the import format** section provides the history of the Excel file import.</span></span> <span data-ttu-id="4adb8-210">Koska tiedosto tuotiin onnistuneesti, se on merkitty arvolla **Poistettu** SharePoint-kansiossa.</span><span class="sxs-lookup"><span data-stu-id="4adb8-210">Because this file was successfully imported, it's marked as **Deleted** in the SharePoint folder.</span></span>
8. <span data-ttu-id="4adb8-211">Tarkista SharePoint-kansio **Tiedostojen tuonnin lähde (ensisijainen)**.</span><span class="sxs-lookup"><span data-stu-id="4adb8-211">Review the **Files import source (main)** SharePoint folder.</span></span> <span data-ttu-id="4adb8-212">Tästä kansiosta on poistettu Excel-tiedostot, jotka tuotiin onnistuneesti.</span><span class="sxs-lookup"><span data-stu-id="4adb8-212">The Excel files that were successfully imported have been deleted from this folder.</span></span>
9. <span data-ttu-id="4adb8-213">Valitse Finance and Operationsissa **Ostoreskontra** \> **Kausittaiset tehtävät** \> **Valmistevero (1099)** \> **Toimittajien tilitykset valmisteveroja (1099) varten**.</span><span class="sxs-lookup"><span data-stu-id="4adb8-213">In Finance and Operations, select **Accounts payable** \> **Periodic tasks** \> **Tax 1099** \> **Vendor settlement for 1099s**.</span></span>
10. <span data-ttu-id="4adb8-214">Valitse **Päivämäärästä**- ja **Päivämäärään**-kenttiin asianmukaiset arvot.</span><span class="sxs-lookup"><span data-stu-id="4adb8-214">In the **From date** and **To date** fields, enter appropriate values.</span></span> <span data-ttu-id="4adb8-215">Valitse sitten **Manuaaliset 1099-tapahtumat**.</span><span class="sxs-lookup"><span data-stu-id="4adb8-215">Then select **Manual 1099 transactions**.</span></span>

    <span data-ttu-id="4adb8-216">Toimittajatapahtumat, jotka tuotiin SharePointin Excel-tiedostoista tositteelle **V-00001**, näytetään sivulla.</span><span class="sxs-lookup"><span data-stu-id="4adb8-216">The vendor transactions that were imported from the Excel files on SharePoint for voucher **V-00001**, are presented on the page.</span></span>

<span data-ttu-id="4adb8-217">[![Toimittajan 1099-tapahtumat -sivu](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)</span><span class="sxs-lookup"><span data-stu-id="4adb8-217">[![1099 vendor transactions page](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)</span></span>

## <a name="prepare-an-excel-file-for-import"></a><span data-ttu-id="4adb8-218">valmistele Excel-tiedosto tuontia varten</span><span class="sxs-lookup"><span data-stu-id="4adb8-218">Prepare an Excel file for import</span></span>
1. <span data-ttu-id="4adb8-219">Avaa aiemmin käyttämäsi Excel-tiedosto.</span><span class="sxs-lookup"><span data-stu-id="4adb8-219">Open the Excel file that you previously used.</span></span> <span data-ttu-id="4adb8-220">Lisää riville 3 ja sarakkeeseen 1 toimittajakoodi, jota ei ole sovelluksessa.</span><span class="sxs-lookup"><span data-stu-id="4adb8-220">In row 3 column 1, add a vendor code that doesn't exist in the application.</span></span> <span data-ttu-id="4adb8-221">Lisää muut keksityt toimittajatiedot riville.</span><span class="sxs-lookup"><span data-stu-id="4adb8-221">Add additional false vendor information to the row.</span></span>

<span data-ttu-id="4adb8-222">[![Microsoft Excel -mallitiedosto SharePointista tuontia varten](./media/GERImportFromSharePoint-15-Excel.PNG)](./media/GERImportFromSharePoint-15-Excel.PNG)</span><span class="sxs-lookup"><span data-stu-id="4adb8-222">[![Sample Microsoft Excel file for importing from SharePoint](./media/GERImportFromSharePoint-15-Excel.PNG)](./media/GERImportFromSharePoint-15-Excel.PNG)</span></span>

2. <span data-ttu-id="4adb8-223">Lataa päivitetty Excel-tiedosto, joka sisältää toimittajatapahtumat, SharePoint-kansioon **Tiedostojen tuonnin lähde (ensisijainen)**.</span><span class="sxs-lookup"><span data-stu-id="4adb8-223">Upload the updated Excel file that contains vendors transactions to the **Files import source (main)** SharePoint folder.</span></span>
3. <span data-ttu-id="4adb8-224">Avaa Finance and Operationsissa ER-konfiguraatiopuu, valitse **1099-maksumalli** ja laajenna ER-mallin komponenttiluettelo.</span><span class="sxs-lookup"><span data-stu-id="4adb8-224">In Finance and Operations, open the ER configurations tree, select the **1099 Payment model**, and expand the list of ER model components.</span></span>
4. <span data-ttu-id="4adb8-225">Valitse mallimääritykseen nimi päivittääksesi mallin määrittämisen siten, että virheellistä toimittajakoodia pidetään virheenä tietojen tuonnin aikana.</span><span class="sxs-lookup"><span data-stu-id="4adb8-225">Select the name of the model mapping to update the model mapping so that the incorrect vendor code is considered an error during the data import process.</span></span>
5. <span data-ttu-id="4adb8-226">Valitse **Suunnittelu**.</span><span class="sxs-lookup"><span data-stu-id="4adb8-226">Select **Designer**.</span></span>
6. <span data-ttu-id="4adb8-227">Muuta **Vahvistukset**-välilehdessä vahvistuksen jälkeinen toiminto vahvistussäännölle, joka on määritetty sen arvioimiseksi, onko tuotu toimittajatili sovelluksessa.</span><span class="sxs-lookup"><span data-stu-id="4adb8-227">On the **Validations** tab, you must change the post-validation action for the validation rule that was configured to evaluate whether the vendor account that is imported exists in the application.</span></span> <span data-ttu-id="4adb8-228">Päivitä **Tarkistuksen jälkeinen toiminto** -kentän arvoksi **Lopeta suoritus**, tallenna muutokset ja sulje sivu.</span><span class="sxs-lookup"><span data-stu-id="4adb8-228">Update the value of the **Post-validation action** field to **Stop execution**, save your changes, and close the page.</span></span>

<span data-ttu-id="4adb8-229">[![ER-mallimäärityksen sunnittelun sivu](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="4adb8-229">[![ER model mapping designer page](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)</span></span>

7. <span data-ttu-id="4adb8-230">Tallenna muutokset ja sulje ER-mallimäärityksen suunnitteluohjelma.</span><span class="sxs-lookup"><span data-stu-id="4adb8-230">Save your changes, and close the ER model mapping designer.</span></span>
8. <span data-ttu-id="4adb8-231">Valitse **Suorita** suorittaaksesi muutetun ER-mallimäärityksen.</span><span class="sxs-lookup"><span data-stu-id="4adb8-231">Select **Run** to run the modified ER model mapping.</span></span>
9. <span data-ttu-id="4adb8-232">Syötä tositteen tunnus, kuten **V-00002**, ja valitse sitten **OK**.</span><span class="sxs-lookup"><span data-stu-id="4adb8-232">Enter the voucher ID, such as **V-00002**, and then select **OK**.</span></span>

    <span data-ttu-id="4adb8-233">Huomaa, että tietoloki sisältää ilmoituksen siitä, että SharePoint-kansion tiedosto sisältää virheellisen toimittajatilin, eikä sitä voi tuoda.</span><span class="sxs-lookup"><span data-stu-id="4adb8-233">Note that the Infolog contains the notification informing that residing in SharePoint folder file contains incorrect vendor account and can’t be imported.</span></span>

<span data-ttu-id="4adb8-234">[![Suorita ER-mallimääritys](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)</span><span class="sxs-lookup"><span data-stu-id="4adb8-234">[![Run ER model mapping](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)</span></span>

10. <span data-ttu-id="4adb8-235">Valitse **Tiedostojen tilat lähteitä varten** -sivulla **Päivitä** ja tarkista **Tiedostot**-osassa tiedostojen luettelo.</span><span class="sxs-lookup"><span data-stu-id="4adb8-235">On the **File states for the sources** page, select **Refresh**, and then, in the **Files** section, review the list of files.</span></span>

<span data-ttu-id="4adb8-236">[![ER – tiedostotilojen sivu valituille lähteille](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)</span><span class="sxs-lookup"><span data-stu-id="4adb8-236">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)</span></span>

<span data-ttu-id="4adb8-237">**Tuontimuodon lähteiden lokit** -osa ilmaisee, että tuonti epäonnistui ja että tiedosto on yhä SharePoint-kansiossa (**On poistettu** -valintaruutua ei ole valittu).</span><span class="sxs-lookup"><span data-stu-id="4adb8-237">The **Sources log for the import format** section indicates that the import process failed and that the file is still in the SharePoint folder (the **Is deleted** checkbox is not selected).</span></span> <span data-ttu-id="4adb8-238">Jos korjaat tämän tiedoton SharePointissa lisäämällä asianmukaisen toimittajan koodin ja sitten muutat tiedoston tilasta **Epäonnistui** tilaan **Valmis** **Tuontimuodon lähteiden lokit** -osassa, voit tuoda tiedoston uudelleen.</span><span class="sxs-lookup"><span data-stu-id="4adb8-238">If you fix this file on SharePoint by adding the proper vendor code and then change the status of the file from **Failed** to **Ready** in the **Sources log for the import format** section, you can import the file again.</span></span>

11. <span data-ttu-id="4adb8-239">Tarkista SharePoint-kansio **Tiedostojen tuonnin lähde (ensisijainen)**.</span><span class="sxs-lookup"><span data-stu-id="4adb8-239">Review the **Files import source (main)** SharePoint folder.</span></span> <span data-ttu-id="4adb8-240">Huomaa, että Excel-tiedosto, jota ei tuotu, on edelleen tässä kansiossa.</span><span class="sxs-lookup"><span data-stu-id="4adb8-240">Notice that the Excel file that wasn't imported is still in this folder.</span></span>
12. <span data-ttu-id="4adb8-241">Valitse Finance and Operationsin kohdassa **Ostoreskontra** \> **Kausittaiset tehtävät** \> **Valmistevero (1099)** \> **Toimittajien tilitykset valmisteveroja (1099) varten** asianmukaiset arvot **Päivämäärästä**- ja **Päivämäärään**-kenttiin ja valitse sitten **Manuaaliset 1099-tapahtumat**.</span><span class="sxs-lookup"><span data-stu-id="4adb8-241">In Finance and Operations, select **Accounts payable** \> **Periodic tasks** \> **Tax 1099** \> **Vendor settlement for 1099s**, enter appropriate values in the **From date** and **To date** fields, and then select **Manual 1099 transactions**.</span></span>

    <span data-ttu-id="4adb8-242">Vain tositteen V-00001 tapahtumat ovat käytettävissä.</span><span class="sxs-lookup"><span data-stu-id="4adb8-242">Only transactions for voucher V-00001 are available.</span></span> <span data-ttu-id="4adb8-243">Tositteen V-00002 tapahtumat eivät ole käytettävissä vaikka viimeisen tuodun tapahtuman virhe havaittiin Excel-tiedostossa.</span><span class="sxs-lookup"><span data-stu-id="4adb8-243">No transactions for voucher V-00002 are available even though the error for the last imported transaction has been found in the Excel file.</span></span>

